function Ib(o,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in o)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(o,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Db(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Bu={exports:{}},Br={},$u={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Em;function Lb(){if(Em)return De;Em=1;var o=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function y(D){return D===null||typeof D!="object"?null:(D=m&&D[m]||D["@@iterator"],typeof D=="function"?D:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function A(D,U,ie){this.props=D,this.context=U,this.refs=b,this.updater=ie||w}A.prototype.isReactComponent={},A.prototype.setState=function(D,U){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,U,"setState")},A.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function C(){}C.prototype=A.prototype;function k(D,U,ie){this.props=D,this.context=U,this.refs=b,this.updater=ie||w}var E=k.prototype=new C;E.constructor=k,_(E,A.prototype),E.isPureReactComponent=!0;var P=Array.isArray,R=Object.prototype.hasOwnProperty,N={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function L(D,U,ie){var ge,ke={},Ee=null,oe=null;if(U!=null)for(ge in U.ref!==void 0&&(oe=U.ref),U.key!==void 0&&(Ee=""+U.key),U)R.call(U,ge)&&!O.hasOwnProperty(ge)&&(ke[ge]=U[ge]);var Ie=arguments.length-2;if(Ie===1)ke.children=ie;else if(1<Ie){for(var Le=Array(Ie),ot=0;ot<Ie;ot++)Le[ot]=arguments[ot+2];ke.children=Le}if(D&&D.defaultProps)for(ge in Ie=D.defaultProps,Ie)ke[ge]===void 0&&(ke[ge]=Ie[ge]);return{$$typeof:o,type:D,key:Ee,ref:oe,props:ke,_owner:N.current}}function H(D,U){return{$$typeof:o,type:D.type,key:U,ref:D.ref,props:D.props,_owner:D._owner}}function V(D){return typeof D=="object"&&D!==null&&D.$$typeof===o}function q(D){var U={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ie){return U[ie]})}var xe=/\/+/g;function X(D,U){return typeof D=="object"&&D!==null&&D.key!=null?q(""+D.key):U.toString(36)}function re(D,U,ie,ge,ke){var Ee=typeof D;(Ee==="undefined"||Ee==="boolean")&&(D=null);var oe=!1;if(D===null)oe=!0;else switch(Ee){case"string":case"number":oe=!0;break;case"object":switch(D.$$typeof){case o:case e:oe=!0}}if(oe)return oe=D,ke=ke(oe),D=ge===""?"."+X(oe,0):ge,P(ke)?(ie="",D!=null&&(ie=D.replace(xe,"$&/")+"/"),re(ke,U,ie,"",function(ot){return ot})):ke!=null&&(V(ke)&&(ke=H(ke,ie+(!ke.key||oe&&oe.key===ke.key?"":(""+ke.key).replace(xe,"$&/")+"/")+D)),U.push(ke)),1;if(oe=0,ge=ge===""?".":ge+":",P(D))for(var Ie=0;Ie<D.length;Ie++){Ee=D[Ie];var Le=ge+X(Ee,Ie);oe+=re(Ee,U,ie,Le,ke)}else if(Le=y(D),typeof Le=="function")for(D=Le.call(D),Ie=0;!(Ee=D.next()).done;)Ee=Ee.value,Le=ge+X(Ee,Ie++),oe+=re(Ee,U,ie,Le,ke);else if(Ee==="object")throw U=String(D),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return oe}function te(D,U,ie){if(D==null)return D;var ge=[],ke=0;return re(D,ge,"","",function(Ee){return U.call(ie,Ee,ke++)}),ge}function J(D){if(D._status===-1){var U=D._result;U=U(),U.then(function(ie){(D._status===0||D._status===-1)&&(D._status=1,D._result=ie)},function(ie){(D._status===0||D._status===-1)&&(D._status=2,D._result=ie)}),D._status===-1&&(D._status=0,D._result=U)}if(D._status===1)return D._result.default;throw D._result}var K={current:null},j={transition:null},ne={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:j,ReactCurrentOwner:N};function se(){throw Error("act(...) is not supported in production builds of React.")}return De.Children={map:te,forEach:function(D,U,ie){te(D,function(){U.apply(this,arguments)},ie)},count:function(D){var U=0;return te(D,function(){U++}),U},toArray:function(D){return te(D,function(U){return U})||[]},only:function(D){if(!V(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},De.Component=A,De.Fragment=t,De.Profiler=i,De.PureComponent=k,De.StrictMode=n,De.Suspense=h,De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,De.act=se,De.cloneElement=function(D,U,ie){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var ge=_({},D.props),ke=D.key,Ee=D.ref,oe=D._owner;if(U!=null){if(U.ref!==void 0&&(Ee=U.ref,oe=N.current),U.key!==void 0&&(ke=""+U.key),D.type&&D.type.defaultProps)var Ie=D.type.defaultProps;for(Le in U)R.call(U,Le)&&!O.hasOwnProperty(Le)&&(ge[Le]=U[Le]===void 0&&Ie!==void 0?Ie[Le]:U[Le])}var Le=arguments.length-2;if(Le===1)ge.children=ie;else if(1<Le){Ie=Array(Le);for(var ot=0;ot<Le;ot++)Ie[ot]=arguments[ot+2];ge.children=Ie}return{$$typeof:o,type:D.type,key:ke,ref:Ee,props:ge,_owner:oe}},De.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:a,_context:D},D.Consumer=D},De.createElement=L,De.createFactory=function(D){var U=L.bind(null,D);return U.type=D,U},De.createRef=function(){return{current:null}},De.forwardRef=function(D){return{$$typeof:c,render:D}},De.isValidElement=V,De.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:J}},De.memo=function(D,U){return{$$typeof:d,type:D,compare:U===void 0?null:U}},De.startTransition=function(D){var U=j.transition;j.transition={};try{D()}finally{j.transition=U}},De.unstable_act=se,De.useCallback=function(D,U){return K.current.useCallback(D,U)},De.useContext=function(D){return K.current.useContext(D)},De.useDebugValue=function(){},De.useDeferredValue=function(D){return K.current.useDeferredValue(D)},De.useEffect=function(D,U){return K.current.useEffect(D,U)},De.useId=function(){return K.current.useId()},De.useImperativeHandle=function(D,U,ie){return K.current.useImperativeHandle(D,U,ie)},De.useInsertionEffect=function(D,U){return K.current.useInsertionEffect(D,U)},De.useLayoutEffect=function(D,U){return K.current.useLayoutEffect(D,U)},De.useMemo=function(D,U){return K.current.useMemo(D,U)},De.useReducer=function(D,U,ie){return K.current.useReducer(D,U,ie)},De.useRef=function(D){return K.current.useRef(D)},De.useState=function(D){return K.current.useState(D)},De.useSyncExternalStore=function(D,U,ie){return K.current.useSyncExternalStore(D,U,ie)},De.useTransition=function(){return K.current.useTransition()},De.version="18.3.1",De}var Tm;function $h(){return Tm||(Tm=1,$u.exports=Lb()),$u.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pm;function Ob(){if(Pm)return Br;Pm=1;var o=$h(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,h,d){var p,m={},y=null,w=null;d!==void 0&&(y=""+d),h.key!==void 0&&(y=""+h.key),h.ref!==void 0&&(w=h.ref);for(p in h)n.call(h,p)&&!a.hasOwnProperty(p)&&(m[p]=h[p]);if(c&&c.defaultProps)for(p in h=c.defaultProps,h)m[p]===void 0&&(m[p]=h[p]);return{$$typeof:e,type:c,key:y,ref:w,props:m,_owner:i.current}}return Br.Fragment=t,Br.jsx=l,Br.jsxs=l,Br}var Nm;function Fb(){return Nm||(Nm=1,Bu.exports=Ob()),Bu.exports}var x=Fb(),Do={},zu={exports:{}},Kt={},Uu={exports:{}},Hu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm;function jb(){return Rm||(Rm=1,(function(o){function e(j,ne){var se=j.length;j.push(ne);e:for(;0<se;){var D=se-1>>>1,U=j[D];if(0<i(U,ne))j[D]=ne,j[se]=U,se=D;else break e}}function t(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var ne=j[0],se=j.pop();if(se!==ne){j[0]=se;e:for(var D=0,U=j.length,ie=U>>>1;D<ie;){var ge=2*(D+1)-1,ke=j[ge],Ee=ge+1,oe=j[Ee];if(0>i(ke,se))Ee<U&&0>i(oe,ke)?(j[D]=oe,j[Ee]=se,D=Ee):(j[D]=ke,j[ge]=se,D=ge);else if(Ee<U&&0>i(oe,se))j[D]=oe,j[Ee]=se,D=Ee;else break e}}return ne}function i(j,ne){var se=j.sortIndex-ne.sortIndex;return se!==0?se:j.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;o.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();o.unstable_now=function(){return l.now()-c}}var h=[],d=[],p=1,m=null,y=3,w=!1,_=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(j){for(var ne=t(d);ne!==null;){if(ne.callback===null)n(d);else if(ne.startTime<=j)n(d),ne.sortIndex=ne.expirationTime,e(h,ne);else break;ne=t(d)}}function P(j){if(b=!1,E(j),!_)if(t(h)!==null)_=!0,J(R);else{var ne=t(d);ne!==null&&K(P,ne.startTime-j)}}function R(j,ne){_=!1,b&&(b=!1,C(L),L=-1),w=!0;var se=y;try{for(E(ne),m=t(h);m!==null&&(!(m.expirationTime>ne)||j&&!q());){var D=m.callback;if(typeof D=="function"){m.callback=null,y=m.priorityLevel;var U=D(m.expirationTime<=ne);ne=o.unstable_now(),typeof U=="function"?m.callback=U:m===t(h)&&n(h),E(ne)}else n(h);m=t(h)}if(m!==null)var ie=!0;else{var ge=t(d);ge!==null&&K(P,ge.startTime-ne),ie=!1}return ie}finally{m=null,y=se,w=!1}}var N=!1,O=null,L=-1,H=5,V=-1;function q(){return!(o.unstable_now()-V<H)}function xe(){if(O!==null){var j=o.unstable_now();V=j;var ne=!0;try{ne=O(!0,j)}finally{ne?X():(N=!1,O=null)}}else N=!1}var X;if(typeof k=="function")X=function(){k(xe)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,te=re.port2;re.port1.onmessage=xe,X=function(){te.postMessage(null)}}else X=function(){A(xe,0)};function J(j){O=j,N||(N=!0,X())}function K(j,ne){L=A(function(){j(o.unstable_now())},ne)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(j){j.callback=null},o.unstable_continueExecution=function(){_||w||(_=!0,J(R))},o.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<j?Math.floor(1e3/j):5},o.unstable_getCurrentPriorityLevel=function(){return y},o.unstable_getFirstCallbackNode=function(){return t(h)},o.unstable_next=function(j){switch(y){case 1:case 2:case 3:var ne=3;break;default:ne=y}var se=y;y=ne;try{return j()}finally{y=se}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(j,ne){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var se=y;y=j;try{return ne()}finally{y=se}},o.unstable_scheduleCallback=function(j,ne,se){var D=o.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?D+se:D):se=D,j){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=se+U,j={id:p++,callback:ne,priorityLevel:j,startTime:se,expirationTime:U,sortIndex:-1},se>D?(j.sortIndex=se,e(d,j),t(h)===null&&j===t(d)&&(b?(C(L),L=-1):b=!0,K(P,se-D))):(j.sortIndex=U,e(h,j),_||w||(_=!0,J(R))),j},o.unstable_shouldYield=q,o.unstable_wrapCallback=function(j){var ne=y;return function(){var se=y;y=ne;try{return j.apply(this,arguments)}finally{y=se}}}})(Hu)),Hu}var Mm;function Bb(){return Mm||(Mm=1,Uu.exports=jb()),Uu.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im;function $b(){if(Im)return Kt;Im=1;var o=$h(),e=Bb();function t(s){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)r+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,r){l(s,r),l(s+"Capture",r)}function l(s,r){for(i[s]=r,s=0;s<r.length;s++)n.add(r[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function y(s){return h.call(m,s)?!0:h.call(p,s)?!1:d.test(s)?m[s]=!0:(p[s]=!0,!1)}function w(s,r,u,f){if(u!==null&&u.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function _(s,r,u,f){if(r===null||typeof r>"u"||w(s,r,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function b(s,r,u,f,g,v,S){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=f,this.attributeNamespace=g,this.mustUseProperty=u,this.propertyName=s,this.type=r,this.sanitizeURL=v,this.removeEmptyString=S}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){A[s]=new b(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var r=s[0];A[r]=new b(r,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){A[s]=new b(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){A[s]=new b(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){A[s]=new b(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){A[s]=new b(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){A[s]=new b(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){A[s]=new b(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){A[s]=new b(s,5,!1,s.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function k(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var r=s.replace(C,k);A[r]=new b(r,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var r=s.replace(C,k);A[r]=new b(r,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var r=s.replace(C,k);A[r]=new b(r,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){A[s]=new b(s,1,!1,s.toLowerCase(),null,!1,!1)}),A.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){A[s]=new b(s,1,!1,s.toLowerCase(),null,!0,!0)});function E(s,r,u,f){var g=A.hasOwnProperty(r)?A[r]:null;(g!==null?g.type!==0:f||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(_(r,u,g,f)&&(u=null),f||g===null?y(r)&&(u===null?s.removeAttribute(r):s.setAttribute(r,""+u)):g.mustUseProperty?s[g.propertyName]=u===null?g.type===3?!1:"":u:(r=g.attributeName,f=g.attributeNamespace,u===null?s.removeAttribute(r):(g=g.type,u=g===3||g===4&&u===!0?"":""+u,f?s.setAttributeNS(f,r,u):s.setAttribute(r,u))))}var P=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),N=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),q=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),K=Symbol.for("react.offscreen"),j=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=j&&s[j]||s["@@iterator"],typeof s=="function"?s:null)}var se=Object.assign,D;function U(s){if(D===void 0)try{throw Error()}catch(u){var r=u.stack.trim().match(/\n( *(at )?)/);D=r&&r[1]||""}return`
`+D+s}var ie=!1;function ge(s,r){if(!s||ie)return"";ie=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(z){var f=z}Reflect.construct(s,[],r)}else{try{r.call()}catch(z){f=z}s.call(r.prototype)}else{try{throw Error()}catch(z){f=z}s()}}catch(z){if(z&&f&&typeof z.stack=="string"){for(var g=z.stack.split(`
`),v=f.stack.split(`
`),S=g.length-1,T=v.length-1;1<=S&&0<=T&&g[S]!==v[T];)T--;for(;1<=S&&0<=T;S--,T--)if(g[S]!==v[T]){if(S!==1||T!==1)do if(S--,T--,0>T||g[S]!==v[T]){var M=`
`+g[S].replace(" at new "," at ");return s.displayName&&M.includes("<anonymous>")&&(M=M.replace("<anonymous>",s.displayName)),M}while(1<=S&&0<=T);break}}}finally{ie=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?U(s):""}function ke(s){switch(s.tag){case 5:return U(s.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return s=ge(s.type,!1),s;case 11:return s=ge(s.type.render,!1),s;case 1:return s=ge(s.type,!0),s;default:return""}}function Ee(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case O:return"Fragment";case N:return"Portal";case H:return"Profiler";case L:return"StrictMode";case X:return"Suspense";case re:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case q:return(s.displayName||"Context")+".Consumer";case V:return(s._context.displayName||"Context")+".Provider";case xe:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case te:return r=s.displayName||null,r!==null?r:Ee(s.type)||"Memo";case J:r=s._payload,s=s._init;try{return Ee(s(r))}catch{}}return null}function oe(s){var r=s.type;switch(s.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=r.render,s=s.displayName||s.name||"",r.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ee(r);case 8:return r===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ie(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Le(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ot(s){var r=Le(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r),f=""+s[r];if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,v=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return g.call(this)},set:function(S){f=""+S,v.call(this,S)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function cn(s){s._valueTracker||(s._valueTracker=ot(s))}function _n(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var u=r.getValue(),f="";return s&&(f=Le(s)?s.checked?"true":"false":s.value),s=f,s!==u?(r.setValue(s),!0):!1}function Rs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Zi(s,r){var u=r.checked;return se({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function Id(s,r){var u=r.defaultValue==null?"":r.defaultValue,f=r.checked!=null?r.checked:r.defaultChecked;u=Ie(r.value!=null?r.value:u),s._wrapperState={initialChecked:f,initialValue:u,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Dd(s,r){r=r.checked,r!=null&&E(s,"checked",r,!1)}function ql(s,r){Dd(s,r);var u=Ie(r.value),f=r.type;if(u!=null)f==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}r.hasOwnProperty("value")?Xl(s,r.type,u):r.hasOwnProperty("defaultValue")&&Xl(s,r.type,Ie(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(s.defaultChecked=!!r.defaultChecked)}function Ld(s,r,u){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var f=r.type;if(!(f!=="submit"&&f!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+s._wrapperState.initialValue,u||r===s.value||(s.value=r),s.defaultValue=r}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Xl(s,r,u){(r!=="number"||Rs(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var er=Array.isArray;function ni(s,r,u,f){if(s=s.options,r){r={};for(var g=0;g<u.length;g++)r["$"+u[g]]=!0;for(u=0;u<s.length;u++)g=r.hasOwnProperty("$"+s[u].value),s[u].selected!==g&&(s[u].selected=g),g&&f&&(s[u].defaultSelected=!0)}else{for(u=""+Ie(u),r=null,g=0;g<s.length;g++){if(s[g].value===u){s[g].selected=!0,f&&(s[g].defaultSelected=!0);return}r!==null||s[g].disabled||(r=s[g])}r!==null&&(r.selected=!0)}}function Kl(s,r){if(r.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},r,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Od(s,r){var u=r.value;if(u==null){if(u=r.children,r=r.defaultValue,u!=null){if(r!=null)throw Error(t(92));if(er(u)){if(1<u.length)throw Error(t(93));u=u[0]}r=u}r==null&&(r=""),u=r}s._wrapperState={initialValue:Ie(u)}}function Fd(s,r){var u=Ie(r.value),f=Ie(r.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),r.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),f!=null&&(s.defaultValue=""+f)}function jd(s){var r=s.textContent;r===s._wrapperState.initialValue&&r!==""&&r!==null&&(s.value=r)}function Bd(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yl(s,r){return s==null||s==="http://www.w3.org/1999/xhtml"?Bd(r):s==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Ca,$d=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,u,f,g){MSApp.execUnsafeLocalFunction(function(){return s(r,u,f,g)})}:s})(function(s,r){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=r;else{for(Ca=Ca||document.createElement("div"),Ca.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Ca.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;r.firstChild;)s.appendChild(r.firstChild)}});function tr(s,r){if(r){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=r;return}}s.textContent=r}var nr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fv=["Webkit","ms","Moz","O"];Object.keys(nr).forEach(function(s){Fv.forEach(function(r){r=r+s.charAt(0).toUpperCase()+s.substring(1),nr[r]=nr[s]})});function zd(s,r,u){return r==null||typeof r=="boolean"||r===""?"":u||typeof r!="number"||r===0||nr.hasOwnProperty(s)&&nr[s]?(""+r).trim():r+"px"}function Ud(s,r){s=s.style;for(var u in r)if(r.hasOwnProperty(u)){var f=u.indexOf("--")===0,g=zd(u,r[u],f);u==="float"&&(u="cssFloat"),f?s.setProperty(u,g):s[u]=g}}var jv=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ql(s,r){if(r){if(jv[s]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(t(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(t(61))}if(r.style!=null&&typeof r.style!="object")throw Error(t(62))}}function Jl(s,r){if(s.indexOf("-")===-1)return typeof r.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zl=null;function ec(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var tc=null,si=null,ii=null;function Hd(s){if(s=Sr(s)){if(typeof tc!="function")throw Error(t(280));var r=s.stateNode;r&&(r=Xa(r),tc(s.stateNode,s.type,r))}}function Wd(s){si?ii?ii.push(s):ii=[s]:si=s}function Vd(){if(si){var s=si,r=ii;if(ii=si=null,Hd(s),r)for(s=0;s<r.length;s++)Hd(r[s])}}function Gd(s,r){return s(r)}function qd(){}var nc=!1;function Xd(s,r,u){if(nc)return s(r,u);nc=!0;try{return Gd(s,r,u)}finally{nc=!1,(si!==null||ii!==null)&&(qd(),Vd())}}function sr(s,r){var u=s.stateNode;if(u===null)return null;var f=Xa(u);if(f===null)return null;u=f[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,r,typeof u));return u}var sc=!1;if(c)try{var ir={};Object.defineProperty(ir,"passive",{get:function(){sc=!0}}),window.addEventListener("test",ir,ir),window.removeEventListener("test",ir,ir)}catch{sc=!1}function Bv(s,r,u,f,g,v,S,T,M){var z=Array.prototype.slice.call(arguments,3);try{r.apply(u,z)}catch(G){this.onError(G)}}var rr=!1,ka=null,Ea=!1,ic=null,$v={onError:function(s){rr=!0,ka=s}};function zv(s,r,u,f,g,v,S,T,M){rr=!1,ka=null,Bv.apply($v,arguments)}function Uv(s,r,u,f,g,v,S,T,M){if(zv.apply(this,arguments),rr){if(rr){var z=ka;rr=!1,ka=null}else throw Error(t(198));Ea||(Ea=!0,ic=z)}}function Ms(s){var r=s,u=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(u=r.return),s=r.return;while(s)}return r.tag===3?u:null}function Kd(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function Yd(s){if(Ms(s)!==s)throw Error(t(188))}function Hv(s){var r=s.alternate;if(!r){if(r=Ms(s),r===null)throw Error(t(188));return r!==s?null:s}for(var u=s,f=r;;){var g=u.return;if(g===null)break;var v=g.alternate;if(v===null){if(f=g.return,f!==null){u=f;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===u)return Yd(g),s;if(v===f)return Yd(g),r;v=v.sibling}throw Error(t(188))}if(u.return!==f.return)u=g,f=v;else{for(var S=!1,T=g.child;T;){if(T===u){S=!0,u=g,f=v;break}if(T===f){S=!0,f=g,u=v;break}T=T.sibling}if(!S){for(T=v.child;T;){if(T===u){S=!0,u=v,f=g;break}if(T===f){S=!0,f=v,u=g;break}T=T.sibling}if(!S)throw Error(t(189))}}if(u.alternate!==f)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:r}function Qd(s){return s=Hv(s),s!==null?Jd(s):null}function Jd(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var r=Jd(s);if(r!==null)return r;s=s.sibling}return null}var Zd=e.unstable_scheduleCallback,ef=e.unstable_cancelCallback,Wv=e.unstable_shouldYield,Vv=e.unstable_requestPaint,it=e.unstable_now,Gv=e.unstable_getCurrentPriorityLevel,rc=e.unstable_ImmediatePriority,tf=e.unstable_UserBlockingPriority,Ta=e.unstable_NormalPriority,qv=e.unstable_LowPriority,nf=e.unstable_IdlePriority,Pa=null,In=null;function Xv(s){if(In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Pa,s,void 0,(s.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:Qv,Kv=Math.log,Yv=Math.LN2;function Qv(s){return s>>>=0,s===0?32:31-(Kv(s)/Yv|0)|0}var Na=64,Ra=4194304;function ar(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Ma(s,r){var u=s.pendingLanes;if(u===0)return 0;var f=0,g=s.suspendedLanes,v=s.pingedLanes,S=u&268435455;if(S!==0){var T=S&~g;T!==0?f=ar(T):(v&=S,v!==0&&(f=ar(v)))}else S=u&~g,S!==0?f=ar(S):v!==0&&(f=ar(v));if(f===0)return 0;if(r!==0&&r!==f&&(r&g)===0&&(g=f&-f,v=r&-r,g>=v||g===16&&(v&4194240)!==0))return r;if((f&4)!==0&&(f|=u&16),r=s.entangledLanes,r!==0)for(s=s.entanglements,r&=f;0<r;)u=31-An(r),g=1<<u,f|=s[u],r&=~g;return f}function Jv(s,r){switch(s){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zv(s,r){for(var u=s.suspendedLanes,f=s.pingedLanes,g=s.expirationTimes,v=s.pendingLanes;0<v;){var S=31-An(v),T=1<<S,M=g[S];M===-1?((T&u)===0||(T&f)!==0)&&(g[S]=Jv(T,r)):M<=r&&(s.expiredLanes|=T),v&=~T}}function ac(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function sf(){var s=Na;return Na<<=1,(Na&4194240)===0&&(Na=64),s}function oc(s){for(var r=[],u=0;31>u;u++)r.push(s);return r}function or(s,r,u){s.pendingLanes|=r,r!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,r=31-An(r),s[r]=u}function ew(s,r){var u=s.pendingLanes&~r;s.pendingLanes=r,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=r,s.mutableReadLanes&=r,s.entangledLanes&=r,r=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<u;){var g=31-An(u),v=1<<g;r[g]=0,f[g]=-1,s[g]=-1,u&=~v}}function lc(s,r){var u=s.entangledLanes|=r;for(s=s.entanglements;u;){var f=31-An(u),g=1<<f;g&r|s[f]&r&&(s[f]|=r),u&=~g}}var Ue=0;function rf(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var af,cc,of,lf,cf,uc=!1,Ia=[],as=null,os=null,ls=null,lr=new Map,cr=new Map,cs=[],tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function uf(s,r){switch(s){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":os=null;break;case"mouseover":case"mouseout":ls=null;break;case"pointerover":case"pointerout":lr.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":cr.delete(r.pointerId)}}function ur(s,r,u,f,g,v){return s===null||s.nativeEvent!==v?(s={blockedOn:r,domEventName:u,eventSystemFlags:f,nativeEvent:v,targetContainers:[g]},r!==null&&(r=Sr(r),r!==null&&cc(r)),s):(s.eventSystemFlags|=f,r=s.targetContainers,g!==null&&r.indexOf(g)===-1&&r.push(g),s)}function nw(s,r,u,f,g){switch(r){case"focusin":return as=ur(as,s,r,u,f,g),!0;case"dragenter":return os=ur(os,s,r,u,f,g),!0;case"mouseover":return ls=ur(ls,s,r,u,f,g),!0;case"pointerover":var v=g.pointerId;return lr.set(v,ur(lr.get(v)||null,s,r,u,f,g)),!0;case"gotpointercapture":return v=g.pointerId,cr.set(v,ur(cr.get(v)||null,s,r,u,f,g)),!0}return!1}function hf(s){var r=Is(s.target);if(r!==null){var u=Ms(r);if(u!==null){if(r=u.tag,r===13){if(r=Kd(u),r!==null){s.blockedOn=r,cf(s.priority,function(){of(u)});return}}else if(r===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Da(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var u=dc(s.domEventName,s.eventSystemFlags,r[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var f=new u.constructor(u.type,u);Zl=f,u.target.dispatchEvent(f),Zl=null}else return r=Sr(u),r!==null&&cc(r),s.blockedOn=u,!1;r.shift()}return!0}function df(s,r,u){Da(s)&&u.delete(r)}function sw(){uc=!1,as!==null&&Da(as)&&(as=null),os!==null&&Da(os)&&(os=null),ls!==null&&Da(ls)&&(ls=null),lr.forEach(df),cr.forEach(df)}function hr(s,r){s.blockedOn===r&&(s.blockedOn=null,uc||(uc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sw)))}function dr(s){function r(g){return hr(g,s)}if(0<Ia.length){hr(Ia[0],s);for(var u=1;u<Ia.length;u++){var f=Ia[u];f.blockedOn===s&&(f.blockedOn=null)}}for(as!==null&&hr(as,s),os!==null&&hr(os,s),ls!==null&&hr(ls,s),lr.forEach(r),cr.forEach(r),u=0;u<cs.length;u++)f=cs[u],f.blockedOn===s&&(f.blockedOn=null);for(;0<cs.length&&(u=cs[0],u.blockedOn===null);)hf(u),u.blockedOn===null&&cs.shift()}var ri=P.ReactCurrentBatchConfig,La=!0;function iw(s,r,u,f){var g=Ue,v=ri.transition;ri.transition=null;try{Ue=1,hc(s,r,u,f)}finally{Ue=g,ri.transition=v}}function rw(s,r,u,f){var g=Ue,v=ri.transition;ri.transition=null;try{Ue=4,hc(s,r,u,f)}finally{Ue=g,ri.transition=v}}function hc(s,r,u,f){if(La){var g=dc(s,r,u,f);if(g===null)Pc(s,r,f,Oa,u),uf(s,f);else if(nw(g,s,r,u,f))f.stopPropagation();else if(uf(s,f),r&4&&-1<tw.indexOf(s)){for(;g!==null;){var v=Sr(g);if(v!==null&&af(v),v=dc(s,r,u,f),v===null&&Pc(s,r,f,Oa,u),v===g)break;g=v}g!==null&&f.stopPropagation()}else Pc(s,r,f,null,u)}}var Oa=null;function dc(s,r,u,f){if(Oa=null,s=ec(f),s=Is(s),s!==null)if(r=Ms(s),r===null)s=null;else if(u=r.tag,u===13){if(s=Kd(r),s!==null)return s;s=null}else if(u===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null);return Oa=s,null}function ff(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gv()){case rc:return 1;case tf:return 4;case Ta:case qv:return 16;case nf:return 536870912;default:return 16}default:return 16}}var us=null,fc=null,Fa=null;function pf(){if(Fa)return Fa;var s,r=fc,u=r.length,f,g="value"in us?us.value:us.textContent,v=g.length;for(s=0;s<u&&r[s]===g[s];s++);var S=u-s;for(f=1;f<=S&&r[u-f]===g[v-f];f++);return Fa=g.slice(s,1<f?1-f:void 0)}function ja(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function Ba(){return!0}function mf(){return!1}function Zt(s){function r(u,f,g,v,S){this._reactName=u,this._targetInst=g,this.type=f,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var T in s)s.hasOwnProperty(T)&&(u=s[T],this[T]=u?u(v):v[T]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ba:mf,this.isPropagationStopped=mf,this}return se(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),r}var ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pc=Zt(ai),fr=se({},ai,{view:0,detail:0}),aw=Zt(fr),mc,gc,pr,$a=se({},fr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vc,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==pr&&(pr&&s.type==="mousemove"?(mc=s.screenX-pr.screenX,gc=s.screenY-pr.screenY):gc=mc=0,pr=s),mc)},movementY:function(s){return"movementY"in s?s.movementY:gc}}),gf=Zt($a),ow=se({},$a,{dataTransfer:0}),lw=Zt(ow),cw=se({},fr,{relatedTarget:0}),yc=Zt(cw),uw=se({},ai,{animationName:0,elapsedTime:0,pseudoElement:0}),hw=Zt(uw),dw=se({},ai,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),fw=Zt(dw),pw=se({},ai,{data:0}),yf=Zt(pw),mw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vw(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=yw[s])?!!r[s]:!1}function vc(){return vw}var ww=se({},fr,{key:function(s){if(s.key){var r=mw[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=ja(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?gw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vc,charCode:function(s){return s.type==="keypress"?ja(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ja(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),bw=Zt(ww),xw=se({},$a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vf=Zt(xw),_w=se({},fr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vc}),Aw=Zt(_w),Sw=se({},ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cw=Zt(Sw),kw=se({},$a,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ew=Zt(kw),Tw=[9,13,27,32],wc=c&&"CompositionEvent"in window,mr=null;c&&"documentMode"in document&&(mr=document.documentMode);var Pw=c&&"TextEvent"in window&&!mr,wf=c&&(!wc||mr&&8<mr&&11>=mr),bf=" ",xf=!1;function _f(s,r){switch(s){case"keyup":return Tw.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Af(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var oi=!1;function Nw(s,r){switch(s){case"compositionend":return Af(r);case"keypress":return r.which!==32?null:(xf=!0,bf);case"textInput":return s=r.data,s===bf&&xf?null:s;default:return null}}function Rw(s,r){if(oi)return s==="compositionend"||!wc&&_f(s,r)?(s=pf(),Fa=fc=us=null,oi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return wf&&r.locale!=="ko"?null:r.data;default:return null}}var Mw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!Mw[s.type]:r==="textarea"}function Cf(s,r,u,f){Wd(f),r=Va(r,"onChange"),0<r.length&&(u=new pc("onChange","change",null,u,f),s.push({event:u,listeners:r}))}var gr=null,yr=null;function Iw(s){Hf(s,0)}function za(s){var r=di(s);if(_n(r))return s}function Dw(s,r){if(s==="change")return r}var kf=!1;if(c){var bc;if(c){var xc="oninput"in document;if(!xc){var Ef=document.createElement("div");Ef.setAttribute("oninput","return;"),xc=typeof Ef.oninput=="function"}bc=xc}else bc=!1;kf=bc&&(!document.documentMode||9<document.documentMode)}function Tf(){gr&&(gr.detachEvent("onpropertychange",Pf),yr=gr=null)}function Pf(s){if(s.propertyName==="value"&&za(yr)){var r=[];Cf(r,yr,s,ec(s)),Xd(Iw,r)}}function Lw(s,r,u){s==="focusin"?(Tf(),gr=r,yr=u,gr.attachEvent("onpropertychange",Pf)):s==="focusout"&&Tf()}function Ow(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return za(yr)}function Fw(s,r){if(s==="click")return za(r)}function jw(s,r){if(s==="input"||s==="change")return za(r)}function Bw(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Sn=typeof Object.is=="function"?Object.is:Bw;function vr(s,r){if(Sn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var u=Object.keys(s),f=Object.keys(r);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var g=u[f];if(!h.call(r,g)||!Sn(s[g],r[g]))return!1}return!0}function Nf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Rf(s,r){var u=Nf(s);s=0;for(var f;u;){if(u.nodeType===3){if(f=s+u.textContent.length,s<=r&&f>=r)return{node:u,offset:r-s};s=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Nf(u)}}function Mf(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Mf(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function If(){for(var s=window,r=Rs();r instanceof s.HTMLIFrameElement;){try{var u=typeof r.contentWindow.location.href=="string"}catch{u=!1}if(u)s=r.contentWindow;else break;r=Rs(s.document)}return r}function _c(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}function $w(s){var r=If(),u=s.focusedElem,f=s.selectionRange;if(r!==u&&u&&u.ownerDocument&&Mf(u.ownerDocument.documentElement,u)){if(f!==null&&_c(u)){if(r=f.start,s=f.end,s===void 0&&(s=r),"selectionStart"in u)u.selectionStart=r,u.selectionEnd=Math.min(s,u.value.length);else if(s=(r=u.ownerDocument||document)&&r.defaultView||window,s.getSelection){s=s.getSelection();var g=u.textContent.length,v=Math.min(f.start,g);f=f.end===void 0?v:Math.min(f.end,g),!s.extend&&v>f&&(g=f,f=v,v=g),g=Rf(u,v);var S=Rf(u,f);g&&S&&(s.rangeCount!==1||s.anchorNode!==g.node||s.anchorOffset!==g.offset||s.focusNode!==S.node||s.focusOffset!==S.offset)&&(r=r.createRange(),r.setStart(g.node,g.offset),s.removeAllRanges(),v>f?(s.addRange(r),s.extend(S.node,S.offset)):(r.setEnd(S.node,S.offset),s.addRange(r)))}}for(r=[],s=u;s=s.parentNode;)s.nodeType===1&&r.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<r.length;u++)s=r[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var zw=c&&"documentMode"in document&&11>=document.documentMode,li=null,Ac=null,wr=null,Sc=!1;function Df(s,r,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Sc||li==null||li!==Rs(f)||(f=li,"selectionStart"in f&&_c(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),wr&&vr(wr,f)||(wr=f,f=Va(Ac,"onSelect"),0<f.length&&(r=new pc("onSelect","select",null,r,u),s.push({event:r,listeners:f}),r.target=li)))}function Ua(s,r){var u={};return u[s.toLowerCase()]=r.toLowerCase(),u["Webkit"+s]="webkit"+r,u["Moz"+s]="moz"+r,u}var ci={animationend:Ua("Animation","AnimationEnd"),animationiteration:Ua("Animation","AnimationIteration"),animationstart:Ua("Animation","AnimationStart"),transitionend:Ua("Transition","TransitionEnd")},Cc={},Lf={};c&&(Lf=document.createElement("div").style,"AnimationEvent"in window||(delete ci.animationend.animation,delete ci.animationiteration.animation,delete ci.animationstart.animation),"TransitionEvent"in window||delete ci.transitionend.transition);function Ha(s){if(Cc[s])return Cc[s];if(!ci[s])return s;var r=ci[s],u;for(u in r)if(r.hasOwnProperty(u)&&u in Lf)return Cc[s]=r[u];return s}var Of=Ha("animationend"),Ff=Ha("animationiteration"),jf=Ha("animationstart"),Bf=Ha("transitionend"),$f=new Map,zf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hs(s,r){$f.set(s,r),a(r,[s])}for(var kc=0;kc<zf.length;kc++){var Ec=zf[kc],Uw=Ec.toLowerCase(),Hw=Ec[0].toUpperCase()+Ec.slice(1);hs(Uw,"on"+Hw)}hs(Of,"onAnimationEnd"),hs(Ff,"onAnimationIteration"),hs(jf,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(Bf,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ww=new Set("cancel close invalid load scroll toggle".split(" ").concat(br));function Uf(s,r,u){var f=s.type||"unknown-event";s.currentTarget=u,Uv(f,r,void 0,s),s.currentTarget=null}function Hf(s,r){r=(r&4)!==0;for(var u=0;u<s.length;u++){var f=s[u],g=f.event;f=f.listeners;e:{var v=void 0;if(r)for(var S=f.length-1;0<=S;S--){var T=f[S],M=T.instance,z=T.currentTarget;if(T=T.listener,M!==v&&g.isPropagationStopped())break e;Uf(g,T,z),v=M}else for(S=0;S<f.length;S++){if(T=f[S],M=T.instance,z=T.currentTarget,T=T.listener,M!==v&&g.isPropagationStopped())break e;Uf(g,T,z),v=M}}}if(Ea)throw s=ic,Ea=!1,ic=null,s}function qe(s,r){var u=r[Lc];u===void 0&&(u=r[Lc]=new Set);var f=s+"__bubble";u.has(f)||(Wf(r,s,2,!1),u.add(f))}function Tc(s,r,u){var f=0;r&&(f|=4),Wf(u,s,f,r)}var Wa="_reactListening"+Math.random().toString(36).slice(2);function xr(s){if(!s[Wa]){s[Wa]=!0,n.forEach(function(u){u!=="selectionchange"&&(Ww.has(u)||Tc(u,!1,s),Tc(u,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Wa]||(r[Wa]=!0,Tc("selectionchange",!1,r))}}function Wf(s,r,u,f){switch(ff(r)){case 1:var g=iw;break;case 4:g=rw;break;default:g=hc}u=g.bind(null,r,u,s),g=void 0,!sc||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(g=!0),f?g!==void 0?s.addEventListener(r,u,{capture:!0,passive:g}):s.addEventListener(r,u,!0):g!==void 0?s.addEventListener(r,u,{passive:g}):s.addEventListener(r,u,!1)}function Pc(s,r,u,f,g){var v=f;if((r&1)===0&&(r&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var T=f.stateNode.containerInfo;if(T===g||T.nodeType===8&&T.parentNode===g)break;if(S===4)for(S=f.return;S!==null;){var M=S.tag;if((M===3||M===4)&&(M=S.stateNode.containerInfo,M===g||M.nodeType===8&&M.parentNode===g))return;S=S.return}for(;T!==null;){if(S=Is(T),S===null)return;if(M=S.tag,M===5||M===6){f=v=S;continue e}T=T.parentNode}}f=f.return}Xd(function(){var z=v,G=ec(u),Y=[];e:{var W=$f.get(s);if(W!==void 0){var ae=pc,de=s;switch(s){case"keypress":if(ja(u)===0)break e;case"keydown":case"keyup":ae=bw;break;case"focusin":de="focus",ae=yc;break;case"focusout":de="blur",ae=yc;break;case"beforeblur":case"afterblur":ae=yc;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ae=gf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ae=lw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ae=Aw;break;case Of:case Ff:case jf:ae=hw;break;case Bf:ae=Cw;break;case"scroll":ae=aw;break;case"wheel":ae=Ew;break;case"copy":case"cut":case"paste":ae=fw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ae=vf}var me=(r&4)!==0,rt=!me&&s==="scroll",F=me?W!==null?W+"Capture":null:W;me=[];for(var I=z,B;I!==null;){B=I;var Z=B.stateNode;if(B.tag===5&&Z!==null&&(B=Z,F!==null&&(Z=sr(I,F),Z!=null&&me.push(_r(I,Z,B)))),rt)break;I=I.return}0<me.length&&(W=new ae(W,de,null,u,G),Y.push({event:W,listeners:me}))}}if((r&7)===0){e:{if(W=s==="mouseover"||s==="pointerover",ae=s==="mouseout"||s==="pointerout",W&&u!==Zl&&(de=u.relatedTarget||u.fromElement)&&(Is(de)||de[Gn]))break e;if((ae||W)&&(W=G.window===G?G:(W=G.ownerDocument)?W.defaultView||W.parentWindow:window,ae?(de=u.relatedTarget||u.toElement,ae=z,de=de?Is(de):null,de!==null&&(rt=Ms(de),de!==rt||de.tag!==5&&de.tag!==6)&&(de=null)):(ae=null,de=z),ae!==de)){if(me=gf,Z="onMouseLeave",F="onMouseEnter",I="mouse",(s==="pointerout"||s==="pointerover")&&(me=vf,Z="onPointerLeave",F="onPointerEnter",I="pointer"),rt=ae==null?W:di(ae),B=de==null?W:di(de),W=new me(Z,I+"leave",ae,u,G),W.target=rt,W.relatedTarget=B,Z=null,Is(G)===z&&(me=new me(F,I+"enter",de,u,G),me.target=B,me.relatedTarget=rt,Z=me),rt=Z,ae&&de)t:{for(me=ae,F=de,I=0,B=me;B;B=ui(B))I++;for(B=0,Z=F;Z;Z=ui(Z))B++;for(;0<I-B;)me=ui(me),I--;for(;0<B-I;)F=ui(F),B--;for(;I--;){if(me===F||F!==null&&me===F.alternate)break t;me=ui(me),F=ui(F)}me=null}else me=null;ae!==null&&Vf(Y,W,ae,me,!1),de!==null&&rt!==null&&Vf(Y,rt,de,me,!0)}}e:{if(W=z?di(z):window,ae=W.nodeName&&W.nodeName.toLowerCase(),ae==="select"||ae==="input"&&W.type==="file")var ye=Dw;else if(Sf(W))if(kf)ye=jw;else{ye=Ow;var _e=Lw}else(ae=W.nodeName)&&ae.toLowerCase()==="input"&&(W.type==="checkbox"||W.type==="radio")&&(ye=Fw);if(ye&&(ye=ye(s,z))){Cf(Y,ye,u,G);break e}_e&&_e(s,W,z),s==="focusout"&&(_e=W._wrapperState)&&_e.controlled&&W.type==="number"&&Xl(W,"number",W.value)}switch(_e=z?di(z):window,s){case"focusin":(Sf(_e)||_e.contentEditable==="true")&&(li=_e,Ac=z,wr=null);break;case"focusout":wr=Ac=li=null;break;case"mousedown":Sc=!0;break;case"contextmenu":case"mouseup":case"dragend":Sc=!1,Df(Y,u,G);break;case"selectionchange":if(zw)break;case"keydown":case"keyup":Df(Y,u,G)}var Ae;if(wc)e:{switch(s){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else oi?_f(s,u)&&(Ce="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ce="onCompositionStart");Ce&&(wf&&u.locale!=="ko"&&(oi||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&oi&&(Ae=pf()):(us=G,fc="value"in us?us.value:us.textContent,oi=!0)),_e=Va(z,Ce),0<_e.length&&(Ce=new yf(Ce,s,null,u,G),Y.push({event:Ce,listeners:_e}),Ae?Ce.data=Ae:(Ae=Af(u),Ae!==null&&(Ce.data=Ae)))),(Ae=Pw?Nw(s,u):Rw(s,u))&&(z=Va(z,"onBeforeInput"),0<z.length&&(G=new yf("onBeforeInput","beforeinput",null,u,G),Y.push({event:G,listeners:z}),G.data=Ae))}Hf(Y,r)})}function _r(s,r,u){return{instance:s,listener:r,currentTarget:u}}function Va(s,r){for(var u=r+"Capture",f=[];s!==null;){var g=s,v=g.stateNode;g.tag===5&&v!==null&&(g=v,v=sr(s,u),v!=null&&f.unshift(_r(s,v,g)),v=sr(s,r),v!=null&&f.push(_r(s,v,g))),s=s.return}return f}function ui(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Vf(s,r,u,f,g){for(var v=r._reactName,S=[];u!==null&&u!==f;){var T=u,M=T.alternate,z=T.stateNode;if(M!==null&&M===f)break;T.tag===5&&z!==null&&(T=z,g?(M=sr(u,v),M!=null&&S.unshift(_r(u,M,T))):g||(M=sr(u,v),M!=null&&S.push(_r(u,M,T)))),u=u.return}S.length!==0&&s.push({event:r,listeners:S})}var Vw=/\r\n?/g,Gw=/\u0000|\uFFFD/g;function Gf(s){return(typeof s=="string"?s:""+s).replace(Vw,`
`).replace(Gw,"")}function Ga(s,r,u){if(r=Gf(r),Gf(s)!==r&&u)throw Error(t(425))}function qa(){}var Nc=null,Rc=null;function Mc(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Ic=typeof setTimeout=="function"?setTimeout:void 0,qw=typeof clearTimeout=="function"?clearTimeout:void 0,qf=typeof Promise=="function"?Promise:void 0,Xw=typeof queueMicrotask=="function"?queueMicrotask:typeof qf<"u"?function(s){return qf.resolve(null).then(s).catch(Kw)}:Ic;function Kw(s){setTimeout(function(){throw s})}function Dc(s,r){var u=r,f=0;do{var g=u.nextSibling;if(s.removeChild(u),g&&g.nodeType===8)if(u=g.data,u==="/$"){if(f===0){s.removeChild(g),dr(r);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=g}while(u);dr(r)}function ds(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return s}function Xf(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(r===0)return s;r--}else u==="/$"&&r++}s=s.previousSibling}return null}var hi=Math.random().toString(36).slice(2),Dn="__reactFiber$"+hi,Ar="__reactProps$"+hi,Gn="__reactContainer$"+hi,Lc="__reactEvents$"+hi,Yw="__reactListeners$"+hi,Qw="__reactHandles$"+hi;function Is(s){var r=s[Dn];if(r)return r;for(var u=s.parentNode;u;){if(r=u[Gn]||u[Dn]){if(u=r.alternate,r.child!==null||u!==null&&u.child!==null)for(s=Xf(s);s!==null;){if(u=s[Dn])return u;s=Xf(s)}return r}s=u,u=s.parentNode}return null}function Sr(s){return s=s[Dn]||s[Gn],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function di(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Xa(s){return s[Ar]||null}var Oc=[],fi=-1;function fs(s){return{current:s}}function Xe(s){0>fi||(s.current=Oc[fi],Oc[fi]=null,fi--)}function Ve(s,r){fi++,Oc[fi]=s.current,s.current=r}var ps={},Dt=fs(ps),Wt=fs(!1),Ds=ps;function pi(s,r){var u=s.type.contextTypes;if(!u)return ps;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===r)return f.__reactInternalMemoizedMaskedChildContext;var g={},v;for(v in u)g[v]=r[v];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=r,s.__reactInternalMemoizedMaskedChildContext=g),g}function Vt(s){return s=s.childContextTypes,s!=null}function Ka(){Xe(Wt),Xe(Dt)}function Kf(s,r,u){if(Dt.current!==ps)throw Error(t(168));Ve(Dt,r),Ve(Wt,u)}function Yf(s,r,u){var f=s.stateNode;if(r=r.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var g in f)if(!(g in r))throw Error(t(108,oe(s)||"Unknown",g));return se({},u,f)}function Ya(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ps,Ds=Dt.current,Ve(Dt,s),Ve(Wt,Wt.current),!0}function Qf(s,r,u){var f=s.stateNode;if(!f)throw Error(t(169));u?(s=Yf(s,r,Ds),f.__reactInternalMemoizedMergedChildContext=s,Xe(Wt),Xe(Dt),Ve(Dt,s)):Xe(Wt),Ve(Wt,u)}var qn=null,Qa=!1,Fc=!1;function Jf(s){qn===null?qn=[s]:qn.push(s)}function Jw(s){Qa=!0,Jf(s)}function ms(){if(!Fc&&qn!==null){Fc=!0;var s=0,r=Ue;try{var u=qn;for(Ue=1;s<u.length;s++){var f=u[s];do f=f(!0);while(f!==null)}qn=null,Qa=!1}catch(g){throw qn!==null&&(qn=qn.slice(s+1)),Zd(rc,ms),g}finally{Ue=r,Fc=!1}}return null}var mi=[],gi=0,Ja=null,Za=0,un=[],hn=0,Ls=null,Xn=1,Kn="";function Os(s,r){mi[gi++]=Za,mi[gi++]=Ja,Ja=s,Za=r}function Zf(s,r,u){un[hn++]=Xn,un[hn++]=Kn,un[hn++]=Ls,Ls=s;var f=Xn;s=Kn;var g=32-An(f)-1;f&=~(1<<g),u+=1;var v=32-An(r)+g;if(30<v){var S=g-g%5;v=(f&(1<<S)-1).toString(32),f>>=S,g-=S,Xn=1<<32-An(r)+g|u<<g|f,Kn=v+s}else Xn=1<<v|u<<g|f,Kn=s}function jc(s){s.return!==null&&(Os(s,1),Zf(s,1,0))}function Bc(s){for(;s===Ja;)Ja=mi[--gi],mi[gi]=null,Za=mi[--gi],mi[gi]=null;for(;s===Ls;)Ls=un[--hn],un[hn]=null,Kn=un[--hn],un[hn]=null,Xn=un[--hn],un[hn]=null}var en=null,tn=null,Ke=!1,Cn=null;function ep(s,r){var u=mn(5,null,null,0);u.elementType="DELETED",u.stateNode=r,u.return=s,r=s.deletions,r===null?(s.deletions=[u],s.flags|=16):r.push(u)}function tp(s,r){switch(s.tag){case 5:var u=s.type;return r=r.nodeType!==1||u.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(s.stateNode=r,en=s,tn=ds(r.firstChild),!0):!1;case 6:return r=s.pendingProps===""||r.nodeType!==3?null:r,r!==null?(s.stateNode=r,en=s,tn=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(u=Ls!==null?{id:Xn,overflow:Kn}:null,s.memoizedState={dehydrated:r,treeContext:u,retryLane:1073741824},u=mn(18,null,null,0),u.stateNode=r,u.return=s,s.child=u,en=s,tn=null,!0):!1;default:return!1}}function $c(s){return(s.mode&1)!==0&&(s.flags&128)===0}function zc(s){if(Ke){var r=tn;if(r){var u=r;if(!tp(s,r)){if($c(s))throw Error(t(418));r=ds(u.nextSibling);var f=en;r&&tp(s,r)?ep(f,u):(s.flags=s.flags&-4097|2,Ke=!1,en=s)}}else{if($c(s))throw Error(t(418));s.flags=s.flags&-4097|2,Ke=!1,en=s}}}function np(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;en=s}function eo(s){if(s!==en)return!1;if(!Ke)return np(s),Ke=!0,!1;var r;if((r=s.tag!==3)&&!(r=s.tag!==5)&&(r=s.type,r=r!=="head"&&r!=="body"&&!Mc(s.type,s.memoizedProps)),r&&(r=tn)){if($c(s))throw sp(),Error(t(418));for(;r;)ep(s,r),r=ds(r.nextSibling)}if(np(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,r=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(r===0){tn=ds(s.nextSibling);break e}r--}else u!=="$"&&u!=="$!"&&u!=="$?"||r++}s=s.nextSibling}tn=null}}else tn=en?ds(s.stateNode.nextSibling):null;return!0}function sp(){for(var s=tn;s;)s=ds(s.nextSibling)}function yi(){tn=en=null,Ke=!1}function Uc(s){Cn===null?Cn=[s]:Cn.push(s)}var Zw=P.ReactCurrentBatchConfig;function Cr(s,r,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var f=u.stateNode}if(!f)throw Error(t(147,s));var g=f,v=""+s;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===v?r.ref:(r=function(S){var T=g.refs;S===null?delete T[v]:T[v]=S},r._stringRef=v,r)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function to(s,r){throw s=Object.prototype.toString.call(r),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s))}function ip(s){var r=s._init;return r(s._payload)}function rp(s){function r(F,I){if(s){var B=F.deletions;B===null?(F.deletions=[I],F.flags|=16):B.push(I)}}function u(F,I){if(!s)return null;for(;I!==null;)r(F,I),I=I.sibling;return null}function f(F,I){for(F=new Map;I!==null;)I.key!==null?F.set(I.key,I):F.set(I.index,I),I=I.sibling;return F}function g(F,I){return F=As(F,I),F.index=0,F.sibling=null,F}function v(F,I,B){return F.index=B,s?(B=F.alternate,B!==null?(B=B.index,B<I?(F.flags|=2,I):B):(F.flags|=2,I)):(F.flags|=1048576,I)}function S(F){return s&&F.alternate===null&&(F.flags|=2),F}function T(F,I,B,Z){return I===null||I.tag!==6?(I=Iu(B,F.mode,Z),I.return=F,I):(I=g(I,B),I.return=F,I)}function M(F,I,B,Z){var ye=B.type;return ye===O?G(F,I,B.props.children,Z,B.key):I!==null&&(I.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===J&&ip(ye)===I.type)?(Z=g(I,B.props),Z.ref=Cr(F,I,B),Z.return=F,Z):(Z=ko(B.type,B.key,B.props,null,F.mode,Z),Z.ref=Cr(F,I,B),Z.return=F,Z)}function z(F,I,B,Z){return I===null||I.tag!==4||I.stateNode.containerInfo!==B.containerInfo||I.stateNode.implementation!==B.implementation?(I=Du(B,F.mode,Z),I.return=F,I):(I=g(I,B.children||[]),I.return=F,I)}function G(F,I,B,Z,ye){return I===null||I.tag!==7?(I=Ws(B,F.mode,Z,ye),I.return=F,I):(I=g(I,B),I.return=F,I)}function Y(F,I,B){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Iu(""+I,F.mode,B),I.return=F,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case R:return B=ko(I.type,I.key,I.props,null,F.mode,B),B.ref=Cr(F,null,I),B.return=F,B;case N:return I=Du(I,F.mode,B),I.return=F,I;case J:var Z=I._init;return Y(F,Z(I._payload),B)}if(er(I)||ne(I))return I=Ws(I,F.mode,B,null),I.return=F,I;to(F,I)}return null}function W(F,I,B,Z){var ye=I!==null?I.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return ye!==null?null:T(F,I,""+B,Z);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case R:return B.key===ye?M(F,I,B,Z):null;case N:return B.key===ye?z(F,I,B,Z):null;case J:return ye=B._init,W(F,I,ye(B._payload),Z)}if(er(B)||ne(B))return ye!==null?null:G(F,I,B,Z,null);to(F,B)}return null}function ae(F,I,B,Z,ye){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return F=F.get(B)||null,T(I,F,""+Z,ye);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:return F=F.get(Z.key===null?B:Z.key)||null,M(I,F,Z,ye);case N:return F=F.get(Z.key===null?B:Z.key)||null,z(I,F,Z,ye);case J:var _e=Z._init;return ae(F,I,B,_e(Z._payload),ye)}if(er(Z)||ne(Z))return F=F.get(B)||null,G(I,F,Z,ye,null);to(I,Z)}return null}function de(F,I,B,Z){for(var ye=null,_e=null,Ae=I,Ce=I=0,wt=null;Ae!==null&&Ce<B.length;Ce++){Ae.index>Ce?(wt=Ae,Ae=null):wt=Ae.sibling;var Be=W(F,Ae,B[Ce],Z);if(Be===null){Ae===null&&(Ae=wt);break}s&&Ae&&Be.alternate===null&&r(F,Ae),I=v(Be,I,Ce),_e===null?ye=Be:_e.sibling=Be,_e=Be,Ae=wt}if(Ce===B.length)return u(F,Ae),Ke&&Os(F,Ce),ye;if(Ae===null){for(;Ce<B.length;Ce++)Ae=Y(F,B[Ce],Z),Ae!==null&&(I=v(Ae,I,Ce),_e===null?ye=Ae:_e.sibling=Ae,_e=Ae);return Ke&&Os(F,Ce),ye}for(Ae=f(F,Ae);Ce<B.length;Ce++)wt=ae(Ae,F,Ce,B[Ce],Z),wt!==null&&(s&&wt.alternate!==null&&Ae.delete(wt.key===null?Ce:wt.key),I=v(wt,I,Ce),_e===null?ye=wt:_e.sibling=wt,_e=wt);return s&&Ae.forEach(function(Ss){return r(F,Ss)}),Ke&&Os(F,Ce),ye}function me(F,I,B,Z){var ye=ne(B);if(typeof ye!="function")throw Error(t(150));if(B=ye.call(B),B==null)throw Error(t(151));for(var _e=ye=null,Ae=I,Ce=I=0,wt=null,Be=B.next();Ae!==null&&!Be.done;Ce++,Be=B.next()){Ae.index>Ce?(wt=Ae,Ae=null):wt=Ae.sibling;var Ss=W(F,Ae,Be.value,Z);if(Ss===null){Ae===null&&(Ae=wt);break}s&&Ae&&Ss.alternate===null&&r(F,Ae),I=v(Ss,I,Ce),_e===null?ye=Ss:_e.sibling=Ss,_e=Ss,Ae=wt}if(Be.done)return u(F,Ae),Ke&&Os(F,Ce),ye;if(Ae===null){for(;!Be.done;Ce++,Be=B.next())Be=Y(F,Be.value,Z),Be!==null&&(I=v(Be,I,Ce),_e===null?ye=Be:_e.sibling=Be,_e=Be);return Ke&&Os(F,Ce),ye}for(Ae=f(F,Ae);!Be.done;Ce++,Be=B.next())Be=ae(Ae,F,Ce,Be.value,Z),Be!==null&&(s&&Be.alternate!==null&&Ae.delete(Be.key===null?Ce:Be.key),I=v(Be,I,Ce),_e===null?ye=Be:_e.sibling=Be,_e=Be);return s&&Ae.forEach(function(Mb){return r(F,Mb)}),Ke&&Os(F,Ce),ye}function rt(F,I,B,Z){if(typeof B=="object"&&B!==null&&B.type===O&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case R:e:{for(var ye=B.key,_e=I;_e!==null;){if(_e.key===ye){if(ye=B.type,ye===O){if(_e.tag===7){u(F,_e.sibling),I=g(_e,B.props.children),I.return=F,F=I;break e}}else if(_e.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===J&&ip(ye)===_e.type){u(F,_e.sibling),I=g(_e,B.props),I.ref=Cr(F,_e,B),I.return=F,F=I;break e}u(F,_e);break}else r(F,_e);_e=_e.sibling}B.type===O?(I=Ws(B.props.children,F.mode,Z,B.key),I.return=F,F=I):(Z=ko(B.type,B.key,B.props,null,F.mode,Z),Z.ref=Cr(F,I,B),Z.return=F,F=Z)}return S(F);case N:e:{for(_e=B.key;I!==null;){if(I.key===_e)if(I.tag===4&&I.stateNode.containerInfo===B.containerInfo&&I.stateNode.implementation===B.implementation){u(F,I.sibling),I=g(I,B.children||[]),I.return=F,F=I;break e}else{u(F,I);break}else r(F,I);I=I.sibling}I=Du(B,F.mode,Z),I.return=F,F=I}return S(F);case J:return _e=B._init,rt(F,I,_e(B._payload),Z)}if(er(B))return de(F,I,B,Z);if(ne(B))return me(F,I,B,Z);to(F,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,I!==null&&I.tag===6?(u(F,I.sibling),I=g(I,B),I.return=F,F=I):(u(F,I),I=Iu(B,F.mode,Z),I.return=F,F=I),S(F)):u(F,I)}return rt}var vi=rp(!0),ap=rp(!1),no=fs(null),so=null,wi=null,Hc=null;function Wc(){Hc=wi=so=null}function Vc(s){var r=no.current;Xe(no),s._currentValue=r}function Gc(s,r,u){for(;s!==null;){var f=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,f!==null&&(f.childLanes|=r)):f!==null&&(f.childLanes&r)!==r&&(f.childLanes|=r),s===u)break;s=s.return}}function bi(s,r){so=s,Hc=wi=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&r)!==0&&(Gt=!0),s.firstContext=null)}function dn(s){var r=s._currentValue;if(Hc!==s)if(s={context:s,memoizedValue:r,next:null},wi===null){if(so===null)throw Error(t(308));wi=s,so.dependencies={lanes:0,firstContext:s}}else wi=wi.next=s;return r}var Fs=null;function qc(s){Fs===null?Fs=[s]:Fs.push(s)}function op(s,r,u,f){var g=r.interleaved;return g===null?(u.next=u,qc(r)):(u.next=g.next,g.next=u),r.interleaved=u,Yn(s,f)}function Yn(s,r){s.lanes|=r;var u=s.alternate;for(u!==null&&(u.lanes|=r),u=s,s=s.return;s!==null;)s.childLanes|=r,u=s.alternate,u!==null&&(u.childLanes|=r),u=s,s=s.return;return u.tag===3?u.stateNode:null}var gs=!1;function Xc(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lp(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Qn(s,r){return{eventTime:s,lane:r,tag:0,payload:null,callback:null,next:null}}function ys(s,r,u){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(je&2)!==0){var g=f.pending;return g===null?r.next=r:(r.next=g.next,g.next=r),f.pending=r,Yn(s,u)}return g=f.interleaved,g===null?(r.next=r,qc(f)):(r.next=g.next,g.next=r),f.interleaved=r,Yn(s,u)}function io(s,r,u){if(r=r.updateQueue,r!==null&&(r=r.shared,(u&4194240)!==0)){var f=r.lanes;f&=s.pendingLanes,u|=f,r.lanes=u,lc(s,u)}}function cp(s,r){var u=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var g=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var S={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};v===null?g=v=S:v=v.next=S,u=u.next}while(u!==null);v===null?g=v=r:v=v.next=r}else g=v=r;u={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:f.shared,effects:f.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=r:s.next=r,u.lastBaseUpdate=r}function ro(s,r,u,f){var g=s.updateQueue;gs=!1;var v=g.firstBaseUpdate,S=g.lastBaseUpdate,T=g.shared.pending;if(T!==null){g.shared.pending=null;var M=T,z=M.next;M.next=null,S===null?v=z:S.next=z,S=M;var G=s.alternate;G!==null&&(G=G.updateQueue,T=G.lastBaseUpdate,T!==S&&(T===null?G.firstBaseUpdate=z:T.next=z,G.lastBaseUpdate=M))}if(v!==null){var Y=g.baseState;S=0,G=z=M=null,T=v;do{var W=T.lane,ae=T.eventTime;if((f&W)===W){G!==null&&(G=G.next={eventTime:ae,lane:0,tag:T.tag,payload:T.payload,callback:T.callback,next:null});e:{var de=s,me=T;switch(W=r,ae=u,me.tag){case 1:if(de=me.payload,typeof de=="function"){Y=de.call(ae,Y,W);break e}Y=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=me.payload,W=typeof de=="function"?de.call(ae,Y,W):de,W==null)break e;Y=se({},Y,W);break e;case 2:gs=!0}}T.callback!==null&&T.lane!==0&&(s.flags|=64,W=g.effects,W===null?g.effects=[T]:W.push(T))}else ae={eventTime:ae,lane:W,tag:T.tag,payload:T.payload,callback:T.callback,next:null},G===null?(z=G=ae,M=Y):G=G.next=ae,S|=W;if(T=T.next,T===null){if(T=g.shared.pending,T===null)break;W=T,T=W.next,W.next=null,g.lastBaseUpdate=W,g.shared.pending=null}}while(!0);if(G===null&&(M=Y),g.baseState=M,g.firstBaseUpdate=z,g.lastBaseUpdate=G,r=g.shared.interleaved,r!==null){g=r;do S|=g.lane,g=g.next;while(g!==r)}else v===null&&(g.shared.lanes=0);$s|=S,s.lanes=S,s.memoizedState=Y}}function up(s,r,u){if(s=r.effects,r.effects=null,s!==null)for(r=0;r<s.length;r++){var f=s[r],g=f.callback;if(g!==null){if(f.callback=null,f=u,typeof g!="function")throw Error(t(191,g));g.call(f)}}}var kr={},Ln=fs(kr),Er=fs(kr),Tr=fs(kr);function js(s){if(s===kr)throw Error(t(174));return s}function Kc(s,r){switch(Ve(Tr,r),Ve(Er,s),Ve(Ln,kr),s=r.nodeType,s){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Yl(null,"");break;default:s=s===8?r.parentNode:r,r=s.namespaceURI||null,s=s.tagName,r=Yl(r,s)}Xe(Ln),Ve(Ln,r)}function xi(){Xe(Ln),Xe(Er),Xe(Tr)}function hp(s){js(Tr.current);var r=js(Ln.current),u=Yl(r,s.type);r!==u&&(Ve(Er,s),Ve(Ln,u))}function Yc(s){Er.current===s&&(Xe(Ln),Xe(Er))}var Qe=fs(0);function ao(s){for(var r=s;r!==null;){if(r.tag===13){var u=r.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Qc=[];function Jc(){for(var s=0;s<Qc.length;s++)Qc[s]._workInProgressVersionPrimary=null;Qc.length=0}var oo=P.ReactCurrentDispatcher,Zc=P.ReactCurrentBatchConfig,Bs=0,Je=null,dt=null,yt=null,lo=!1,Pr=!1,Nr=0,eb=0;function Lt(){throw Error(t(321))}function eu(s,r){if(r===null)return!1;for(var u=0;u<r.length&&u<s.length;u++)if(!Sn(s[u],r[u]))return!1;return!0}function tu(s,r,u,f,g,v){if(Bs=v,Je=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,oo.current=s===null||s.memoizedState===null?ib:rb,s=u(f,g),Pr){v=0;do{if(Pr=!1,Nr=0,25<=v)throw Error(t(301));v+=1,yt=dt=null,r.updateQueue=null,oo.current=ab,s=u(f,g)}while(Pr)}if(oo.current=ho,r=dt!==null&&dt.next!==null,Bs=0,yt=dt=Je=null,lo=!1,r)throw Error(t(300));return s}function nu(){var s=Nr!==0;return Nr=0,s}function On(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?Je.memoizedState=yt=s:yt=yt.next=s,yt}function fn(){if(dt===null){var s=Je.alternate;s=s!==null?s.memoizedState:null}else s=dt.next;var r=yt===null?Je.memoizedState:yt.next;if(r!==null)yt=r,dt=s;else{if(s===null)throw Error(t(310));dt=s,s={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},yt===null?Je.memoizedState=yt=s:yt=yt.next=s}return yt}function Rr(s,r){return typeof r=="function"?r(s):r}function su(s){var r=fn(),u=r.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=dt,g=f.baseQueue,v=u.pending;if(v!==null){if(g!==null){var S=g.next;g.next=v.next,v.next=S}f.baseQueue=g=v,u.pending=null}if(g!==null){v=g.next,f=f.baseState;var T=S=null,M=null,z=v;do{var G=z.lane;if((Bs&G)===G)M!==null&&(M=M.next={lane:0,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null}),f=z.hasEagerState?z.eagerState:s(f,z.action);else{var Y={lane:G,action:z.action,hasEagerState:z.hasEagerState,eagerState:z.eagerState,next:null};M===null?(T=M=Y,S=f):M=M.next=Y,Je.lanes|=G,$s|=G}z=z.next}while(z!==null&&z!==v);M===null?S=f:M.next=T,Sn(f,r.memoizedState)||(Gt=!0),r.memoizedState=f,r.baseState=S,r.baseQueue=M,u.lastRenderedState=f}if(s=u.interleaved,s!==null){g=s;do v=g.lane,Je.lanes|=v,$s|=v,g=g.next;while(g!==s)}else g===null&&(u.lanes=0);return[r.memoizedState,u.dispatch]}function iu(s){var r=fn(),u=r.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=u.dispatch,g=u.pending,v=r.memoizedState;if(g!==null){u.pending=null;var S=g=g.next;do v=s(v,S.action),S=S.next;while(S!==g);Sn(v,r.memoizedState)||(Gt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),u.lastRenderedState=v}return[v,f]}function dp(){}function fp(s,r){var u=Je,f=fn(),g=r(),v=!Sn(f.memoizedState,g);if(v&&(f.memoizedState=g,Gt=!0),f=f.queue,ru(gp.bind(null,u,f,s),[s]),f.getSnapshot!==r||v||yt!==null&&yt.memoizedState.tag&1){if(u.flags|=2048,Mr(9,mp.bind(null,u,f,g,r),void 0,null),vt===null)throw Error(t(349));(Bs&30)!==0||pp(u,r,g)}return g}function pp(s,r,u){s.flags|=16384,s={getSnapshot:r,value:u},r=Je.updateQueue,r===null?(r={lastEffect:null,stores:null},Je.updateQueue=r,r.stores=[s]):(u=r.stores,u===null?r.stores=[s]:u.push(s))}function mp(s,r,u,f){r.value=u,r.getSnapshot=f,yp(r)&&vp(s)}function gp(s,r,u){return u(function(){yp(r)&&vp(s)})}function yp(s){var r=s.getSnapshot;s=s.value;try{var u=r();return!Sn(s,u)}catch{return!0}}function vp(s){var r=Yn(s,1);r!==null&&Pn(r,s,1,-1)}function wp(s){var r=On();return typeof s=="function"&&(s=s()),r.memoizedState=r.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rr,lastRenderedState:s},r.queue=s,s=s.dispatch=sb.bind(null,Je,s),[r.memoizedState,s]}function Mr(s,r,u,f){return s={tag:s,create:r,destroy:u,deps:f,next:null},r=Je.updateQueue,r===null?(r={lastEffect:null,stores:null},Je.updateQueue=r,r.lastEffect=s.next=s):(u=r.lastEffect,u===null?r.lastEffect=s.next=s:(f=u.next,u.next=s,s.next=f,r.lastEffect=s)),s}function bp(){return fn().memoizedState}function co(s,r,u,f){var g=On();Je.flags|=s,g.memoizedState=Mr(1|r,u,void 0,f===void 0?null:f)}function uo(s,r,u,f){var g=fn();f=f===void 0?null:f;var v=void 0;if(dt!==null){var S=dt.memoizedState;if(v=S.destroy,f!==null&&eu(f,S.deps)){g.memoizedState=Mr(r,u,v,f);return}}Je.flags|=s,g.memoizedState=Mr(1|r,u,v,f)}function xp(s,r){return co(8390656,8,s,r)}function ru(s,r){return uo(2048,8,s,r)}function _p(s,r){return uo(4,2,s,r)}function Ap(s,r){return uo(4,4,s,r)}function Sp(s,r){if(typeof r=="function")return s=s(),r(s),function(){r(null)};if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Cp(s,r,u){return u=u!=null?u.concat([s]):null,uo(4,4,Sp.bind(null,r,s),u)}function au(){}function kp(s,r){var u=fn();r=r===void 0?null:r;var f=u.memoizedState;return f!==null&&r!==null&&eu(r,f[1])?f[0]:(u.memoizedState=[s,r],s)}function Ep(s,r){var u=fn();r=r===void 0?null:r;var f=u.memoizedState;return f!==null&&r!==null&&eu(r,f[1])?f[0]:(s=s(),u.memoizedState=[s,r],s)}function Tp(s,r,u){return(Bs&21)===0?(s.baseState&&(s.baseState=!1,Gt=!0),s.memoizedState=u):(Sn(u,r)||(u=sf(),Je.lanes|=u,$s|=u,s.baseState=!0),r)}function tb(s,r){var u=Ue;Ue=u!==0&&4>u?u:4,s(!0);var f=Zc.transition;Zc.transition={};try{s(!1),r()}finally{Ue=u,Zc.transition=f}}function Pp(){return fn().memoizedState}function nb(s,r,u){var f=xs(s);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},Np(s))Rp(r,u);else if(u=op(s,r,u,f),u!==null){var g=Bt();Pn(u,s,f,g),Mp(u,r,f)}}function sb(s,r,u){var f=xs(s),g={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(Np(s))Rp(r,g);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var S=r.lastRenderedState,T=v(S,u);if(g.hasEagerState=!0,g.eagerState=T,Sn(T,S)){var M=r.interleaved;M===null?(g.next=g,qc(r)):(g.next=M.next,M.next=g),r.interleaved=g;return}}catch{}finally{}u=op(s,r,g,f),u!==null&&(g=Bt(),Pn(u,s,f,g),Mp(u,r,f))}}function Np(s){var r=s.alternate;return s===Je||r!==null&&r===Je}function Rp(s,r){Pr=lo=!0;var u=s.pending;u===null?r.next=r:(r.next=u.next,u.next=r),s.pending=r}function Mp(s,r,u){if((u&4194240)!==0){var f=r.lanes;f&=s.pendingLanes,u|=f,r.lanes=u,lc(s,u)}}var ho={readContext:dn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},ib={readContext:dn,useCallback:function(s,r){return On().memoizedState=[s,r===void 0?null:r],s},useContext:dn,useEffect:xp,useImperativeHandle:function(s,r,u){return u=u!=null?u.concat([s]):null,co(4194308,4,Sp.bind(null,r,s),u)},useLayoutEffect:function(s,r){return co(4194308,4,s,r)},useInsertionEffect:function(s,r){return co(4,2,s,r)},useMemo:function(s,r){var u=On();return r=r===void 0?null:r,s=s(),u.memoizedState=[s,r],s},useReducer:function(s,r,u){var f=On();return r=u!==void 0?u(r):r,f.memoizedState=f.baseState=r,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:r},f.queue=s,s=s.dispatch=nb.bind(null,Je,s),[f.memoizedState,s]},useRef:function(s){var r=On();return s={current:s},r.memoizedState=s},useState:wp,useDebugValue:au,useDeferredValue:function(s){return On().memoizedState=s},useTransition:function(){var s=wp(!1),r=s[0];return s=tb.bind(null,s[1]),On().memoizedState=s,[r,s]},useMutableSource:function(){},useSyncExternalStore:function(s,r,u){var f=Je,g=On();if(Ke){if(u===void 0)throw Error(t(407));u=u()}else{if(u=r(),vt===null)throw Error(t(349));(Bs&30)!==0||pp(f,r,u)}g.memoizedState=u;var v={value:u,getSnapshot:r};return g.queue=v,xp(gp.bind(null,f,v,s),[s]),f.flags|=2048,Mr(9,mp.bind(null,f,v,u,r),void 0,null),u},useId:function(){var s=On(),r=vt.identifierPrefix;if(Ke){var u=Kn,f=Xn;u=(f&~(1<<32-An(f)-1)).toString(32)+u,r=":"+r+"R"+u,u=Nr++,0<u&&(r+="H"+u.toString(32)),r+=":"}else u=eb++,r=":"+r+"r"+u.toString(32)+":";return s.memoizedState=r},unstable_isNewReconciler:!1},rb={readContext:dn,useCallback:kp,useContext:dn,useEffect:ru,useImperativeHandle:Cp,useInsertionEffect:_p,useLayoutEffect:Ap,useMemo:Ep,useReducer:su,useRef:bp,useState:function(){return su(Rr)},useDebugValue:au,useDeferredValue:function(s){var r=fn();return Tp(r,dt.memoizedState,s)},useTransition:function(){var s=su(Rr)[0],r=fn().memoizedState;return[s,r]},useMutableSource:dp,useSyncExternalStore:fp,useId:Pp,unstable_isNewReconciler:!1},ab={readContext:dn,useCallback:kp,useContext:dn,useEffect:ru,useImperativeHandle:Cp,useInsertionEffect:_p,useLayoutEffect:Ap,useMemo:Ep,useReducer:iu,useRef:bp,useState:function(){return iu(Rr)},useDebugValue:au,useDeferredValue:function(s){var r=fn();return dt===null?r.memoizedState=s:Tp(r,dt.memoizedState,s)},useTransition:function(){var s=iu(Rr)[0],r=fn().memoizedState;return[s,r]},useMutableSource:dp,useSyncExternalStore:fp,useId:Pp,unstable_isNewReconciler:!1};function kn(s,r){if(s&&s.defaultProps){r=se({},r),s=s.defaultProps;for(var u in s)r[u]===void 0&&(r[u]=s[u]);return r}return r}function ou(s,r,u,f){r=s.memoizedState,u=u(f,r),u=u==null?r:se({},r,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var fo={isMounted:function(s){return(s=s._reactInternals)?Ms(s)===s:!1},enqueueSetState:function(s,r,u){s=s._reactInternals;var f=Bt(),g=xs(s),v=Qn(f,g);v.payload=r,u!=null&&(v.callback=u),r=ys(s,v,g),r!==null&&(Pn(r,s,g,f),io(r,s,g))},enqueueReplaceState:function(s,r,u){s=s._reactInternals;var f=Bt(),g=xs(s),v=Qn(f,g);v.tag=1,v.payload=r,u!=null&&(v.callback=u),r=ys(s,v,g),r!==null&&(Pn(r,s,g,f),io(r,s,g))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var u=Bt(),f=xs(s),g=Qn(u,f);g.tag=2,r!=null&&(g.callback=r),r=ys(s,g,f),r!==null&&(Pn(r,s,f,u),io(r,s,f))}};function Ip(s,r,u,f,g,v,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,v,S):r.prototype&&r.prototype.isPureReactComponent?!vr(u,f)||!vr(g,v):!0}function Dp(s,r,u){var f=!1,g=ps,v=r.contextType;return typeof v=="object"&&v!==null?v=dn(v):(g=Vt(r)?Ds:Dt.current,f=r.contextTypes,v=(f=f!=null)?pi(s,g):ps),r=new r(u,v),s.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=fo,s.stateNode=r,r._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=g,s.__reactInternalMemoizedMaskedChildContext=v),r}function Lp(s,r,u,f){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(u,f),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(u,f),r.state!==s&&fo.enqueueReplaceState(r,r.state,null)}function lu(s,r,u,f){var g=s.stateNode;g.props=u,g.state=s.memoizedState,g.refs={},Xc(s);var v=r.contextType;typeof v=="object"&&v!==null?g.context=dn(v):(v=Vt(r)?Ds:Dt.current,g.context=pi(s,v)),g.state=s.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(ou(s,r,v,u),g.state=s.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(r=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),r!==g.state&&fo.enqueueReplaceState(g,g.state,null),ro(s,u,g,f),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308)}function _i(s,r){try{var u="",f=r;do u+=ke(f),f=f.return;while(f);var g=u}catch(v){g=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:r,stack:g,digest:null}}function cu(s,r,u){return{value:s,source:null,stack:u??null,digest:r??null}}function uu(s,r){try{console.error(r.value)}catch(u){setTimeout(function(){throw u})}}var ob=typeof WeakMap=="function"?WeakMap:Map;function Op(s,r,u){u=Qn(-1,u),u.tag=3,u.payload={element:null};var f=r.value;return u.callback=function(){bo||(bo=!0,Cu=f),uu(s,r)},u}function Fp(s,r,u){u=Qn(-1,u),u.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var g=r.value;u.payload=function(){return f(g)},u.callback=function(){uu(s,r)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(u.callback=function(){uu(s,r),typeof f!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})}),u}function jp(s,r,u){var f=s.pingCache;if(f===null){f=s.pingCache=new ob;var g=new Set;f.set(r,g)}else g=f.get(r),g===void 0&&(g=new Set,f.set(r,g));g.has(u)||(g.add(u),s=xb.bind(null,s,r,u),r.then(s,s))}function Bp(s){do{var r;if((r=s.tag===13)&&(r=s.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return s;s=s.return}while(s!==null);return null}function $p(s,r,u,f,g){return(s.mode&1)===0?(s===r?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(r=Qn(-1,1),r.tag=2,ys(u,r,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=g,s)}var lb=P.ReactCurrentOwner,Gt=!1;function jt(s,r,u,f){r.child=s===null?ap(r,null,u,f):vi(r,s.child,u,f)}function zp(s,r,u,f,g){u=u.render;var v=r.ref;return bi(r,g),f=tu(s,r,u,f,v,g),u=nu(),s!==null&&!Gt?(r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~g,Jn(s,r,g)):(Ke&&u&&jc(r),r.flags|=1,jt(s,r,f,g),r.child)}function Up(s,r,u,f,g){if(s===null){var v=u.type;return typeof v=="function"&&!Mu(v)&&v.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(r.tag=15,r.type=v,Hp(s,r,v,f,g)):(s=ko(u.type,null,f,r,r.mode,g),s.ref=r.ref,s.return=r,r.child=s)}if(v=s.child,(s.lanes&g)===0){var S=v.memoizedProps;if(u=u.compare,u=u!==null?u:vr,u(S,f)&&s.ref===r.ref)return Jn(s,r,g)}return r.flags|=1,s=As(v,f),s.ref=r.ref,s.return=r,r.child=s}function Hp(s,r,u,f,g){if(s!==null){var v=s.memoizedProps;if(vr(v,f)&&s.ref===r.ref)if(Gt=!1,r.pendingProps=f=v,(s.lanes&g)!==0)(s.flags&131072)!==0&&(Gt=!0);else return r.lanes=s.lanes,Jn(s,r,g)}return hu(s,r,u,f,g)}function Wp(s,r,u){var f=r.pendingProps,g=f.children,v=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Si,nn),nn|=u;else{if((u&1073741824)===0)return s=v!==null?v.baseLanes|u:u,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:s,cachePool:null,transitions:null},r.updateQueue=null,Ve(Si,nn),nn|=s,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:u,Ve(Si,nn),nn|=f}else v!==null?(f=v.baseLanes|u,r.memoizedState=null):f=u,Ve(Si,nn),nn|=f;return jt(s,r,g,u),r.child}function Vp(s,r){var u=r.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(r.flags|=512,r.flags|=2097152)}function hu(s,r,u,f,g){var v=Vt(u)?Ds:Dt.current;return v=pi(r,v),bi(r,g),u=tu(s,r,u,f,v,g),f=nu(),s!==null&&!Gt?(r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~g,Jn(s,r,g)):(Ke&&f&&jc(r),r.flags|=1,jt(s,r,u,g),r.child)}function Gp(s,r,u,f,g){if(Vt(u)){var v=!0;Ya(r)}else v=!1;if(bi(r,g),r.stateNode===null)mo(s,r),Dp(r,u,f),lu(r,u,f,g),f=!0;else if(s===null){var S=r.stateNode,T=r.memoizedProps;S.props=T;var M=S.context,z=u.contextType;typeof z=="object"&&z!==null?z=dn(z):(z=Vt(u)?Ds:Dt.current,z=pi(r,z));var G=u.getDerivedStateFromProps,Y=typeof G=="function"||typeof S.getSnapshotBeforeUpdate=="function";Y||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(T!==f||M!==z)&&Lp(r,S,f,z),gs=!1;var W=r.memoizedState;S.state=W,ro(r,f,S,g),M=r.memoizedState,T!==f||W!==M||Wt.current||gs?(typeof G=="function"&&(ou(r,u,G,f),M=r.memoizedState),(T=gs||Ip(r,u,T,f,W,M,z))?(Y||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=f,r.memoizedState=M),S.props=f,S.state=M,S.context=z,f=T):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),f=!1)}else{S=r.stateNode,lp(s,r),T=r.memoizedProps,z=r.type===r.elementType?T:kn(r.type,T),S.props=z,Y=r.pendingProps,W=S.context,M=u.contextType,typeof M=="object"&&M!==null?M=dn(M):(M=Vt(u)?Ds:Dt.current,M=pi(r,M));var ae=u.getDerivedStateFromProps;(G=typeof ae=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(T!==Y||W!==M)&&Lp(r,S,f,M),gs=!1,W=r.memoizedState,S.state=W,ro(r,f,S,g);var de=r.memoizedState;T!==Y||W!==de||Wt.current||gs?(typeof ae=="function"&&(ou(r,u,ae,f),de=r.memoizedState),(z=gs||Ip(r,u,z,f,W,de,M)||!1)?(G||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(f,de,M),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(f,de,M)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||T===s.memoizedProps&&W===s.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&W===s.memoizedState||(r.flags|=1024),r.memoizedProps=f,r.memoizedState=de),S.props=f,S.state=de,S.context=M,f=z):(typeof S.componentDidUpdate!="function"||T===s.memoizedProps&&W===s.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||T===s.memoizedProps&&W===s.memoizedState||(r.flags|=1024),f=!1)}return du(s,r,u,f,v,g)}function du(s,r,u,f,g,v){Vp(s,r);var S=(r.flags&128)!==0;if(!f&&!S)return g&&Qf(r,u,!1),Jn(s,r,v);f=r.stateNode,lb.current=r;var T=S&&typeof u.getDerivedStateFromError!="function"?null:f.render();return r.flags|=1,s!==null&&S?(r.child=vi(r,s.child,null,v),r.child=vi(r,null,T,v)):jt(s,r,T,v),r.memoizedState=f.state,g&&Qf(r,u,!0),r.child}function qp(s){var r=s.stateNode;r.pendingContext?Kf(s,r.pendingContext,r.pendingContext!==r.context):r.context&&Kf(s,r.context,!1),Kc(s,r.containerInfo)}function Xp(s,r,u,f,g){return yi(),Uc(g),r.flags|=256,jt(s,r,u,f),r.child}var fu={dehydrated:null,treeContext:null,retryLane:0};function pu(s){return{baseLanes:s,cachePool:null,transitions:null}}function Kp(s,r,u){var f=r.pendingProps,g=Qe.current,v=!1,S=(r.flags&128)!==0,T;if((T=S)||(T=s!==null&&s.memoizedState===null?!1:(g&2)!==0),T?(v=!0,r.flags&=-129):(s===null||s.memoizedState!==null)&&(g|=1),Ve(Qe,g&1),s===null)return zc(r),s=r.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((r.mode&1)===0?r.lanes=1:s.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(S=f.children,s=f.fallback,v?(f=r.mode,v=r.child,S={mode:"hidden",children:S},(f&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=Eo(S,f,0,null),s=Ws(s,f,u,null),v.return=r,s.return=r,v.sibling=s,r.child=v,r.child.memoizedState=pu(u),r.memoizedState=fu,s):mu(r,S));if(g=s.memoizedState,g!==null&&(T=g.dehydrated,T!==null))return cb(s,r,S,f,T,g,u);if(v){v=f.fallback,S=r.mode,g=s.child,T=g.sibling;var M={mode:"hidden",children:f.children};return(S&1)===0&&r.child!==g?(f=r.child,f.childLanes=0,f.pendingProps=M,r.deletions=null):(f=As(g,M),f.subtreeFlags=g.subtreeFlags&14680064),T!==null?v=As(T,v):(v=Ws(v,S,u,null),v.flags|=2),v.return=r,f.return=r,f.sibling=v,r.child=f,f=v,v=r.child,S=s.child.memoizedState,S=S===null?pu(u):{baseLanes:S.baseLanes|u,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=s.childLanes&~u,r.memoizedState=fu,f}return v=s.child,s=v.sibling,f=As(v,{mode:"visible",children:f.children}),(r.mode&1)===0&&(f.lanes=u),f.return=r,f.sibling=null,s!==null&&(u=r.deletions,u===null?(r.deletions=[s],r.flags|=16):u.push(s)),r.child=f,r.memoizedState=null,f}function mu(s,r){return r=Eo({mode:"visible",children:r},s.mode,0,null),r.return=s,s.child=r}function po(s,r,u,f){return f!==null&&Uc(f),vi(r,s.child,null,u),s=mu(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function cb(s,r,u,f,g,v,S){if(u)return r.flags&256?(r.flags&=-257,f=cu(Error(t(422))),po(s,r,S,f)):r.memoizedState!==null?(r.child=s.child,r.flags|=128,null):(v=f.fallback,g=r.mode,f=Eo({mode:"visible",children:f.children},g,0,null),v=Ws(v,g,S,null),v.flags|=2,f.return=r,v.return=r,f.sibling=v,r.child=f,(r.mode&1)!==0&&vi(r,s.child,null,S),r.child.memoizedState=pu(S),r.memoizedState=fu,v);if((r.mode&1)===0)return po(s,r,S,null);if(g.data==="$!"){if(f=g.nextSibling&&g.nextSibling.dataset,f)var T=f.dgst;return f=T,v=Error(t(419)),f=cu(v,f,void 0),po(s,r,S,f)}if(T=(S&s.childLanes)!==0,Gt||T){if(f=vt,f!==null){switch(S&-S){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=(g&(f.suspendedLanes|S))!==0?0:g,g!==0&&g!==v.retryLane&&(v.retryLane=g,Yn(s,g),Pn(f,s,g,-1))}return Ru(),f=cu(Error(t(421))),po(s,r,S,f)}return g.data==="$?"?(r.flags|=128,r.child=s.child,r=_b.bind(null,s),g._reactRetry=r,null):(s=v.treeContext,tn=ds(g.nextSibling),en=r,Ke=!0,Cn=null,s!==null&&(un[hn++]=Xn,un[hn++]=Kn,un[hn++]=Ls,Xn=s.id,Kn=s.overflow,Ls=r),r=mu(r,f.children),r.flags|=4096,r)}function Yp(s,r,u){s.lanes|=r;var f=s.alternate;f!==null&&(f.lanes|=r),Gc(s.return,r,u)}function gu(s,r,u,f,g){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:g}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=u,v.tailMode=g)}function Qp(s,r,u){var f=r.pendingProps,g=f.revealOrder,v=f.tail;if(jt(s,r,f.children,u),f=Qe.current,(f&2)!==0)f=f&1|2,r.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Yp(s,u,r);else if(s.tag===19)Yp(s,u,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(Ve(Qe,f),(r.mode&1)===0)r.memoizedState=null;else switch(g){case"forwards":for(u=r.child,g=null;u!==null;)s=u.alternate,s!==null&&ao(s)===null&&(g=u),u=u.sibling;u=g,u===null?(g=r.child,r.child=null):(g=u.sibling,u.sibling=null),gu(r,!1,g,u,v);break;case"backwards":for(u=null,g=r.child,r.child=null;g!==null;){if(s=g.alternate,s!==null&&ao(s)===null){r.child=g;break}s=g.sibling,g.sibling=u,u=g,g=s}gu(r,!0,u,null,v);break;case"together":gu(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function mo(s,r){(r.mode&1)===0&&s!==null&&(s.alternate=null,r.alternate=null,r.flags|=2)}function Jn(s,r,u){if(s!==null&&(r.dependencies=s.dependencies),$s|=r.lanes,(u&r.childLanes)===0)return null;if(s!==null&&r.child!==s.child)throw Error(t(153));if(r.child!==null){for(s=r.child,u=As(s,s.pendingProps),r.child=u,u.return=r;s.sibling!==null;)s=s.sibling,u=u.sibling=As(s,s.pendingProps),u.return=r;u.sibling=null}return r.child}function ub(s,r,u){switch(r.tag){case 3:qp(r),yi();break;case 5:hp(r);break;case 1:Vt(r.type)&&Ya(r);break;case 4:Kc(r,r.stateNode.containerInfo);break;case 10:var f=r.type._context,g=r.memoizedProps.value;Ve(no,f._currentValue),f._currentValue=g;break;case 13:if(f=r.memoizedState,f!==null)return f.dehydrated!==null?(Ve(Qe,Qe.current&1),r.flags|=128,null):(u&r.child.childLanes)!==0?Kp(s,r,u):(Ve(Qe,Qe.current&1),s=Jn(s,r,u),s!==null?s.sibling:null);Ve(Qe,Qe.current&1);break;case 19:if(f=(u&r.childLanes)!==0,(s.flags&128)!==0){if(f)return Qp(s,r,u);r.flags|=128}if(g=r.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Ve(Qe,Qe.current),f)break;return null;case 22:case 23:return r.lanes=0,Wp(s,r,u)}return Jn(s,r,u)}var Jp,yu,Zp,em;Jp=function(s,r){for(var u=r.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},yu=function(){},Zp=function(s,r,u,f){var g=s.memoizedProps;if(g!==f){s=r.stateNode,js(Ln.current);var v=null;switch(u){case"input":g=Zi(s,g),f=Zi(s,f),v=[];break;case"select":g=se({},g,{value:void 0}),f=se({},f,{value:void 0}),v=[];break;case"textarea":g=Kl(s,g),f=Kl(s,f),v=[];break;default:typeof g.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=qa)}Ql(u,f);var S;u=null;for(z in g)if(!f.hasOwnProperty(z)&&g.hasOwnProperty(z)&&g[z]!=null)if(z==="style"){var T=g[z];for(S in T)T.hasOwnProperty(S)&&(u||(u={}),u[S]="")}else z!=="dangerouslySetInnerHTML"&&z!=="children"&&z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(i.hasOwnProperty(z)?v||(v=[]):(v=v||[]).push(z,null));for(z in f){var M=f[z];if(T=g?.[z],f.hasOwnProperty(z)&&M!==T&&(M!=null||T!=null))if(z==="style")if(T){for(S in T)!T.hasOwnProperty(S)||M&&M.hasOwnProperty(S)||(u||(u={}),u[S]="");for(S in M)M.hasOwnProperty(S)&&T[S]!==M[S]&&(u||(u={}),u[S]=M[S])}else u||(v||(v=[]),v.push(z,u)),u=M;else z==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,T=T?T.__html:void 0,M!=null&&T!==M&&(v=v||[]).push(z,M)):z==="children"?typeof M!="string"&&typeof M!="number"||(v=v||[]).push(z,""+M):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&(i.hasOwnProperty(z)?(M!=null&&z==="onScroll"&&qe("scroll",s),v||T===M||(v=[])):(v=v||[]).push(z,M))}u&&(v=v||[]).push("style",u);var z=v;(r.updateQueue=z)&&(r.flags|=4)}},em=function(s,r,u,f){u!==f&&(r.flags|=4)};function Ir(s,r){if(!Ke)switch(s.tailMode){case"hidden":r=s.tail;for(var u=null;r!==null;)r.alternate!==null&&(u=r),r=r.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Ot(s){var r=s.alternate!==null&&s.alternate.child===s.child,u=0,f=0;if(r)for(var g=s.child;g!==null;)u|=g.lanes|g.childLanes,f|=g.subtreeFlags&14680064,f|=g.flags&14680064,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)u|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=f,s.childLanes=u,r}function hb(s,r,u){var f=r.pendingProps;switch(Bc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(r),null;case 1:return Vt(r.type)&&Ka(),Ot(r),null;case 3:return f=r.stateNode,xi(),Xe(Wt),Xe(Dt),Jc(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(eo(r)?r.flags|=4:s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Cn!==null&&(Tu(Cn),Cn=null))),yu(s,r),Ot(r),null;case 5:Yc(r);var g=js(Tr.current);if(u=r.type,s!==null&&r.stateNode!=null)Zp(s,r,u,f,g),s.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!f){if(r.stateNode===null)throw Error(t(166));return Ot(r),null}if(s=js(Ln.current),eo(r)){f=r.stateNode,u=r.type;var v=r.memoizedProps;switch(f[Dn]=r,f[Ar]=v,s=(r.mode&1)!==0,u){case"dialog":qe("cancel",f),qe("close",f);break;case"iframe":case"object":case"embed":qe("load",f);break;case"video":case"audio":for(g=0;g<br.length;g++)qe(br[g],f);break;case"source":qe("error",f);break;case"img":case"image":case"link":qe("error",f),qe("load",f);break;case"details":qe("toggle",f);break;case"input":Id(f,v),qe("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},qe("invalid",f);break;case"textarea":Od(f,v),qe("invalid",f)}Ql(u,v),g=null;for(var S in v)if(v.hasOwnProperty(S)){var T=v[S];S==="children"?typeof T=="string"?f.textContent!==T&&(v.suppressHydrationWarning!==!0&&Ga(f.textContent,T,s),g=["children",T]):typeof T=="number"&&f.textContent!==""+T&&(v.suppressHydrationWarning!==!0&&Ga(f.textContent,T,s),g=["children",""+T]):i.hasOwnProperty(S)&&T!=null&&S==="onScroll"&&qe("scroll",f)}switch(u){case"input":cn(f),Ld(f,v,!0);break;case"textarea":cn(f),jd(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=qa)}f=g,r.updateQueue=f,f!==null&&(r.flags|=4)}else{S=g.nodeType===9?g:g.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Bd(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=S.createElement(u,{is:f.is}):(s=S.createElement(u),u==="select"&&(S=s,f.multiple?S.multiple=!0:f.size&&(S.size=f.size))):s=S.createElementNS(s,u),s[Dn]=r,s[Ar]=f,Jp(s,r,!1,!1),r.stateNode=s;e:{switch(S=Jl(u,f),u){case"dialog":qe("cancel",s),qe("close",s),g=f;break;case"iframe":case"object":case"embed":qe("load",s),g=f;break;case"video":case"audio":for(g=0;g<br.length;g++)qe(br[g],s);g=f;break;case"source":qe("error",s),g=f;break;case"img":case"image":case"link":qe("error",s),qe("load",s),g=f;break;case"details":qe("toggle",s),g=f;break;case"input":Id(s,f),g=Zi(s,f),qe("invalid",s);break;case"option":g=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},g=se({},f,{value:void 0}),qe("invalid",s);break;case"textarea":Od(s,f),g=Kl(s,f),qe("invalid",s);break;default:g=f}Ql(u,g),T=g;for(v in T)if(T.hasOwnProperty(v)){var M=T[v];v==="style"?Ud(s,M):v==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,M!=null&&$d(s,M)):v==="children"?typeof M=="string"?(u!=="textarea"||M!=="")&&tr(s,M):typeof M=="number"&&tr(s,""+M):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(i.hasOwnProperty(v)?M!=null&&v==="onScroll"&&qe("scroll",s):M!=null&&E(s,v,M,S))}switch(u){case"input":cn(s),Ld(s,f,!1);break;case"textarea":cn(s),jd(s);break;case"option":f.value!=null&&s.setAttribute("value",""+Ie(f.value));break;case"select":s.multiple=!!f.multiple,v=f.value,v!=null?ni(s,!!f.multiple,v,!1):f.defaultValue!=null&&ni(s,!!f.multiple,f.defaultValue,!0);break;default:typeof g.onClick=="function"&&(s.onclick=qa)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ot(r),null;case 6:if(s&&r.stateNode!=null)em(s,r,s.memoizedProps,f);else{if(typeof f!="string"&&r.stateNode===null)throw Error(t(166));if(u=js(Tr.current),js(Ln.current),eo(r)){if(f=r.stateNode,u=r.memoizedProps,f[Dn]=r,(v=f.nodeValue!==u)&&(s=en,s!==null))switch(s.tag){case 3:Ga(f.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Ga(f.nodeValue,u,(s.mode&1)!==0)}v&&(r.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[Dn]=r,r.stateNode=f}return Ot(r),null;case 13:if(Xe(Qe),f=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Ke&&tn!==null&&(r.mode&1)!==0&&(r.flags&128)===0)sp(),yi(),r.flags|=98560,v=!1;else if(v=eo(r),f!==null&&f.dehydrated!==null){if(s===null){if(!v)throw Error(t(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Dn]=r}else yi(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ot(r),v=!1}else Cn!==null&&(Tu(Cn),Cn=null),v=!0;if(!v)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=u,r):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(r.child.flags|=8192,(r.mode&1)!==0&&(s===null||(Qe.current&1)!==0?ft===0&&(ft=3):Ru())),r.updateQueue!==null&&(r.flags|=4),Ot(r),null);case 4:return xi(),yu(s,r),s===null&&xr(r.stateNode.containerInfo),Ot(r),null;case 10:return Vc(r.type._context),Ot(r),null;case 17:return Vt(r.type)&&Ka(),Ot(r),null;case 19:if(Xe(Qe),v=r.memoizedState,v===null)return Ot(r),null;if(f=(r.flags&128)!==0,S=v.rendering,S===null)if(f)Ir(v,!1);else{if(ft!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(S=ao(s),S!==null){for(r.flags|=128,Ir(v,!1),f=S.updateQueue,f!==null&&(r.updateQueue=f,r.flags|=4),r.subtreeFlags=0,f=u,u=r.child;u!==null;)v=u,s=f,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,s=S.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Ve(Qe,Qe.current&1|2),r.child}s=s.sibling}v.tail!==null&&it()>Ci&&(r.flags|=128,f=!0,Ir(v,!1),r.lanes=4194304)}else{if(!f)if(s=ao(S),s!==null){if(r.flags|=128,f=!0,u=s.updateQueue,u!==null&&(r.updateQueue=u,r.flags|=4),Ir(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Ke)return Ot(r),null}else 2*it()-v.renderingStartTime>Ci&&u!==1073741824&&(r.flags|=128,f=!0,Ir(v,!1),r.lanes=4194304);v.isBackwards?(S.sibling=r.child,r.child=S):(u=v.last,u!==null?u.sibling=S:r.child=S,v.last=S)}return v.tail!==null?(r=v.tail,v.rendering=r,v.tail=r.sibling,v.renderingStartTime=it(),r.sibling=null,u=Qe.current,Ve(Qe,f?u&1|2:u&1),r):(Ot(r),null);case 22:case 23:return Nu(),f=r.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(r.flags|=8192),f&&(r.mode&1)!==0?(nn&1073741824)!==0&&(Ot(r),r.subtreeFlags&6&&(r.flags|=8192)):Ot(r),null;case 24:return null;case 25:return null}throw Error(t(156,r.tag))}function db(s,r){switch(Bc(r),r.tag){case 1:return Vt(r.type)&&Ka(),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return xi(),Xe(Wt),Xe(Dt),Jc(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 5:return Yc(r),null;case 13:if(Xe(Qe),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(t(340));yi()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return Xe(Qe),null;case 4:return xi(),null;case 10:return Vc(r.type._context),null;case 22:case 23:return Nu(),null;case 24:return null;default:return null}}var go=!1,Ft=!1,fb=typeof WeakSet=="function"?WeakSet:Set,le=null;function Ai(s,r){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){tt(s,r,f)}else u.current=null}function vu(s,r,u){try{u()}catch(f){tt(s,r,f)}}var tm=!1;function pb(s,r){if(Nc=La,s=If(),_c(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var g=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var S=0,T=-1,M=-1,z=0,G=0,Y=s,W=null;t:for(;;){for(var ae;Y!==u||g!==0&&Y.nodeType!==3||(T=S+g),Y!==v||f!==0&&Y.nodeType!==3||(M=S+f),Y.nodeType===3&&(S+=Y.nodeValue.length),(ae=Y.firstChild)!==null;)W=Y,Y=ae;for(;;){if(Y===s)break t;if(W===u&&++z===g&&(T=S),W===v&&++G===f&&(M=S),(ae=Y.nextSibling)!==null)break;Y=W,W=Y.parentNode}Y=ae}u=T===-1||M===-1?null:{start:T,end:M}}else u=null}u=u||{start:0,end:0}}else u=null;for(Rc={focusedElem:s,selectionRange:u},La=!1,le=r;le!==null;)if(r=le,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,le=s;else for(;le!==null;){r=le;try{var de=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var me=de.memoizedProps,rt=de.memoizedState,F=r.stateNode,I=F.getSnapshotBeforeUpdate(r.elementType===r.type?me:kn(r.type,me),rt);F.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var B=r.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Z){tt(r,r.return,Z)}if(s=r.sibling,s!==null){s.return=r.return,le=s;break}le=r.return}return de=tm,tm=!1,de}function Dr(s,r,u){var f=r.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var g=f=f.next;do{if((g.tag&s)===s){var v=g.destroy;g.destroy=void 0,v!==void 0&&vu(r,u,v)}g=g.next}while(g!==f)}}function yo(s,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var u=r=r.next;do{if((u.tag&s)===s){var f=u.create;u.destroy=f()}u=u.next}while(u!==r)}}function wu(s){var r=s.ref;if(r!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof r=="function"?r(s):r.current=s}}function nm(s){var r=s.alternate;r!==null&&(s.alternate=null,nm(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&(delete r[Dn],delete r[Ar],delete r[Lc],delete r[Yw],delete r[Qw])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function sm(s){return s.tag===5||s.tag===3||s.tag===4}function im(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||sm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function bu(s,r,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,r?u.nodeType===8?u.parentNode.insertBefore(s,r):u.insertBefore(s,r):(u.nodeType===8?(r=u.parentNode,r.insertBefore(s,u)):(r=u,r.appendChild(s)),u=u._reactRootContainer,u!=null||r.onclick!==null||(r.onclick=qa));else if(f!==4&&(s=s.child,s!==null))for(bu(s,r,u),s=s.sibling;s!==null;)bu(s,r,u),s=s.sibling}function xu(s,r,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,r?u.insertBefore(s,r):u.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(xu(s,r,u),s=s.sibling;s!==null;)xu(s,r,u),s=s.sibling}var St=null,En=!1;function vs(s,r,u){for(u=u.child;u!==null;)rm(s,r,u),u=u.sibling}function rm(s,r,u){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Pa,u)}catch{}switch(u.tag){case 5:Ft||Ai(u,r);case 6:var f=St,g=En;St=null,vs(s,r,u),St=f,En=g,St!==null&&(En?(s=St,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):St.removeChild(u.stateNode));break;case 18:St!==null&&(En?(s=St,u=u.stateNode,s.nodeType===8?Dc(s.parentNode,u):s.nodeType===1&&Dc(s,u),dr(s)):Dc(St,u.stateNode));break;case 4:f=St,g=En,St=u.stateNode.containerInfo,En=!0,vs(s,r,u),St=f,En=g;break;case 0:case 11:case 14:case 15:if(!Ft&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){g=f=f.next;do{var v=g,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&vu(u,r,S),g=g.next}while(g!==f)}vs(s,r,u);break;case 1:if(!Ft&&(Ai(u,r),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(T){tt(u,r,T)}vs(s,r,u);break;case 21:vs(s,r,u);break;case 22:u.mode&1?(Ft=(f=Ft)||u.memoizedState!==null,vs(s,r,u),Ft=f):vs(s,r,u);break;default:vs(s,r,u)}}function am(s){var r=s.updateQueue;if(r!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new fb),r.forEach(function(f){var g=Ab.bind(null,s,f);u.has(f)||(u.add(f),f.then(g,g))})}}function Tn(s,r){var u=r.deletions;if(u!==null)for(var f=0;f<u.length;f++){var g=u[f];try{var v=s,S=r,T=S;e:for(;T!==null;){switch(T.tag){case 5:St=T.stateNode,En=!1;break e;case 3:St=T.stateNode.containerInfo,En=!0;break e;case 4:St=T.stateNode.containerInfo,En=!0;break e}T=T.return}if(St===null)throw Error(t(160));rm(v,S,g),St=null,En=!1;var M=g.alternate;M!==null&&(M.return=null),g.return=null}catch(z){tt(g,r,z)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)om(r,s),r=r.sibling}function om(s,r){var u=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Tn(r,s),Fn(s),f&4){try{Dr(3,s,s.return),yo(3,s)}catch(me){tt(s,s.return,me)}try{Dr(5,s,s.return)}catch(me){tt(s,s.return,me)}}break;case 1:Tn(r,s),Fn(s),f&512&&u!==null&&Ai(u,u.return);break;case 5:if(Tn(r,s),Fn(s),f&512&&u!==null&&Ai(u,u.return),s.flags&32){var g=s.stateNode;try{tr(g,"")}catch(me){tt(s,s.return,me)}}if(f&4&&(g=s.stateNode,g!=null)){var v=s.memoizedProps,S=u!==null?u.memoizedProps:v,T=s.type,M=s.updateQueue;if(s.updateQueue=null,M!==null)try{T==="input"&&v.type==="radio"&&v.name!=null&&Dd(g,v),Jl(T,S);var z=Jl(T,v);for(S=0;S<M.length;S+=2){var G=M[S],Y=M[S+1];G==="style"?Ud(g,Y):G==="dangerouslySetInnerHTML"?$d(g,Y):G==="children"?tr(g,Y):E(g,G,Y,z)}switch(T){case"input":ql(g,v);break;case"textarea":Fd(g,v);break;case"select":var W=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!v.multiple;var ae=v.value;ae!=null?ni(g,!!v.multiple,ae,!1):W!==!!v.multiple&&(v.defaultValue!=null?ni(g,!!v.multiple,v.defaultValue,!0):ni(g,!!v.multiple,v.multiple?[]:"",!1))}g[Ar]=v}catch(me){tt(s,s.return,me)}}break;case 6:if(Tn(r,s),Fn(s),f&4){if(s.stateNode===null)throw Error(t(162));g=s.stateNode,v=s.memoizedProps;try{g.nodeValue=v}catch(me){tt(s,s.return,me)}}break;case 3:if(Tn(r,s),Fn(s),f&4&&u!==null&&u.memoizedState.isDehydrated)try{dr(r.containerInfo)}catch(me){tt(s,s.return,me)}break;case 4:Tn(r,s),Fn(s);break;case 13:Tn(r,s),Fn(s),g=s.child,g.flags&8192&&(v=g.memoizedState!==null,g.stateNode.isHidden=v,!v||g.alternate!==null&&g.alternate.memoizedState!==null||(Su=it())),f&4&&am(s);break;case 22:if(G=u!==null&&u.memoizedState!==null,s.mode&1?(Ft=(z=Ft)||G,Tn(r,s),Ft=z):Tn(r,s),Fn(s),f&8192){if(z=s.memoizedState!==null,(s.stateNode.isHidden=z)&&!G&&(s.mode&1)!==0)for(le=s,G=s.child;G!==null;){for(Y=le=G;le!==null;){switch(W=le,ae=W.child,W.tag){case 0:case 11:case 14:case 15:Dr(4,W,W.return);break;case 1:Ai(W,W.return);var de=W.stateNode;if(typeof de.componentWillUnmount=="function"){f=W,u=W.return;try{r=f,de.props=r.memoizedProps,de.state=r.memoizedState,de.componentWillUnmount()}catch(me){tt(f,u,me)}}break;case 5:Ai(W,W.return);break;case 22:if(W.memoizedState!==null){um(Y);continue}}ae!==null?(ae.return=W,le=ae):um(Y)}G=G.sibling}e:for(G=null,Y=s;;){if(Y.tag===5){if(G===null){G=Y;try{g=Y.stateNode,z?(v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(T=Y.stateNode,M=Y.memoizedProps.style,S=M!=null&&M.hasOwnProperty("display")?M.display:null,T.style.display=zd("display",S))}catch(me){tt(s,s.return,me)}}}else if(Y.tag===6){if(G===null)try{Y.stateNode.nodeValue=z?"":Y.memoizedProps}catch(me){tt(s,s.return,me)}}else if((Y.tag!==22&&Y.tag!==23||Y.memoizedState===null||Y===s)&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===s)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===s)break e;G===Y&&(G=null),Y=Y.return}G===Y&&(G=null),Y.sibling.return=Y.return,Y=Y.sibling}}break;case 19:Tn(r,s),Fn(s),f&4&&am(s);break;case 21:break;default:Tn(r,s),Fn(s)}}function Fn(s){var r=s.flags;if(r&2){try{e:{for(var u=s.return;u!==null;){if(sm(u)){var f=u;break e}u=u.return}throw Error(t(160))}switch(f.tag){case 5:var g=f.stateNode;f.flags&32&&(tr(g,""),f.flags&=-33);var v=im(s);xu(s,v,g);break;case 3:case 4:var S=f.stateNode.containerInfo,T=im(s);bu(s,T,S);break;default:throw Error(t(161))}}catch(M){tt(s,s.return,M)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function mb(s,r,u){le=s,lm(s)}function lm(s,r,u){for(var f=(s.mode&1)!==0;le!==null;){var g=le,v=g.child;if(g.tag===22&&f){var S=g.memoizedState!==null||go;if(!S){var T=g.alternate,M=T!==null&&T.memoizedState!==null||Ft;T=go;var z=Ft;if(go=S,(Ft=M)&&!z)for(le=g;le!==null;)S=le,M=S.child,S.tag===22&&S.memoizedState!==null?hm(g):M!==null?(M.return=S,le=M):hm(g);for(;v!==null;)le=v,lm(v),v=v.sibling;le=g,go=T,Ft=z}cm(s)}else(g.subtreeFlags&8772)!==0&&v!==null?(v.return=g,le=v):cm(s)}}function cm(s){for(;le!==null;){var r=le;if((r.flags&8772)!==0){var u=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Ft||yo(5,r);break;case 1:var f=r.stateNode;if(r.flags&4&&!Ft)if(u===null)f.componentDidMount();else{var g=r.elementType===r.type?u.memoizedProps:kn(r.type,u.memoizedProps);f.componentDidUpdate(g,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=r.updateQueue;v!==null&&up(r,v,f);break;case 3:var S=r.updateQueue;if(S!==null){if(u=null,r.child!==null)switch(r.child.tag){case 5:u=r.child.stateNode;break;case 1:u=r.child.stateNode}up(r,S,u)}break;case 5:var T=r.stateNode;if(u===null&&r.flags&4){u=T;var M=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":M.autoFocus&&u.focus();break;case"img":M.src&&(u.src=M.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var z=r.alternate;if(z!==null){var G=z.memoizedState;if(G!==null){var Y=G.dehydrated;Y!==null&&dr(Y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ft||r.flags&512&&wu(r)}catch(W){tt(r,r.return,W)}}if(r===s){le=null;break}if(u=r.sibling,u!==null){u.return=r.return,le=u;break}le=r.return}}function um(s){for(;le!==null;){var r=le;if(r===s){le=null;break}var u=r.sibling;if(u!==null){u.return=r.return,le=u;break}le=r.return}}function hm(s){for(;le!==null;){var r=le;try{switch(r.tag){case 0:case 11:case 15:var u=r.return;try{yo(4,r)}catch(M){tt(r,u,M)}break;case 1:var f=r.stateNode;if(typeof f.componentDidMount=="function"){var g=r.return;try{f.componentDidMount()}catch(M){tt(r,g,M)}}var v=r.return;try{wu(r)}catch(M){tt(r,v,M)}break;case 5:var S=r.return;try{wu(r)}catch(M){tt(r,S,M)}}}catch(M){tt(r,r.return,M)}if(r===s){le=null;break}var T=r.sibling;if(T!==null){T.return=r.return,le=T;break}le=r.return}}var gb=Math.ceil,vo=P.ReactCurrentDispatcher,_u=P.ReactCurrentOwner,pn=P.ReactCurrentBatchConfig,je=0,vt=null,lt=null,Ct=0,nn=0,Si=fs(0),ft=0,Lr=null,$s=0,wo=0,Au=0,Or=null,qt=null,Su=0,Ci=1/0,Zn=null,bo=!1,Cu=null,ws=null,xo=!1,bs=null,_o=0,Fr=0,ku=null,Ao=-1,So=0;function Bt(){return(je&6)!==0?it():Ao!==-1?Ao:Ao=it()}function xs(s){return(s.mode&1)===0?1:(je&2)!==0&&Ct!==0?Ct&-Ct:Zw.transition!==null?(So===0&&(So=sf()),So):(s=Ue,s!==0||(s=window.event,s=s===void 0?16:ff(s.type)),s)}function Pn(s,r,u,f){if(50<Fr)throw Fr=0,ku=null,Error(t(185));or(s,u,f),((je&2)===0||s!==vt)&&(s===vt&&((je&2)===0&&(wo|=u),ft===4&&_s(s,Ct)),Xt(s,f),u===1&&je===0&&(r.mode&1)===0&&(Ci=it()+500,Qa&&ms()))}function Xt(s,r){var u=s.callbackNode;Zv(s,r);var f=Ma(s,s===vt?Ct:0);if(f===0)u!==null&&ef(u),s.callbackNode=null,s.callbackPriority=0;else if(r=f&-f,s.callbackPriority!==r){if(u!=null&&ef(u),r===1)s.tag===0?Jw(fm.bind(null,s)):Jf(fm.bind(null,s)),Xw(function(){(je&6)===0&&ms()}),u=null;else{switch(rf(f)){case 1:u=rc;break;case 4:u=tf;break;case 16:u=Ta;break;case 536870912:u=nf;break;default:u=Ta}u=xm(u,dm.bind(null,s))}s.callbackPriority=r,s.callbackNode=u}}function dm(s,r){if(Ao=-1,So=0,(je&6)!==0)throw Error(t(327));var u=s.callbackNode;if(ki()&&s.callbackNode!==u)return null;var f=Ma(s,s===vt?Ct:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||r)r=Co(s,f);else{r=f;var g=je;je|=2;var v=mm();(vt!==s||Ct!==r)&&(Zn=null,Ci=it()+500,Us(s,r));do try{wb();break}catch(T){pm(s,T)}while(!0);Wc(),vo.current=v,je=g,lt!==null?r=0:(vt=null,Ct=0,r=ft)}if(r!==0){if(r===2&&(g=ac(s),g!==0&&(f=g,r=Eu(s,g))),r===1)throw u=Lr,Us(s,0),_s(s,f),Xt(s,it()),u;if(r===6)_s(s,f);else{if(g=s.current.alternate,(f&30)===0&&!yb(g)&&(r=Co(s,f),r===2&&(v=ac(s),v!==0&&(f=v,r=Eu(s,v))),r===1))throw u=Lr,Us(s,0),_s(s,f),Xt(s,it()),u;switch(s.finishedWork=g,s.finishedLanes=f,r){case 0:case 1:throw Error(t(345));case 2:Hs(s,qt,Zn);break;case 3:if(_s(s,f),(f&130023424)===f&&(r=Su+500-it(),10<r)){if(Ma(s,0)!==0)break;if(g=s.suspendedLanes,(g&f)!==f){Bt(),s.pingedLanes|=s.suspendedLanes&g;break}s.timeoutHandle=Ic(Hs.bind(null,s,qt,Zn),r);break}Hs(s,qt,Zn);break;case 4:if(_s(s,f),(f&4194240)===f)break;for(r=s.eventTimes,g=-1;0<f;){var S=31-An(f);v=1<<S,S=r[S],S>g&&(g=S),f&=~v}if(f=g,f=it()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*gb(f/1960))-f,10<f){s.timeoutHandle=Ic(Hs.bind(null,s,qt,Zn),f);break}Hs(s,qt,Zn);break;case 5:Hs(s,qt,Zn);break;default:throw Error(t(329))}}}return Xt(s,it()),s.callbackNode===u?dm.bind(null,s):null}function Eu(s,r){var u=Or;return s.current.memoizedState.isDehydrated&&(Us(s,r).flags|=256),s=Co(s,r),s!==2&&(r=qt,qt=u,r!==null&&Tu(r)),s}function Tu(s){qt===null?qt=s:qt.push.apply(qt,s)}function yb(s){for(var r=s;;){if(r.flags&16384){var u=r.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var g=u[f],v=g.getSnapshot;g=g.value;try{if(!Sn(v(),g))return!1}catch{return!1}}}if(u=r.child,r.subtreeFlags&16384&&u!==null)u.return=r,r=u;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function _s(s,r){for(r&=~Au,r&=~wo,s.suspendedLanes|=r,s.pingedLanes&=~r,s=s.expirationTimes;0<r;){var u=31-An(r),f=1<<u;s[u]=-1,r&=~f}}function fm(s){if((je&6)!==0)throw Error(t(327));ki();var r=Ma(s,0);if((r&1)===0)return Xt(s,it()),null;var u=Co(s,r);if(s.tag!==0&&u===2){var f=ac(s);f!==0&&(r=f,u=Eu(s,f))}if(u===1)throw u=Lr,Us(s,0),_s(s,r),Xt(s,it()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=r,Hs(s,qt,Zn),Xt(s,it()),null}function Pu(s,r){var u=je;je|=1;try{return s(r)}finally{je=u,je===0&&(Ci=it()+500,Qa&&ms())}}function zs(s){bs!==null&&bs.tag===0&&(je&6)===0&&ki();var r=je;je|=1;var u=pn.transition,f=Ue;try{if(pn.transition=null,Ue=1,s)return s()}finally{Ue=f,pn.transition=u,je=r,(je&6)===0&&ms()}}function Nu(){nn=Si.current,Xe(Si)}function Us(s,r){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,qw(u)),lt!==null)for(u=lt.return;u!==null;){var f=u;switch(Bc(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Ka();break;case 3:xi(),Xe(Wt),Xe(Dt),Jc();break;case 5:Yc(f);break;case 4:xi();break;case 13:Xe(Qe);break;case 19:Xe(Qe);break;case 10:Vc(f.type._context);break;case 22:case 23:Nu()}u=u.return}if(vt=s,lt=s=As(s.current,null),Ct=nn=r,ft=0,Lr=null,Au=wo=$s=0,qt=Or=null,Fs!==null){for(r=0;r<Fs.length;r++)if(u=Fs[r],f=u.interleaved,f!==null){u.interleaved=null;var g=f.next,v=u.pending;if(v!==null){var S=v.next;v.next=g,f.next=S}u.pending=f}Fs=null}return s}function pm(s,r){do{var u=lt;try{if(Wc(),oo.current=ho,lo){for(var f=Je.memoizedState;f!==null;){var g=f.queue;g!==null&&(g.pending=null),f=f.next}lo=!1}if(Bs=0,yt=dt=Je=null,Pr=!1,Nr=0,_u.current=null,u===null||u.return===null){ft=1,Lr=r,lt=null;break}e:{var v=s,S=u.return,T=u,M=r;if(r=Ct,T.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){var z=M,G=T,Y=G.tag;if((G.mode&1)===0&&(Y===0||Y===11||Y===15)){var W=G.alternate;W?(G.updateQueue=W.updateQueue,G.memoizedState=W.memoizedState,G.lanes=W.lanes):(G.updateQueue=null,G.memoizedState=null)}var ae=Bp(S);if(ae!==null){ae.flags&=-257,$p(ae,S,T,v,r),ae.mode&1&&jp(v,z,r),r=ae,M=z;var de=r.updateQueue;if(de===null){var me=new Set;me.add(M),r.updateQueue=me}else de.add(M);break e}else{if((r&1)===0){jp(v,z,r),Ru();break e}M=Error(t(426))}}else if(Ke&&T.mode&1){var rt=Bp(S);if(rt!==null){(rt.flags&65536)===0&&(rt.flags|=256),$p(rt,S,T,v,r),Uc(_i(M,T));break e}}v=M=_i(M,T),ft!==4&&(ft=2),Or===null?Or=[v]:Or.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,r&=-r,v.lanes|=r;var F=Op(v,M,r);cp(v,F);break e;case 1:T=M;var I=v.type,B=v.stateNode;if((v.flags&128)===0&&(typeof I.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(ws===null||!ws.has(B)))){v.flags|=65536,r&=-r,v.lanes|=r;var Z=Fp(v,T,r);cp(v,Z);break e}}v=v.return}while(v!==null)}ym(u)}catch(ye){r=ye,lt===u&&u!==null&&(lt=u=u.return);continue}break}while(!0)}function mm(){var s=vo.current;return vo.current=ho,s===null?ho:s}function Ru(){(ft===0||ft===3||ft===2)&&(ft=4),vt===null||($s&268435455)===0&&(wo&268435455)===0||_s(vt,Ct)}function Co(s,r){var u=je;je|=2;var f=mm();(vt!==s||Ct!==r)&&(Zn=null,Us(s,r));do try{vb();break}catch(g){pm(s,g)}while(!0);if(Wc(),je=u,vo.current=f,lt!==null)throw Error(t(261));return vt=null,Ct=0,ft}function vb(){for(;lt!==null;)gm(lt)}function wb(){for(;lt!==null&&!Wv();)gm(lt)}function gm(s){var r=bm(s.alternate,s,nn);s.memoizedProps=s.pendingProps,r===null?ym(s):lt=r,_u.current=null}function ym(s){var r=s;do{var u=r.alternate;if(s=r.return,(r.flags&32768)===0){if(u=hb(u,r,nn),u!==null){lt=u;return}}else{if(u=db(u,r),u!==null){u.flags&=32767,lt=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{ft=6,lt=null;return}}if(r=r.sibling,r!==null){lt=r;return}lt=r=s}while(r!==null);ft===0&&(ft=5)}function Hs(s,r,u){var f=Ue,g=pn.transition;try{pn.transition=null,Ue=1,bb(s,r,u,f)}finally{pn.transition=g,Ue=f}return null}function bb(s,r,u,f){do ki();while(bs!==null);if((je&6)!==0)throw Error(t(327));u=s.finishedWork;var g=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var v=u.lanes|u.childLanes;if(ew(s,v),s===vt&&(lt=vt=null,Ct=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||xo||(xo=!0,xm(Ta,function(){return ki(),null})),v=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||v){v=pn.transition,pn.transition=null;var S=Ue;Ue=1;var T=je;je|=4,_u.current=null,pb(s,u),om(u,s),$w(Rc),La=!!Nc,Rc=Nc=null,s.current=u,mb(u),Vv(),je=T,Ue=S,pn.transition=v}else s.current=u;if(xo&&(xo=!1,bs=s,_o=g),v=s.pendingLanes,v===0&&(ws=null),Xv(u.stateNode),Xt(s,it()),r!==null)for(f=s.onRecoverableError,u=0;u<r.length;u++)g=r[u],f(g.value,{componentStack:g.stack,digest:g.digest});if(bo)throw bo=!1,s=Cu,Cu=null,s;return(_o&1)!==0&&s.tag!==0&&ki(),v=s.pendingLanes,(v&1)!==0?s===ku?Fr++:(Fr=0,ku=s):Fr=0,ms(),null}function ki(){if(bs!==null){var s=rf(_o),r=pn.transition,u=Ue;try{if(pn.transition=null,Ue=16>s?16:s,bs===null)var f=!1;else{if(s=bs,bs=null,_o=0,(je&6)!==0)throw Error(t(331));var g=je;for(je|=4,le=s.current;le!==null;){var v=le,S=v.child;if((le.flags&16)!==0){var T=v.deletions;if(T!==null){for(var M=0;M<T.length;M++){var z=T[M];for(le=z;le!==null;){var G=le;switch(G.tag){case 0:case 11:case 15:Dr(8,G,v)}var Y=G.child;if(Y!==null)Y.return=G,le=Y;else for(;le!==null;){G=le;var W=G.sibling,ae=G.return;if(nm(G),G===z){le=null;break}if(W!==null){W.return=ae,le=W;break}le=ae}}}var de=v.alternate;if(de!==null){var me=de.child;if(me!==null){de.child=null;do{var rt=me.sibling;me.sibling=null,me=rt}while(me!==null)}}le=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,le=S;else e:for(;le!==null;){if(v=le,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Dr(9,v,v.return)}var F=v.sibling;if(F!==null){F.return=v.return,le=F;break e}le=v.return}}var I=s.current;for(le=I;le!==null;){S=le;var B=S.child;if((S.subtreeFlags&2064)!==0&&B!==null)B.return=S,le=B;else e:for(S=I;le!==null;){if(T=le,(T.flags&2048)!==0)try{switch(T.tag){case 0:case 11:case 15:yo(9,T)}}catch(ye){tt(T,T.return,ye)}if(T===S){le=null;break e}var Z=T.sibling;if(Z!==null){Z.return=T.return,le=Z;break e}le=T.return}}if(je=g,ms(),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Pa,s)}catch{}f=!0}return f}finally{Ue=u,pn.transition=r}}return!1}function vm(s,r,u){r=_i(u,r),r=Op(s,r,1),s=ys(s,r,1),r=Bt(),s!==null&&(or(s,1,r),Xt(s,r))}function tt(s,r,u){if(s.tag===3)vm(s,s,u);else for(;r!==null;){if(r.tag===3){vm(r,s,u);break}else if(r.tag===1){var f=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ws===null||!ws.has(f))){s=_i(u,s),s=Fp(r,s,1),r=ys(r,s,1),s=Bt(),r!==null&&(or(r,1,s),Xt(r,s));break}}r=r.return}}function xb(s,r,u){var f=s.pingCache;f!==null&&f.delete(r),r=Bt(),s.pingedLanes|=s.suspendedLanes&u,vt===s&&(Ct&u)===u&&(ft===4||ft===3&&(Ct&130023424)===Ct&&500>it()-Su?Us(s,0):Au|=u),Xt(s,r)}function wm(s,r){r===0&&((s.mode&1)===0?r=1:(r=Ra,Ra<<=1,(Ra&130023424)===0&&(Ra=4194304)));var u=Bt();s=Yn(s,r),s!==null&&(or(s,r,u),Xt(s,u))}function _b(s){var r=s.memoizedState,u=0;r!==null&&(u=r.retryLane),wm(s,u)}function Ab(s,r){var u=0;switch(s.tag){case 13:var f=s.stateNode,g=s.memoizedState;g!==null&&(u=g.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(r),wm(s,u)}var bm;bm=function(s,r,u){if(s!==null)if(s.memoizedProps!==r.pendingProps||Wt.current)Gt=!0;else{if((s.lanes&u)===0&&(r.flags&128)===0)return Gt=!1,ub(s,r,u);Gt=(s.flags&131072)!==0}else Gt=!1,Ke&&(r.flags&1048576)!==0&&Zf(r,Za,r.index);switch(r.lanes=0,r.tag){case 2:var f=r.type;mo(s,r),s=r.pendingProps;var g=pi(r,Dt.current);bi(r,u),g=tu(null,r,f,s,g,u);var v=nu();return r.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Vt(f)?(v=!0,Ya(r)):v=!1,r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,Xc(r),g.updater=fo,r.stateNode=g,g._reactInternals=r,lu(r,f,s,u),r=du(null,r,f,!0,v,u)):(r.tag=0,Ke&&v&&jc(r),jt(null,r,g,u),r=r.child),r;case 16:f=r.elementType;e:{switch(mo(s,r),s=r.pendingProps,g=f._init,f=g(f._payload),r.type=f,g=r.tag=Cb(f),s=kn(f,s),g){case 0:r=hu(null,r,f,s,u);break e;case 1:r=Gp(null,r,f,s,u);break e;case 11:r=zp(null,r,f,s,u);break e;case 14:r=Up(null,r,f,kn(f.type,s),u);break e}throw Error(t(306,f,""))}return r;case 0:return f=r.type,g=r.pendingProps,g=r.elementType===f?g:kn(f,g),hu(s,r,f,g,u);case 1:return f=r.type,g=r.pendingProps,g=r.elementType===f?g:kn(f,g),Gp(s,r,f,g,u);case 3:e:{if(qp(r),s===null)throw Error(t(387));f=r.pendingProps,v=r.memoizedState,g=v.element,lp(s,r),ro(r,f,null,u);var S=r.memoizedState;if(f=S.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){g=_i(Error(t(423)),r),r=Xp(s,r,f,u,g);break e}else if(f!==g){g=_i(Error(t(424)),r),r=Xp(s,r,f,u,g);break e}else for(tn=ds(r.stateNode.containerInfo.firstChild),en=r,Ke=!0,Cn=null,u=ap(r,null,f,u),r.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(yi(),f===g){r=Jn(s,r,u);break e}jt(s,r,f,u)}r=r.child}return r;case 5:return hp(r),s===null&&zc(r),f=r.type,g=r.pendingProps,v=s!==null?s.memoizedProps:null,S=g.children,Mc(f,g)?S=null:v!==null&&Mc(f,v)&&(r.flags|=32),Vp(s,r),jt(s,r,S,u),r.child;case 6:return s===null&&zc(r),null;case 13:return Kp(s,r,u);case 4:return Kc(r,r.stateNode.containerInfo),f=r.pendingProps,s===null?r.child=vi(r,null,f,u):jt(s,r,f,u),r.child;case 11:return f=r.type,g=r.pendingProps,g=r.elementType===f?g:kn(f,g),zp(s,r,f,g,u);case 7:return jt(s,r,r.pendingProps,u),r.child;case 8:return jt(s,r,r.pendingProps.children,u),r.child;case 12:return jt(s,r,r.pendingProps.children,u),r.child;case 10:e:{if(f=r.type._context,g=r.pendingProps,v=r.memoizedProps,S=g.value,Ve(no,f._currentValue),f._currentValue=S,v!==null)if(Sn(v.value,S)){if(v.children===g.children&&!Wt.current){r=Jn(s,r,u);break e}}else for(v=r.child,v!==null&&(v.return=r);v!==null;){var T=v.dependencies;if(T!==null){S=v.child;for(var M=T.firstContext;M!==null;){if(M.context===f){if(v.tag===1){M=Qn(-1,u&-u),M.tag=2;var z=v.updateQueue;if(z!==null){z=z.shared;var G=z.pending;G===null?M.next=M:(M.next=G.next,G.next=M),z.pending=M}}v.lanes|=u,M=v.alternate,M!==null&&(M.lanes|=u),Gc(v.return,u,r),T.lanes|=u;break}M=M.next}}else if(v.tag===10)S=v.type===r.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=u,T=S.alternate,T!==null&&(T.lanes|=u),Gc(S,u,r),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===r){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}jt(s,r,g.children,u),r=r.child}return r;case 9:return g=r.type,f=r.pendingProps.children,bi(r,u),g=dn(g),f=f(g),r.flags|=1,jt(s,r,f,u),r.child;case 14:return f=r.type,g=kn(f,r.pendingProps),g=kn(f.type,g),Up(s,r,f,g,u);case 15:return Hp(s,r,r.type,r.pendingProps,u);case 17:return f=r.type,g=r.pendingProps,g=r.elementType===f?g:kn(f,g),mo(s,r),r.tag=1,Vt(f)?(s=!0,Ya(r)):s=!1,bi(r,u),Dp(r,f,g),lu(r,f,g,u),du(null,r,f,!0,s,u);case 19:return Qp(s,r,u);case 22:return Wp(s,r,u)}throw Error(t(156,r.tag))};function xm(s,r){return Zd(s,r)}function Sb(s,r,u,f){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(s,r,u,f){return new Sb(s,r,u,f)}function Mu(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Cb(s){if(typeof s=="function")return Mu(s)?1:0;if(s!=null){if(s=s.$$typeof,s===xe)return 11;if(s===te)return 14}return 2}function As(s,r){var u=s.alternate;return u===null?(u=mn(s.tag,r,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=r,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,r=s.dependencies,u.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function ko(s,r,u,f,g,v){var S=2;if(f=s,typeof s=="function")Mu(s)&&(S=1);else if(typeof s=="string")S=5;else e:switch(s){case O:return Ws(u.children,g,v,r);case L:S=8,g|=8;break;case H:return s=mn(12,u,r,g|2),s.elementType=H,s.lanes=v,s;case X:return s=mn(13,u,r,g),s.elementType=X,s.lanes=v,s;case re:return s=mn(19,u,r,g),s.elementType=re,s.lanes=v,s;case K:return Eo(u,g,v,r);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case V:S=10;break e;case q:S=9;break e;case xe:S=11;break e;case te:S=14;break e;case J:S=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return r=mn(S,u,r,g),r.elementType=s,r.type=f,r.lanes=v,r}function Ws(s,r,u,f){return s=mn(7,s,f,r),s.lanes=u,s}function Eo(s,r,u,f){return s=mn(22,s,f,r),s.elementType=K,s.lanes=u,s.stateNode={isHidden:!1},s}function Iu(s,r,u){return s=mn(6,s,null,r),s.lanes=u,s}function Du(s,r,u){return r=mn(4,s.children!==null?s.children:[],s.key,r),r.lanes=u,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}function kb(s,r,u,f,g){this.tag=r,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oc(0),this.expirationTimes=oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oc(0),this.identifierPrefix=f,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function Lu(s,r,u,f,g,v,S,T,M){return s=new kb(s,r,u,T,M),r===1?(r=1,v===!0&&(r|=8)):r=0,v=mn(3,null,null,r),s.current=v,v.stateNode=s,v.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xc(v),s}function Eb(s,r,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:N,key:f==null?null:""+f,children:s,containerInfo:r,implementation:u}}function _m(s){if(!s)return ps;s=s._reactInternals;e:{if(Ms(s)!==s||s.tag!==1)throw Error(t(170));var r=s;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Vt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(Vt(u))return Yf(s,u,r)}return r}function Am(s,r,u,f,g,v,S,T,M){return s=Lu(u,f,!0,s,g,v,S,T,M),s.context=_m(null),u=s.current,f=Bt(),g=xs(u),v=Qn(f,g),v.callback=r??null,ys(u,v,g),s.current.lanes=g,or(s,g,f),Xt(s,f),s}function To(s,r,u,f){var g=r.current,v=Bt(),S=xs(g);return u=_m(u),r.context===null?r.context=u:r.pendingContext=u,r=Qn(v,S),r.payload={element:s},f=f===void 0?null:f,f!==null&&(r.callback=f),s=ys(g,r,S),s!==null&&(Pn(s,g,S,v),io(s,g,S)),S}function Po(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Sm(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<r?u:r}}function Ou(s,r){Sm(s,r),(s=s.alternate)&&Sm(s,r)}function Tb(){return null}var Cm=typeof reportError=="function"?reportError:function(s){console.error(s)};function Fu(s){this._internalRoot=s}No.prototype.render=Fu.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(t(409));To(s,r,null,null)},No.prototype.unmount=Fu.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;zs(function(){To(null,s,null,null)}),r[Gn]=null}};function No(s){this._internalRoot=s}No.prototype.unstable_scheduleHydration=function(s){if(s){var r=lf();s={blockedOn:null,target:s,priority:r};for(var u=0;u<cs.length&&r!==0&&r<cs[u].priority;u++);cs.splice(u,0,s),u===0&&hf(s)}};function ju(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Ro(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function km(){}function Pb(s,r,u,f,g){if(g){if(typeof f=="function"){var v=f;f=function(){var z=Po(S);v.call(z)}}var S=Am(r,f,s,0,null,!1,!1,"",km);return s._reactRootContainer=S,s[Gn]=S.current,xr(s.nodeType===8?s.parentNode:s),zs(),S}for(;g=s.lastChild;)s.removeChild(g);if(typeof f=="function"){var T=f;f=function(){var z=Po(M);T.call(z)}}var M=Lu(s,0,!1,null,null,!1,!1,"",km);return s._reactRootContainer=M,s[Gn]=M.current,xr(s.nodeType===8?s.parentNode:s),zs(function(){To(r,M,u,f)}),M}function Mo(s,r,u,f,g){var v=u._reactRootContainer;if(v){var S=v;if(typeof g=="function"){var T=g;g=function(){var M=Po(S);T.call(M)}}To(r,S,s,g)}else S=Pb(u,r,s,g,f);return Po(S)}af=function(s){switch(s.tag){case 3:var r=s.stateNode;if(r.current.memoizedState.isDehydrated){var u=ar(r.pendingLanes);u!==0&&(lc(r,u|1),Xt(r,it()),(je&6)===0&&(Ci=it()+500,ms()))}break;case 13:zs(function(){var f=Yn(s,1);if(f!==null){var g=Bt();Pn(f,s,1,g)}}),Ou(s,1)}},cc=function(s){if(s.tag===13){var r=Yn(s,134217728);if(r!==null){var u=Bt();Pn(r,s,134217728,u)}Ou(s,134217728)}},of=function(s){if(s.tag===13){var r=xs(s),u=Yn(s,r);if(u!==null){var f=Bt();Pn(u,s,r,f)}Ou(s,r)}},lf=function(){return Ue},cf=function(s,r){var u=Ue;try{return Ue=s,r()}finally{Ue=u}},tc=function(s,r,u){switch(r){case"input":if(ql(s,u),r=u.name,u.type==="radio"&&r!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<u.length;r++){var f=u[r];if(f!==s&&f.form===s.form){var g=Xa(f);if(!g)throw Error(t(90));_n(f),ql(f,g)}}}break;case"textarea":Fd(s,u);break;case"select":r=u.value,r!=null&&ni(s,!!u.multiple,r,!1)}},Gd=Pu,qd=zs;var Nb={usingClientEntryPoint:!1,Events:[Sr,di,Xa,Wd,Vd,Pu]},jr={findFiberByHostInstance:Is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rb={bundleType:jr.bundleType,version:jr.version,rendererPackageName:jr.rendererPackageName,rendererConfig:jr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Qd(s),s===null?null:s.stateNode},findFiberByHostInstance:jr.findFiberByHostInstance||Tb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Io=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Io.isDisabled&&Io.supportsFiber)try{Pa=Io.inject(Rb),In=Io}catch{}}return Kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nb,Kt.createPortal=function(s,r){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ju(r))throw Error(t(200));return Eb(s,r,null,u)},Kt.createRoot=function(s,r){if(!ju(s))throw Error(t(299));var u=!1,f="",g=Cm;return r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onRecoverableError!==void 0&&(g=r.onRecoverableError)),r=Lu(s,1,!1,null,null,u,!1,f,g),s[Gn]=r.current,xr(s.nodeType===8?s.parentNode:s),new Fu(r)},Kt.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Qd(r),s=s===null?null:s.stateNode,s},Kt.flushSync=function(s){return zs(s)},Kt.hydrate=function(s,r,u){if(!Ro(r))throw Error(t(200));return Mo(null,s,r,!0,u)},Kt.hydrateRoot=function(s,r,u){if(!ju(s))throw Error(t(405));var f=u!=null&&u.hydratedSources||null,g=!1,v="",S=Cm;if(u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onRecoverableError!==void 0&&(S=u.onRecoverableError)),r=Am(r,null,s,1,u??null,g,!1,v,S),s[Gn]=r.current,xr(s),f)for(s=0;s<f.length;s++)u=f[s],g=u._getVersion,g=g(u._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[u,g]:r.mutableSourceEagerHydrationData.push(u,g);return new No(r)},Kt.render=function(s,r,u){if(!Ro(r))throw Error(t(200));return Mo(null,s,r,!1,u)},Kt.unmountComponentAtNode=function(s){if(!Ro(s))throw Error(t(40));return s._reactRootContainer?(zs(function(){Mo(null,null,s,!1,function(){s._reactRootContainer=null,s[Gn]=null})}),!0):!1},Kt.unstable_batchedUpdates=Pu,Kt.unstable_renderSubtreeIntoContainer=function(s,r,u,f){if(!Ro(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Mo(s,r,u,!1,f)},Kt.version="18.3.1-next-f1338f8080-20240426",Kt}var Dm;function Kg(){if(Dm)return zu.exports;Dm=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(e){console.error(e)}}return o(),zu.exports=$b(),zu.exports}var Lm;function zb(){if(Lm)return Do;Lm=1;var o=Kg();return Do.createRoot=o.createRoot,Do.hydrateRoot=o.hydrateRoot,Do}var Ub=zb(),ee=$h();const Hb=Db(ee),zh=Ib({__proto__:null,default:Hb},[ee]);function Om(o,e){if(typeof o=="function")return o(e);o!=null&&(o.current=e)}function Uh(...o){return e=>{let t=!1;const n=o.map(i=>{const a=Om(i,e);return!t&&typeof a=="function"&&(t=!0),a});if(t)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():Om(o[i],null)}}}}function Yg(...o){return ee.useCallback(Uh(...o),o)}var Wb=Symbol.for("react.lazy"),pl=zh[" use ".trim().toString()];function Vb(o){return typeof o=="object"&&o!==null&&"then"in o}function Qg(o){return o!=null&&typeof o=="object"&&"$$typeof"in o&&o.$$typeof===Wb&&"_payload"in o&&Vb(o._payload)}function Jg(o){const e=Gb(o),t=ee.forwardRef((n,i)=>{let{children:a,...l}=n;Qg(a)&&typeof pl=="function"&&(a=pl(a._payload));const c=ee.Children.toArray(a),h=c.find(Xb);if(h){const d=h.props.children,p=c.map(m=>m===h?ee.Children.count(d)>1?ee.Children.only(null):ee.isValidElement(d)?d.props.children:null:m);return x.jsx(e,{...l,ref:i,children:ee.isValidElement(d)?ee.cloneElement(d,void 0,p):null})}return x.jsx(e,{...l,ref:i,children:a})});return t.displayName=`${o}.Slot`,t}var Zg=Jg("Slot");function Gb(o){const e=ee.forwardRef((t,n)=>{let{children:i,...a}=t;if(Qg(i)&&typeof pl=="function"&&(i=pl(i._payload)),ee.isValidElement(i)){const l=Yb(i),c=Kb(a,i.props);return i.type!==ee.Fragment&&(c.ref=n?Uh(n,l):l),ee.cloneElement(i,c)}return ee.Children.count(i)>1?ee.Children.only(null):null});return e.displayName=`${o}.SlotClone`,e}var qb=Symbol("radix.slottable");function Xb(o){return ee.isValidElement(o)&&typeof o.type=="function"&&"__radixId"in o.type&&o.type.__radixId===qb}function Kb(o,e){const t={...e};for(const n in e){const i=o[n],a=e[n];/^on[A-Z]/.test(n)?i&&a?t[n]=(...c)=>{const h=a(...c);return i(...c),h}:i&&(t[n]=i):n==="style"?t[n]={...i,...a}:n==="className"&&(t[n]=[i,a].filter(Boolean).join(" "))}return{...o,...t}}function Yb(o){let e=Object.getOwnPropertyDescriptor(o.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?o.ref:(e=Object.getOwnPropertyDescriptor(o,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?o.props.ref:o.props.ref||o.ref)}function ey(o){var e,t,n="";if(typeof o=="string"||typeof o=="number")n+=o;else if(typeof o=="object")if(Array.isArray(o)){var i=o.length;for(e=0;e<i;e++)o[e]&&(t=ey(o[e]))&&(n&&(n+=" "),n+=t)}else for(t in o)o[t]&&(n&&(n+=" "),n+=t);return n}function ty(){for(var o,e,t=0,n="",i=arguments.length;t<i;t++)(o=arguments[t])&&(e=ey(o))&&(n&&(n+=" "),n+=e);return n}const Fm=o=>typeof o=="boolean"?`${o}`:o===0?"0":o,jm=ty,Hh=(o,e)=>t=>{var n;if(e?.variants==null)return jm(o,t?.class,t?.className);const{variants:i,defaultVariants:a}=e,l=Object.keys(i).map(d=>{const p=t?.[d],m=a?.[d];if(p===null)return null;const y=Fm(p)||Fm(m);return i[d][y]}),c=t&&Object.entries(t).reduce((d,p)=>{let[m,y]=p;return y===void 0||(d[m]=y),d},{}),h=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,p)=>{let{class:m,className:y,...w}=p;return Object.entries(w).every(_=>{let[b,A]=_;return Array.isArray(A)?A.includes({...a,...c}[b]):{...a,...c}[b]===A})?[...d,m,y]:d},[]);return jm(o,l,h,t?.class,t?.className)},Qb=(o,e)=>{const t=new Array(o.length+e.length);for(let n=0;n<o.length;n++)t[n]=o[n];for(let n=0;n<e.length;n++)t[o.length+n]=e[n];return t},Jb=(o,e)=>({classGroupId:o,validator:e}),ny=(o=new Map,e=null,t)=>({nextPart:o,validators:e,classGroupId:t}),ml="-",Bm=[],Zb="arbitrary..",ex=o=>{const e=nx(o),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=o;return{getClassGroupId:l=>{if(l.startsWith("[")&&l.endsWith("]"))return tx(l);const c=l.split(ml),h=c[0]===""&&c.length>1?1:0;return sy(c,h,e)},getConflictingClassGroupIds:(l,c)=>{if(c){const h=n[l],d=t[l];return h?d?Qb(d,h):h:d||Bm}return t[l]||Bm}}},sy=(o,e,t)=>{if(o.length-e===0)return t.classGroupId;const i=o[e],a=t.nextPart.get(i);if(a){const d=sy(o,e+1,a);if(d)return d}const l=t.validators;if(l===null)return;const c=e===0?o.join(ml):o.slice(e).join(ml),h=l.length;for(let d=0;d<h;d++){const p=l[d];if(p.validator(c))return p.classGroupId}},tx=o=>o.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=o.slice(1,-1),t=e.indexOf(":"),n=e.slice(0,t);return n?Zb+n:void 0})(),nx=o=>{const{theme:e,classGroups:t}=o;return sx(t,e)},sx=(o,e)=>{const t=ny();for(const n in o){const i=o[n];Wh(i,t,n,e)}return t},Wh=(o,e,t,n)=>{const i=o.length;for(let a=0;a<i;a++){const l=o[a];ix(l,e,t,n)}},ix=(o,e,t,n)=>{if(typeof o=="string"){rx(o,e,t);return}if(typeof o=="function"){ax(o,e,t,n);return}ox(o,e,t,n)},rx=(o,e,t)=>{const n=o===""?e:iy(e,o);n.classGroupId=t},ax=(o,e,t,n)=>{if(lx(o)){Wh(o(n),e,t,n);return}e.validators===null&&(e.validators=[]),e.validators.push(Jb(t,o))},ox=(o,e,t,n)=>{const i=Object.entries(o),a=i.length;for(let l=0;l<a;l++){const[c,h]=i[l];Wh(h,iy(e,c),t,n)}},iy=(o,e)=>{let t=o;const n=e.split(ml),i=n.length;for(let a=0;a<i;a++){const l=n[a];let c=t.nextPart.get(l);c||(c=ny(),t.nextPart.set(l,c)),t=c}return t},lx=o=>"isThemeGetter"in o&&o.isThemeGetter===!0,cx=o=>{if(o<1)return{get:()=>{},set:()=>{}};let e=0,t=Object.create(null),n=Object.create(null);const i=(a,l)=>{t[a]=l,e++,e>o&&(e=0,n=t,t=Object.create(null))};return{get(a){let l=t[a];if(l!==void 0)return l;if((l=n[a])!==void 0)return i(a,l),l},set(a,l){a in t?t[a]=l:i(a,l)}}},uh="!",$m=":",ux=[],zm=(o,e,t,n,i)=>({modifiers:o,hasImportantModifier:e,baseClassName:t,maybePostfixModifierPosition:n,isExternal:i}),hx=o=>{const{prefix:e,experimentalParseClassName:t}=o;let n=i=>{const a=[];let l=0,c=0,h=0,d;const p=i.length;for(let b=0;b<p;b++){const A=i[b];if(l===0&&c===0){if(A===$m){a.push(i.slice(h,b)),h=b+1;continue}if(A==="/"){d=b;continue}}A==="["?l++:A==="]"?l--:A==="("?c++:A===")"&&c--}const m=a.length===0?i:i.slice(h);let y=m,w=!1;m.endsWith(uh)?(y=m.slice(0,-1),w=!0):m.startsWith(uh)&&(y=m.slice(1),w=!0);const _=d&&d>h?d-h:void 0;return zm(a,w,y,_)};if(e){const i=e+$m,a=n;n=l=>l.startsWith(i)?a(l.slice(i.length)):zm(ux,!1,l,void 0,!0)}if(t){const i=n;n=a=>t({className:a,parseClassName:i})}return n},dx=o=>{const e=new Map;return o.orderSensitiveModifiers.forEach((t,n)=>{e.set(t,1e6+n)}),t=>{const n=[];let i=[];for(let a=0;a<t.length;a++){const l=t[a],c=l[0]==="[",h=e.has(l);c||h?(i.length>0&&(i.sort(),n.push(...i),i=[]),n.push(l)):i.push(l)}return i.length>0&&(i.sort(),n.push(...i)),n}},fx=o=>({cache:cx(o.cacheSize),parseClassName:hx(o),sortModifiers:dx(o),...ex(o)}),px=/\s+/,mx=(o,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:a}=e,l=[],c=o.trim().split(px);let h="";for(let d=c.length-1;d>=0;d-=1){const p=c[d],{isExternal:m,modifiers:y,hasImportantModifier:w,baseClassName:_,maybePostfixModifierPosition:b}=t(p);if(m){h=p+(h.length>0?" "+h:h);continue}let A=!!b,C=n(A?_.substring(0,b):_);if(!C){if(!A){h=p+(h.length>0?" "+h:h);continue}if(C=n(_),!C){h=p+(h.length>0?" "+h:h);continue}A=!1}const k=y.length===0?"":y.length===1?y[0]:a(y).join(":"),E=w?k+uh:k,P=E+C;if(l.indexOf(P)>-1)continue;l.push(P);const R=i(C,A);for(let N=0;N<R.length;++N){const O=R[N];l.push(E+O)}h=p+(h.length>0?" "+h:h)}return h},gx=(...o)=>{let e=0,t,n,i="";for(;e<o.length;)(t=o[e++])&&(n=ry(t))&&(i&&(i+=" "),i+=n);return i},ry=o=>{if(typeof o=="string")return o;let e,t="";for(let n=0;n<o.length;n++)o[n]&&(e=ry(o[n]))&&(t&&(t+=" "),t+=e);return t},yx=(o,...e)=>{let t,n,i,a;const l=h=>{const d=e.reduce((p,m)=>m(p),o());return t=fx(d),n=t.cache.get,i=t.cache.set,a=c,c(h)},c=h=>{const d=n(h);if(d)return d;const p=mx(h,t);return i(h,p),p};return a=l,(...h)=>a(gx(...h))},vx=[],pt=o=>{const e=t=>t[o]||vx;return e.isThemeGetter=!0,e},ay=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,oy=/^\((?:(\w[\w-]*):)?(.+)\)$/i,wx=/^\d+\/\d+$/,bx=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xx=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,_x=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ax=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Sx=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ei=o=>wx.test(o),Me=o=>!!o&&!Number.isNaN(Number(o)),Cs=o=>!!o&&Number.isInteger(Number(o)),Wu=o=>o.endsWith("%")&&Me(o.slice(0,-1)),es=o=>bx.test(o),Cx=()=>!0,kx=o=>xx.test(o)&&!_x.test(o),ly=()=>!1,Ex=o=>Ax.test(o),Tx=o=>Sx.test(o),Px=o=>!fe(o)&&!pe(o),Nx=o=>Ki(o,hy,ly),fe=o=>ay.test(o),Vs=o=>Ki(o,dy,kx),Vu=o=>Ki(o,Lx,Me),Um=o=>Ki(o,cy,ly),Rx=o=>Ki(o,uy,Tx),Lo=o=>Ki(o,fy,Ex),pe=o=>oy.test(o),$r=o=>Yi(o,dy),Mx=o=>Yi(o,Ox),Hm=o=>Yi(o,cy),Ix=o=>Yi(o,hy),Dx=o=>Yi(o,uy),Oo=o=>Yi(o,fy,!0),Ki=(o,e,t)=>{const n=ay.exec(o);return n?n[1]?e(n[1]):t(n[2]):!1},Yi=(o,e,t=!1)=>{const n=oy.exec(o);return n?n[1]?e(n[1]):t:!1},cy=o=>o==="position"||o==="percentage",uy=o=>o==="image"||o==="url",hy=o=>o==="length"||o==="size"||o==="bg-size",dy=o=>o==="length",Lx=o=>o==="number",Ox=o=>o==="family-name",fy=o=>o==="shadow",Fx=()=>{const o=pt("color"),e=pt("font"),t=pt("text"),n=pt("font-weight"),i=pt("tracking"),a=pt("leading"),l=pt("breakpoint"),c=pt("container"),h=pt("spacing"),d=pt("radius"),p=pt("shadow"),m=pt("inset-shadow"),y=pt("text-shadow"),w=pt("drop-shadow"),_=pt("blur"),b=pt("perspective"),A=pt("aspect"),C=pt("ease"),k=pt("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],R=()=>[...P(),pe,fe],N=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto","contain","none"],L=()=>[pe,fe,h],H=()=>[Ei,"full","auto",...L()],V=()=>[Cs,"none","subgrid",pe,fe],q=()=>["auto",{span:["full",Cs,pe,fe]},Cs,pe,fe],xe=()=>[Cs,"auto",pe,fe],X=()=>["auto","min","max","fr",pe,fe],re=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],te=()=>["start","end","center","stretch","center-safe","end-safe"],J=()=>["auto",...L()],K=()=>[Ei,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...L()],j=()=>[o,pe,fe],ne=()=>[...P(),Hm,Um,{position:[pe,fe]}],se=()=>["no-repeat",{repeat:["","x","y","space","round"]}],D=()=>["auto","cover","contain",Ix,Nx,{size:[pe,fe]}],U=()=>[Wu,$r,Vs],ie=()=>["","none","full",d,pe,fe],ge=()=>["",Me,$r,Vs],ke=()=>["solid","dashed","dotted","double"],Ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],oe=()=>[Me,Wu,Hm,Um],Ie=()=>["","none",_,pe,fe],Le=()=>["none",Me,pe,fe],ot=()=>["none",Me,pe,fe],cn=()=>[Me,pe,fe],_n=()=>[Ei,"full",...L()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[es],breakpoint:[es],color:[Cx],container:[es],"drop-shadow":[es],ease:["in","out","in-out"],font:[Px],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[es],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[es],shadow:[es],spacing:["px",Me],text:[es],"text-shadow":[es],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ei,fe,pe,A]}],container:["container"],columns:[{columns:[Me,fe,pe,c]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:R()}],overflow:[{overflow:N()}],"overflow-x":[{"overflow-x":N()}],"overflow-y":[{"overflow-y":N()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:H()}],"inset-x":[{"inset-x":H()}],"inset-y":[{"inset-y":H()}],start:[{start:H()}],end:[{end:H()}],top:[{top:H()}],right:[{right:H()}],bottom:[{bottom:H()}],left:[{left:H()}],visibility:["visible","invisible","collapse"],z:[{z:[Cs,"auto",pe,fe]}],basis:[{basis:[Ei,"full","auto",c,...L()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Me,Ei,"auto","initial","none",fe]}],grow:[{grow:["",Me,pe,fe]}],shrink:[{shrink:["",Me,pe,fe]}],order:[{order:[Cs,"first","last","none",pe,fe]}],"grid-cols":[{"grid-cols":V()}],"col-start-end":[{col:q()}],"col-start":[{"col-start":xe()}],"col-end":[{"col-end":xe()}],"grid-rows":[{"grid-rows":V()}],"row-start-end":[{row:q()}],"row-start":[{"row-start":xe()}],"row-end":[{"row-end":xe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":X()}],"auto-rows":[{"auto-rows":X()}],gap:[{gap:L()}],"gap-x":[{"gap-x":L()}],"gap-y":[{"gap-y":L()}],"justify-content":[{justify:[...re(),"normal"]}],"justify-items":[{"justify-items":[...te(),"normal"]}],"justify-self":[{"justify-self":["auto",...te()]}],"align-content":[{content:["normal",...re()]}],"align-items":[{items:[...te(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...te(),{baseline:["","last"]}]}],"place-content":[{"place-content":re()}],"place-items":[{"place-items":[...te(),"baseline"]}],"place-self":[{"place-self":["auto",...te()]}],p:[{p:L()}],px:[{px:L()}],py:[{py:L()}],ps:[{ps:L()}],pe:[{pe:L()}],pt:[{pt:L()}],pr:[{pr:L()}],pb:[{pb:L()}],pl:[{pl:L()}],m:[{m:J()}],mx:[{mx:J()}],my:[{my:J()}],ms:[{ms:J()}],me:[{me:J()}],mt:[{mt:J()}],mr:[{mr:J()}],mb:[{mb:J()}],ml:[{ml:J()}],"space-x":[{"space-x":L()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":L()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[c,"screen",...K()]}],"min-w":[{"min-w":[c,"screen","none",...K()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[l]},...K()]}],h:[{h:["screen","lh",...K()]}],"min-h":[{"min-h":["screen","lh","none",...K()]}],"max-h":[{"max-h":["screen","lh",...K()]}],"font-size":[{text:["base",t,$r,Vs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,pe,Vu]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Wu,fe]}],"font-family":[{font:[Mx,fe,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,pe,fe]}],"line-clamp":[{"line-clamp":[Me,"none",pe,Vu]}],leading:[{leading:[a,...L()]}],"list-image":[{"list-image":["none",pe,fe]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",pe,fe]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ke(),"wavy"]}],"text-decoration-thickness":[{decoration:[Me,"from-font","auto",pe,Vs]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[Me,"auto",pe,fe]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pe,fe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pe,fe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:se()}],"bg-size":[{bg:D()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Cs,pe,fe],radial:["",pe,fe],conic:[Cs,pe,fe]},Dx,Rx]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:U()}],"gradient-via-pos":[{via:U()}],"gradient-to-pos":[{to:U()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:ie()}],"rounded-s":[{"rounded-s":ie()}],"rounded-e":[{"rounded-e":ie()}],"rounded-t":[{"rounded-t":ie()}],"rounded-r":[{"rounded-r":ie()}],"rounded-b":[{"rounded-b":ie()}],"rounded-l":[{"rounded-l":ie()}],"rounded-ss":[{"rounded-ss":ie()}],"rounded-se":[{"rounded-se":ie()}],"rounded-ee":[{"rounded-ee":ie()}],"rounded-es":[{"rounded-es":ie()}],"rounded-tl":[{"rounded-tl":ie()}],"rounded-tr":[{"rounded-tr":ie()}],"rounded-br":[{"rounded-br":ie()}],"rounded-bl":[{"rounded-bl":ie()}],"border-w":[{border:ge()}],"border-w-x":[{"border-x":ge()}],"border-w-y":[{"border-y":ge()}],"border-w-s":[{"border-s":ge()}],"border-w-e":[{"border-e":ge()}],"border-w-t":[{"border-t":ge()}],"border-w-r":[{"border-r":ge()}],"border-w-b":[{"border-b":ge()}],"border-w-l":[{"border-l":ge()}],"divide-x":[{"divide-x":ge()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ge()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ke(),"hidden","none"]}],"divide-style":[{divide:[...ke(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...ke(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Me,pe,fe]}],"outline-w":[{outline:["",Me,$r,Vs]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",p,Oo,Lo]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",m,Oo,Lo]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:ge()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[Me,Vs]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":ge()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",y,Oo,Lo]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[Me,pe,fe]}],"mix-blend":[{"mix-blend":[...Ee(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ee()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Me]}],"mask-image-linear-from-pos":[{"mask-linear-from":oe()}],"mask-image-linear-to-pos":[{"mask-linear-to":oe()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":oe()}],"mask-image-t-to-pos":[{"mask-t-to":oe()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":oe()}],"mask-image-r-to-pos":[{"mask-r-to":oe()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":oe()}],"mask-image-b-to-pos":[{"mask-b-to":oe()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":oe()}],"mask-image-l-to-pos":[{"mask-l-to":oe()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":oe()}],"mask-image-x-to-pos":[{"mask-x-to":oe()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":oe()}],"mask-image-y-to-pos":[{"mask-y-to":oe()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[pe,fe]}],"mask-image-radial-from-pos":[{"mask-radial-from":oe()}],"mask-image-radial-to-pos":[{"mask-radial-to":oe()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[Me]}],"mask-image-conic-from-pos":[{"mask-conic-from":oe()}],"mask-image-conic-to-pos":[{"mask-conic-to":oe()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:se()}],"mask-size":[{mask:D()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",pe,fe]}],filter:[{filter:["","none",pe,fe]}],blur:[{blur:Ie()}],brightness:[{brightness:[Me,pe,fe]}],contrast:[{contrast:[Me,pe,fe]}],"drop-shadow":[{"drop-shadow":["","none",w,Oo,Lo]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",Me,pe,fe]}],"hue-rotate":[{"hue-rotate":[Me,pe,fe]}],invert:[{invert:["",Me,pe,fe]}],saturate:[{saturate:[Me,pe,fe]}],sepia:[{sepia:["",Me,pe,fe]}],"backdrop-filter":[{"backdrop-filter":["","none",pe,fe]}],"backdrop-blur":[{"backdrop-blur":Ie()}],"backdrop-brightness":[{"backdrop-brightness":[Me,pe,fe]}],"backdrop-contrast":[{"backdrop-contrast":[Me,pe,fe]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Me,pe,fe]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Me,pe,fe]}],"backdrop-invert":[{"backdrop-invert":["",Me,pe,fe]}],"backdrop-opacity":[{"backdrop-opacity":[Me,pe,fe]}],"backdrop-saturate":[{"backdrop-saturate":[Me,pe,fe]}],"backdrop-sepia":[{"backdrop-sepia":["",Me,pe,fe]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":L()}],"border-spacing-x":[{"border-spacing-x":L()}],"border-spacing-y":[{"border-spacing-y":L()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",pe,fe]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Me,"initial",pe,fe]}],ease:[{ease:["linear","initial",C,pe,fe]}],delay:[{delay:[Me,pe,fe]}],animate:[{animate:["none",k,pe,fe]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,pe,fe]}],"perspective-origin":[{"perspective-origin":R()}],rotate:[{rotate:Le()}],"rotate-x":[{"rotate-x":Le()}],"rotate-y":[{"rotate-y":Le()}],"rotate-z":[{"rotate-z":Le()}],scale:[{scale:ot()}],"scale-x":[{"scale-x":ot()}],"scale-y":[{"scale-y":ot()}],"scale-z":[{"scale-z":ot()}],"scale-3d":["scale-3d"],skew:[{skew:cn()}],"skew-x":[{"skew-x":cn()}],"skew-y":[{"skew-y":cn()}],transform:[{transform:[pe,fe,"","none","gpu","cpu"]}],"transform-origin":[{origin:R()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:_n()}],"translate-x":[{"translate-x":_n()}],"translate-y":[{"translate-y":_n()}],"translate-z":[{"translate-z":_n()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pe,fe]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pe,fe]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[Me,$r,Vs,Vu]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},jx=yx(Fx);function Mn(...o){return jx(ty(o))}const Bx=Hh("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function Ye({className:o,variant:e,size:t,asChild:n=!1,...i}){const a=n?Zg:"button";return x.jsx(a,{"data-slot":"button",className:Mn(Bx({variant:e,size:t,className:o})),...i})}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zx=o=>o.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),Wm=o=>{const e=zx(o);return e.charAt(0).toUpperCase()+e.slice(1)},py=(...o)=>o.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ux={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=ee.forwardRef(({color:o="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:l,...c},h)=>ee.createElement("svg",{ref:h,...Ux,width:e,height:e,stroke:o,strokeWidth:n?Number(t)*24/Number(e):t,className:py("lucide",i),...c},[...l.map(([d,p])=>ee.createElement(d,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=(o,e)=>{const t=ee.forwardRef(({className:n,...i},a)=>ee.createElement(Hx,{ref:a,iconNode:e,className:py(`lucide-${$x(Wm(o))}`,`lucide-${o}`,n),...i}));return t.displayName=Wm(o),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wx=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],la=Ge("arrow-left",Wx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Hi=Ge("arrow-right",Vx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],my=Ge("book-open",Gx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Xx=Ge("brain",qx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],gl=Ge("calendar",Kx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Qx=Ge("check",Yx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jx=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Zx=Ge("chevron-down",Jx);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],t_=Ge("chevron-up",e_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],s_=Ge("circle-alert",n_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],r_=Ge("circle-check",i_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],hh=Ge("clock",a_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],l_=Ge("download",o_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],u_=Ge("eye-off",c_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],gy=Ge("eye",h_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Vm=Ge("file-text",d_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],p_=Ge("graduation-cap",f_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Gm=Ge("info",m_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],yy=Ge("key",g_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Gu=Ge("loader-circle",y_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],qm=Ge("refresh-cw",v_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],b_=Ge("shield",w_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],tl=Ge("sparkles",x_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],A_=Ge("target",__);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],C_=Ge("trash-2",S_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],nl=Ge("upload",k_);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],T_=Ge("zap",E_);function P_({onNext:o}){return x.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:x.jsxs("div",{className:"max-w-4xl w-full mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[x.jsx("div",{className:"flex justify-center mb-8",children:x.jsx("div",{className:"bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 p-6 rounded-3xl shadow-2xl",children:x.jsx(p_,{className:"size-20 text-white"})})}),x.jsxs("div",{className:"space-y-4 mb-12",children:[x.jsx("h1",{className:"text-gray-900 leading-tight",children:"StudyPlanner"}),x.jsx("p",{className:"text-2xl text-gray-600 max-w-2xl mx-auto",children:"Plane dein Semester realistisch und effizient mit KI-Untersttzung"})]}),x.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-12 max-w-3xl mx-auto",children:[x.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100 transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 hover:scale-105 cursor-pointer",children:[x.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-4 rounded-xl mb-4 inline-flex transition-transform duration-300 hover:rotate-6",children:x.jsx(nl,{className:"size-8 text-white"})}),x.jsx("h3",{className:"text-gray-900 mb-2",children:"Module hochladen"}),x.jsx("p",{className:"text-sm text-gray-600",children:"Lade deine Modulbeschreibungen als PDFs hoch und extrahiere automatisch alle Daten"})]}),x.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100 transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 hover:scale-105 cursor-pointer",children:[x.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-4 rounded-xl mb-4 inline-flex transition-transform duration-300 hover:rotate-6",children:x.jsx(gl,{className:"size-8 text-white"})}),x.jsx("h3",{className:"text-gray-900 mb-2",children:"Wochenplan erstellen"}),x.jsx("p",{className:"text-sm text-gray-600",children:"Markiere deine verfgbaren Lernzeiten in einem visuellen Grid"})]}),x.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100 transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 hover:scale-105 cursor-pointer",children:[x.jsx("div",{className:"bg-gradient-to-br from-pink-500 to-pink-600 p-4 rounded-xl mb-4 inline-flex transition-transform duration-300 hover:rotate-6",children:x.jsx(Xx,{className:"size-8 text-white"})}),x.jsx("h3",{className:"text-gray-900 mb-2",children:"KI-Lernplan"}),x.jsx("p",{className:"text-sm text-gray-600",children:"Die KI whlt automatisch die beste Lernmethode fr jedes Modul"})]})]}),x.jsxs("div",{className:"flex justify-center gap-8 mb-12",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-2 rounded-lg",children:x.jsx(tl,{className:"size-5 text-white"})}),x.jsx("span",{className:"text-gray-700",children:"KI-gesttzt"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-2 rounded-lg",children:x.jsx(A_,{className:"size-5 text-white"})}),x.jsx("span",{className:"text-gray-700",children:"Realistisch"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:"bg-gradient-to-br from-pink-500 to-pink-600 p-2 rounded-lg",children:x.jsx(T_,{className:"size-5 text-white"})}),x.jsx("span",{className:"text-gray-700",children:"Effizient"})]})]}),x.jsxs(Ye,{size:"lg",onClick:o,className:"h-16 text-xl px-12 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-2xl hover:shadow-3xl transition-all",children:["Jetzt starten",x.jsx(Hi,{className:"size-6 ml-2"})]})]})})}function nt({className:o,...e}){return x.jsx("div",{"data-slot":"card",className:Mn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",o),...e})}function wn({className:o,...e}){return x.jsx("div",{"data-slot":"card-header",className:Mn("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",o),...e})}function Rn({className:o,...e}){return x.jsx("h4",{"data-slot":"card-title",className:Mn("leading-none",o),...e})}function rs({className:o,...e}){return x.jsx("p",{"data-slot":"card-description",className:Mn("text-muted-foreground",o),...e})}function At({className:o,...e}){return x.jsx("div",{"data-slot":"card-content",className:Mn("px-6 [&:last-child]:pb-6",o),...e})}function Mi({className:o,type:e,...t}){return x.jsx("input",{type:e,"data-slot":"input",className:Mn("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",o),...t})}Kg();var N_=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],R_=N_.reduce((o,e)=>{const t=Jg(`Primitive.${e}`),n=ee.forwardRef((i,a)=>{const{asChild:l,...c}=i,h=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(h,{...c,ref:a})});return n.displayName=`Primitive.${e}`,{...o,[e]:n}},{}),M_="Label",vy=ee.forwardRef((o,e)=>x.jsx(R_.label,{...o,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(o.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));vy.displayName=M_;var I_=vy;function sl({className:o,...e}){return x.jsx(I_,{"data-slot":"label",className:Mn("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",o),...e})}const D_=Hh("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function wy({className:o,variant:e,...t}){return x.jsx("div",{"data-slot":"alert",role:"alert",className:Mn(D_({variant:e}),o),...t})}function by({className:o,...e}){return x.jsx("div",{"data-slot":"alert-description",className:Mn("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",o),...e})}function L_({onNext:o,onBack:e,apiKey:t="",setApiKey:n}){const[i,a]=ee.useState(!1),l=()=>{if(!t){alert("Bitte gib deinen OpenAI API-Key ein, um fortzufahren.");return}o()};return x.jsx("div",{className:"min-h-screen flex items-center justify-center py-12",children:x.jsxs("div",{className:"max-w-2xl w-full mx-auto px-4 sm:px-6 lg:px-8",children:[x.jsxs(nt,{className:"border-2 border-blue-200 shadow-2xl",children:[x.jsxs(wn,{className:"bg-gradient-to-br from-blue-50 to-purple-50 border-b border-blue-100 text-center pb-8",children:[x.jsx("div",{className:"flex justify-center mb-4",children:x.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 p-4 rounded-2xl shadow-lg",children:x.jsx(yy,{className:"size-12 text-white"})})}),x.jsx(Rn,{className:"text-3xl mb-2",children:"OpenAI API-Key"}),x.jsx(rs,{className:"text-base",children:"Verbinde deinen OpenAI Account, um KI-gesttzte Lernplne zu erstellen"})]}),x.jsxs(At,{className:"space-y-6 pt-8",children:[x.jsxs(wy,{className:"border-blue-200 bg-blue-50",children:[x.jsx(b_,{className:"size-4 text-blue-600"}),x.jsxs(by,{children:[x.jsx("strong",{children:"Deine Daten bleiben sicher:"})," Der API-Key wird nur lokal gespeichert und direkt an OpenAI gesendet."]})]}),x.jsxs("div",{className:"space-y-3",children:[x.jsx(sl,{htmlFor:"api-key",className:"text-base text-gray-900",children:"OpenAI API-Key *"}),x.jsxs("div",{className:"relative",children:[x.jsx(Mi,{id:"api-key",type:i?"text":"password",placeholder:"sk-proj-...",value:t,onChange:c=>n?.(c.target.value),className:"h-14 pr-12 text-base"}),x.jsx(Ye,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 -translate-y-1/2 hover:bg-gray-100",onClick:()=>a(!i),children:i?x.jsx(u_,{className:"size-4"}):x.jsx(gy,{className:"size-4"})})]})]}),x.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[x.jsx("p",{className:"text-gray-900",children:x.jsx("strong",{children:"Wo finde ich meinen API-Key?"})}),x.jsxs("ol",{className:"space-y-3 ml-1",children:[x.jsxs("li",{className:"flex items-start gap-3",children:[x.jsx("span",{className:"bg-blue-600 text-white size-6 rounded-full flex items-center justify-center flex-shrink-0 text-sm mt-0.5",children:"1"}),x.jsxs("span",{className:"text-gray-700 pt-0.5",children:["Gehe zu"," ",x.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"platform.openai.com/api-keys"})]})]}),x.jsxs("li",{className:"flex items-start gap-3",children:[x.jsx("span",{className:"bg-blue-600 text-white size-6 rounded-full flex items-center justify-center flex-shrink-0 text-sm mt-0.5",children:"2"}),x.jsx("span",{className:"text-gray-700 pt-0.5",children:'Klicke auf "Create new secret key"'})]}),x.jsxs("li",{className:"flex items-start gap-3",children:[x.jsx("span",{className:"bg-blue-600 text-white size-6 rounded-full flex items-center justify-center flex-shrink-0 text-sm mt-0.5",children:"3"}),x.jsx("span",{className:"text-gray-700 pt-0.5",children:"Kopiere den Key und fge ihn oben ein"})]})]})]}),x.jsxs("div",{className:"flex gap-3 pt-4",children:[x.jsxs(Ye,{variant:"outline",size:"lg",onClick:e,className:"flex-1 h-14",children:[x.jsx(la,{className:"size-5 mr-2"}),"Zurck"]}),x.jsxs(Ye,{size:"lg",onClick:l,disabled:!t,className:"flex-1 h-14 text-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:["Weiter",x.jsx(Hi,{className:"size-5 ml-2"})]})]})]})]}),x.jsx("p",{className:"text-center text-sm text-gray-500 mt-6",children:"StudyPlanner nutzt GPT-4 fr die beste Planqualitt"})]})})}const O_=Hh("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function xy({className:o,variant:e,asChild:t=!1,...n}){const i=t?Zg:"span";return x.jsx(i,{"data-slot":"badge",className:Mn(O_({variant:e}),o),...n})}function F_(o,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(o?.(i),t===!1||!i.defaultPrevented)return e?.(i)}}function j_(o,e=[]){let t=[];function n(a,l){const c=ee.createContext(l),h=t.length;t=[...t,l];const d=m=>{const{scope:y,children:w,..._}=m,b=y?.[o]?.[h]||c,A=ee.useMemo(()=>_,Object.values(_));return x.jsx(b.Provider,{value:A,children:w})};d.displayName=a+"Provider";function p(m,y){const w=y?.[o]?.[h]||c,_=ee.useContext(w);if(_)return _;if(l!==void 0)return l;throw new Error(`\`${m}\` must be used within \`${a}\``)}return[d,p]}const i=()=>{const a=t.map(l=>ee.createContext(l));return function(c){const h=c?.[o]||a;return ee.useMemo(()=>({[`__scope${o}`]:{...c,[o]:h}}),[c,h])}};return i.scopeName=o,[n,B_(i,...e)]}function B_(...o){const e=o[0];if(o.length===1)return e;const t=()=>{const n=o.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(a){const l=n.reduce((c,{useScope:h,scopeName:d})=>{const m=h(a)[`__scope${d}`];return{...c,...m}},{});return ee.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}var ca=globalThis?.document?ee.useLayoutEffect:()=>{},$_=zh[" useInsertionEffect ".trim().toString()]||ca;function z_({prop:o,defaultProp:e,onChange:t=()=>{},caller:n}){const[i,a,l]=U_({defaultProp:e,onChange:t}),c=o!==void 0,h=c?o:i;{const p=ee.useRef(o!==void 0);ee.useEffect(()=>{const m=p.current;m!==c&&console.warn(`${n} is changing from ${m?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=c},[c,n])}const d=ee.useCallback(p=>{if(c){const m=H_(p)?p(o):p;m!==o&&l.current?.(m)}else a(p)},[c,o,a,l]);return[h,d]}function U_({defaultProp:o,onChange:e}){const[t,n]=ee.useState(o),i=ee.useRef(t),a=ee.useRef(e);return $_(()=>{a.current=e},[e]),ee.useEffect(()=>{i.current!==t&&(a.current?.(t),i.current=t)},[t,i]),[t,n,a]}function H_(o){return typeof o=="function"}function W_(o){const e=V_(o),t=ee.forwardRef((n,i)=>{const{children:a,...l}=n,c=ee.Children.toArray(a),h=c.find(q_);if(h){const d=h.props.children,p=c.map(m=>m===h?ee.Children.count(d)>1?ee.Children.only(null):ee.isValidElement(d)?d.props.children:null:m);return x.jsx(e,{...l,ref:i,children:ee.isValidElement(d)?ee.cloneElement(d,void 0,p):null})}return x.jsx(e,{...l,ref:i,children:a})});return t.displayName=`${o}.Slot`,t}function V_(o){const e=ee.forwardRef((t,n)=>{const{children:i,...a}=t;if(ee.isValidElement(i)){const l=K_(i),c=X_(a,i.props);return i.type!==ee.Fragment&&(c.ref=n?Uh(n,l):l),ee.cloneElement(i,c)}return ee.Children.count(i)>1?ee.Children.only(null):null});return e.displayName=`${o}.SlotClone`,e}var G_=Symbol("radix.slottable");function q_(o){return ee.isValidElement(o)&&typeof o.type=="function"&&"__radixId"in o.type&&o.type.__radixId===G_}function X_(o,e){const t={...e};for(const n in e){const i=o[n],a=e[n];/^on[A-Z]/.test(n)?i&&a?t[n]=(...c)=>{const h=a(...c);return i(...c),h}:i&&(t[n]=i):n==="style"?t[n]={...i,...a}:n==="className"&&(t[n]=[i,a].filter(Boolean).join(" "))}return{...o,...t}}function K_(o){let e=Object.getOwnPropertyDescriptor(o.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?o.ref:(e=Object.getOwnPropertyDescriptor(o,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?o.props.ref:o.props.ref||o.ref)}var Y_=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Vh=Y_.reduce((o,e)=>{const t=W_(`Primitive.${e}`),n=ee.forwardRef((i,a)=>{const{asChild:l,...c}=i,h=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(h,{...c,ref:a})});return n.displayName=`Primitive.${e}`,{...o,[e]:n}},{});function Q_(o,e){return ee.useReducer((t,n)=>e[t][n]??t,o)}var _y=o=>{const{present:e,children:t}=o,n=J_(e),i=typeof t=="function"?t({present:n.isPresent}):ee.Children.only(t),a=Yg(n.ref,Z_(i));return typeof t=="function"||n.isPresent?ee.cloneElement(i,{ref:a}):null};_y.displayName="Presence";function J_(o){const[e,t]=ee.useState(),n=ee.useRef(null),i=ee.useRef(o),a=ee.useRef("none"),l=o?"mounted":"unmounted",[c,h]=Q_(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return ee.useEffect(()=>{const d=Fo(n.current);a.current=c==="mounted"?d:"none"},[c]),ca(()=>{const d=n.current,p=i.current;if(p!==o){const y=a.current,w=Fo(d);o?h("MOUNT"):w==="none"||d?.display==="none"?h("UNMOUNT"):h(p&&y!==w?"ANIMATION_OUT":"UNMOUNT"),i.current=o}},[o,h]),ca(()=>{if(e){let d;const p=e.ownerDocument.defaultView??window,m=w=>{const b=Fo(n.current).includes(CSS.escape(w.animationName));if(w.target===e&&b&&(h("ANIMATION_END"),!i.current)){const A=e.style.animationFillMode;e.style.animationFillMode="forwards",d=p.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=A)})}},y=w=>{w.target===e&&(a.current=Fo(n.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",m),e.addEventListener("animationend",m),()=>{p.clearTimeout(d),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",m),e.removeEventListener("animationend",m)}}else h("ANIMATION_END")},[e,h]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:ee.useCallback(d=>{n.current=d?getComputedStyle(d):null,t(d)},[])}}function Fo(o){return o?.animationName||"none"}function Z_(o){let e=Object.getOwnPropertyDescriptor(o.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?o.ref:(e=Object.getOwnPropertyDescriptor(o,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?o.props.ref:o.props.ref||o.ref)}var eA=zh[" useId ".trim().toString()]||(()=>{}),tA=0;function nA(o){const[e,t]=ee.useState(eA());return ca(()=>{t(n=>n??String(tA++))},[o]),o||(e?`radix-${e}`:"")}var Pl="Collapsible",[sA]=j_(Pl),[iA,Gh]=sA(Pl),Ay=ee.forwardRef((o,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:i,disabled:a,onOpenChange:l,...c}=o,[h,d]=z_({prop:n,defaultProp:i??!1,onChange:l,caller:Pl});return x.jsx(iA,{scope:t,disabled:a,contentId:nA(),open:h,onOpenToggle:ee.useCallback(()=>d(p=>!p),[d]),children:x.jsx(Vh.div,{"data-state":Xh(h),"data-disabled":a?"":void 0,...c,ref:e})})});Ay.displayName=Pl;var Sy="CollapsibleTrigger",Cy=ee.forwardRef((o,e)=>{const{__scopeCollapsible:t,...n}=o,i=Gh(Sy,t);return x.jsx(Vh.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Xh(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...n,ref:e,onClick:F_(o.onClick,i.onOpenToggle)})});Cy.displayName=Sy;var qh="CollapsibleContent",ky=ee.forwardRef((o,e)=>{const{forceMount:t,...n}=o,i=Gh(qh,o.__scopeCollapsible);return x.jsx(_y,{present:t||i.open,children:({present:a})=>x.jsx(rA,{...n,ref:e,present:a})})});ky.displayName=qh;var rA=ee.forwardRef((o,e)=>{const{__scopeCollapsible:t,present:n,children:i,...a}=o,l=Gh(qh,t),[c,h]=ee.useState(n),d=ee.useRef(null),p=Yg(e,d),m=ee.useRef(0),y=m.current,w=ee.useRef(0),_=w.current,b=l.open||c,A=ee.useRef(b),C=ee.useRef(void 0);return ee.useEffect(()=>{const k=requestAnimationFrame(()=>A.current=!1);return()=>cancelAnimationFrame(k)},[]),ca(()=>{const k=d.current;if(k){C.current=C.current||{transitionDuration:k.style.transitionDuration,animationName:k.style.animationName},k.style.transitionDuration="0s",k.style.animationName="none";const E=k.getBoundingClientRect();m.current=E.height,w.current=E.width,A.current||(k.style.transitionDuration=C.current.transitionDuration,k.style.animationName=C.current.animationName),h(n)}},[l.open,n]),x.jsx(Vh.div,{"data-state":Xh(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!b,...a,ref:p,style:{"--radix-collapsible-content-height":y?`${y}px`:void 0,"--radix-collapsible-content-width":_?`${_}px`:void 0,...o.style},children:b&&i})});function Xh(o){return o?"open":"closed"}var aA=Ay;function oA({...o}){return x.jsx(aA,{"data-slot":"collapsible",...o})}function lA({...o}){return x.jsx(Cy,{"data-slot":"collapsible-trigger",...o})}function cA({...o}){return x.jsx(ky,{"data-slot":"collapsible-content",...o})}const Ut=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),dh=[.001,0,0,.001,0,0],qu=1.35,on={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ts={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ua="pdfjs_internal_editor_",Ne={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Oe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},uA={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},fh={TRIANGLES:1,LATTICE:2},kt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},il={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ut={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Ii={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Nl={ERRORS:0,WARNINGS:1,INFOS:5},ha={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},zr={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},hA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Rl=Nl.WARNINGS;function dA(o){Number.isInteger(o)&&(Rl=o)}function fA(){return Rl}function Ml(o){Rl>=Nl.INFOS&&console.info(`Info: ${o}`)}function Te(o){Rl>=Nl.WARNINGS&&console.warn(`Warning: ${o}`)}function We(o){throw new Error(o)}function Fe(o,e){o||We(e)}function pA(o){switch(o?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ey(o,e=null,t=null){if(!o)return null;if(t&&typeof o=="string"&&(t.addDefaultProtocol&&o.startsWith("www.")&&o.match(/\./g)?.length>=2&&(o=`http://${o}`),t.tryConvertEncoding))try{o=wA(o)}catch{}const n=e?URL.parse(o,e):URL.parse(o);return pA(n)?n:null}function Ty(o,e,t=!1){const n=URL.parse(o);return n?(n.hash=e,n.href):t&&Ey(o,"http://example.com")?o.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Pe(o,e,t,n=!1){return Object.defineProperty(o,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const ei=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class Xm extends ei{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Xu extends ei{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ph extends ei{constructor(e){super(e,"InvalidPDFException")}}class yl extends ei{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class mA extends ei{constructor(e){super(e,"FormatError")}}class Ps extends ei{constructor(e){super(e,"AbortException")}}function Py(o){(typeof o!="object"||o?.length===void 0)&&We("Invalid argument for bytesToString");const e=o.length,t=8192;if(e<t)return String.fromCharCode.apply(null,o);const n=[];for(let i=0;i<e;i+=t){const a=Math.min(i+t,e),l=o.subarray(i,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function ma(o){typeof o!="string"&&We("Invalid argument for stringToBytes");const e=o.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=o.charCodeAt(n)&255;return t}function gA(o){return String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255)}function yA(){const o=new Uint8Array(4);return o[0]=1,new Uint32Array(o.buffer,0,1)[0]===1}function vA(){try{return new Function(""),!0}catch{return!1}}class Mt{static get isLittleEndian(){return Pe(this,"isLittleEndian",yA())}static get isEvalSupported(){return Pe(this,"isEvalSupported",vA())}static get isOffscreenCanvasSupported(){return Pe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Pe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Pe(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Pe(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Pe(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Pe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Ku=Array.from(Array(256).keys(),o=>o.toString(16).padStart(2,"0"));class ue{static makeHexColor(e,t,n){return`#${Ku[e]}${Ku[t]}${Ku[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const i=e[n],a=e[n+1];e[n]=i*t[0]+a*t[2]+t[4],e[n+1]=i*t[1]+a*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const i=t[0],a=t[1],l=t[2],c=t[3],h=t[4],d=t[5];for(let p=0;p<6;p+=2){const m=e[n+p],y=e[n+p+1];e[n+p]=m*i+y*l+h,e[n+p+1]=m*a+y*c+d}}static applyInverseTransform(e,t){const n=e[0],i=e[1],a=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/a,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/a}static axialAlignedBoundingBox(e,t,n){const i=t[0],a=t[1],l=t[2],c=t[3],h=t[4],d=t[5],p=e[0],m=e[1],y=e[2],w=e[3];let _=i*p+h,b=_,A=i*y+h,C=A,k=c*m+d,E=k,P=c*w+d,R=P;if(a!==0||l!==0){const N=a*p,O=a*y,L=l*m,H=l*w;_+=L,C+=L,A+=H,b+=H,k+=N,R+=N,P+=O,E+=O}n[0]=Math.min(n[0],_,A,b,C),n[1]=Math.min(n[1],k,P,E,R),n[2]=Math.max(n[2],_,A,b,C),n[3]=Math.max(n[3],k,P,E,R)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],a=e[2],l=e[3],c=n**2+i**2,h=n*a+i*l,d=a**2+l**2,p=(c+d)/2,m=Math.sqrt(p**2-(c*d-h**2));t[0]=Math.sqrt(p+m||1),t[1]=Math.sqrt(p-m||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>l?null:[n,a,i,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,a){a[0]=Math.min(a[0],e,n),a[1]=Math.min(a[1],t,i),a[2]=Math.max(a[2],e,n),a[3]=Math.max(a[3],t,i)}static#e(e,t,n,i,a,l,c,h,d,p){if(d<=0||d>=1)return;const m=1-d,y=d*d,w=y*d,_=m*(m*(m*e+3*d*t)+3*y*n)+w*i,b=m*(m*(m*a+3*d*l)+3*y*c)+w*h;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],b),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],b)}static#t(e,t,n,i,a,l,c,h,d,p,m,y){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,n,i,a,l,c,h,-m/p,y);return}const w=p**2-4*m*d;if(w<0)return;const _=Math.sqrt(w),b=2*d;this.#e(e,t,n,i,a,l,c,h,(-p+_)/b,y),this.#e(e,t,n,i,a,l,c,h,(-p-_)/b,y)}static bezierBoundingBox(e,t,n,i,a,l,c,h,d){d[0]=Math.min(d[0],e,c),d[1]=Math.min(d[1],t,h),d[2]=Math.max(d[2],e,c),d[3]=Math.max(d[3],t,h),this.#t(e,n,a,c,t,i,l,h,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),d),this.#t(e,n,a,c,t,i,l,h,3*(-t+3*(i-l)+h),6*(t-2*i+l),3*(i-t),d)}}function wA(o){return decodeURIComponent(escape(o))}let Yu=null,Km=null;function bA(o){return Yu||(Yu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Km=new Map([["","t"]])),o.replaceAll(Yu,(e,t,n)=>t?t.normalize("NFKC"):Km.get(n))}function Ny(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const o=new Uint8Array(32);return crypto.getRandomValues(o),Py(o)}const Bi="pdfjs_internal_id_";function xA(o,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,i,...a]=t;if(!o(n)&&!Number.isInteger(n)||!e(i))return!1;const l=a.length;let c=!0;switch(i.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function Ht(o,e,t){return Math.min(Math.max(o,e),t)}function Ry(o){return Uint8Array.prototype.toBase64?o.toBase64():btoa(Py(o))}function _A(o){return Uint8Array.fromBase64?Uint8Array.fromBase64(o):ma(atob(o))}typeof Promise.try!="function"&&(Promise.try=function(o,...e){return new Promise(t=>{t(o(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(o){return o.reduce((e,t)=>e+t,0)});class da{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(a){if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(da.shouldBuildText(c))a?.attributes?.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&t.push({str:l}),!!a.children)for(const h of a.children)i(h)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class My{static setupStorage(e,t,n,i,a){const l=i.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{i.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:a}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${i}`);for(const[h,d]of Object.entries(l))if(d!=null)switch(h){case"class":d.length&&e.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,d)}c&&a.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,a=e.intent||"display",l=document.createElement(i.name);i.attributes&&this.setAttributes({html:l,element:i,intent:a,linkService:n});const c=a!=="richText",h=e.div;if(h.append(l),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=m}c&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);l.append(m),c&&da.shouldBuildText(i.name)&&d.push(m)}return{textDivs:d}}const p=[[i,-1,l]];for(;p.length>0;){const[m,y,w]=p.at(-1);if(y+1===m.children.length){p.pop();continue}const _=m.children[++p.at(-1)[1]];if(_===null)continue;const{name:b}=_;if(b==="#text"){const C=document.createTextNode(_.value);d.push(C),w.append(C);continue}const A=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,b):document.createElement(b);if(w.append(A),_.attributes&&this.setAttributes({html:A,element:_,storage:t,intent:a,linkService:n}),_.children?.length>0)p.push([_,-1,A]);else if(_.value){const C=document.createTextNode(_.value);c&&da.shouldBuildText(b)&&d.push(C),A.append(C)}}for(const m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ns="http://www.w3.org/2000/svg";class Xi{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ga(o,e="text"){if(qr(o,document.baseURI)){const t=await fetch(o);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",o,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class ya{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=l,n*=t;const h=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let p,m,y,w;switch(i%=360,i<0&&(i+=360),i){case 180:p=-1,m=0,y=0,w=1;break;case 90:p=0,m=1,y=1,w=0;break;case 270:p=0,m=-1,y=-1,w=0;break;case 0:p=1,m=0,y=0,w=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(y=-y,w=-w);let _,b,A,C;p===0?(_=Math.abs(d-e[1])*n+a,b=Math.abs(h-e[0])*n+l,A=(e[3]-e[1])*n,C=(e[2]-e[0])*n):(_=Math.abs(h-e[0])*n+a,b=Math.abs(d-e[1])*n+l,A=(e[2]-e[0])*n,C=(e[3]-e[1])*n),this.transform=[p*n,m*n,y*n,w*n,_-p*n*h-y*n*d,b-m*n*h-w*n*d],this.width=A,this.height=C}get rawDims(){const e=this.viewBox;return Pe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new ya({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){const n=[e,t];return ue.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];ue.applyTransform(t,this.transform);const n=[e[2],e[3]];return ue.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return ue.applyInverseTransform(n,this.transform),n}}class Kh extends ei{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Il(o){const e=o.length;let t=0;for(;t<e&&o[t].trim()==="";)t++;return o.substring(t,t+5).toLowerCase()==="data:"}function Yh(o){return typeof o=="string"&&/\.pdf$/i.test(o)}function AA(o){return[o]=o.split(/[#?]/,1),o.substring(o.lastIndexOf("/")+1)}function SA(o,e="document.pdf"){if(typeof o!="string")return e;if(Il(o))return Te('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(o);if(!n)return e;const i=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},a=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(a.test(l))return i(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const d of c)if(a.test(d))return i(d);const h=Array.from(n.searchParams.keys()).reverse();for(const d of h)if(a.test(d))return i(d)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return i(h[0])}return e}class Ym{started=Object.create(null);times=[];time(e){e in this.started&&Te(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Te(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:a}of this.times)e.push(`${n.padEnd(t)} ${a-i}ms
`);return e.join("")}}function qr(o,e){const t=e?URL.parse(o,e):URL.parse(o);return t?.protocol==="http:"||t?.protocol==="https:"}function xn(o){o.preventDefault()}function st(o){o.preventDefault(),o.stopPropagation()}function CA(o){console.log("Deprecated API usage: "+o)}class mh{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const d=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(l+=p,c+=m):d==="+"&&(l-=p,c-=m),new Date(Date.UTC(n,i,a,l,c,h))}}function kA(o,{scale:e=1,rotation:t=0}){const{width:n,height:i}=o.attributes.style,a=[0,0,parseInt(n),parseInt(i)];return new ya({viewBox:a,userUnit:1,scale:e,rotation:t})}function va(o){if(o.startsWith("#")){const e=parseInt(o.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return o.startsWith("rgb(")?o.slice(4,-1).split(",").map(e=>parseInt(e)):o.startsWith("rgba(")?o.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Te(`Not a valid color format: "${o}"`),[0,0,0])}function EA(o){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of o.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;o.set(t,va(n))}e.remove()}function Ze(o){const{a:e,b:t,c:n,d:i,e:a,f:l}=o.getTransform();return[e,t,n,i,a,l]}function jn(o){const{a:e,b:t,c:n,d:i,e:a,f:l}=o.getTransform().invertSelf();return[e,t,n,i,a,l]}function Qs(o,e,t=!1,n=!0){if(e instanceof ya){const{pageWidth:i,pageHeight:a}=e.rawDims,{style:l}=o,c=Mt.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,d=`var(--total-scale-factor) * ${a}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,m=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(l.width=p,l.height=m):(l.width=m,l.height=p)}n&&o.setAttribute("data-main-rotation",e.rotation)}class Vn{constructor(){const{pixelRatio:e}=Vn;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i,a=-1){let l=1/0,c=1/0,h=1/0;n=Vn.capPixels(n,a),n>0&&(l=Math.sqrt(n/(e*t))),i!==-1&&(c=i/e,h=i/t);const d=Math.min(l,c,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const gh=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class TA{static get isDarkMode(){return Pe(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class PA{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Pe(this,"commentForegroundColor",va(n))}}function NA(o,e,t,n){n=Math.min(Math.max(n??1,0),1);const i=255*(1-n);return o=Math.round(o*n+i),e=Math.round(e*n+i),t=Math.round(t*n+i),[o,e,t]}function Qm(o,e){const t=o[0]/255,n=o[1]/255,i=o[2]/255,a=Math.max(t,n,i),l=Math.min(t,n,i),c=(a+l)/2;if(a===l)e[0]=e[1]=0;else{const h=a-l;switch(e[1]=c<.5?h/(a+l):h/(2-a-l),a){case t:e[0]=((n-i)/h+(n<i?6:0))*60;break;case n:e[0]=((i-t)/h+2)*60;break;case i:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function yh(o,e){const t=o[0],n=o[1],i=o[2],a=(1-Math.abs(2*i-1))*n,l=a*(1-Math.abs(t/60%2-1)),c=i-a/2;switch(Math.floor(t/60)){case 0:e[0]=a+c,e[1]=l+c,e[2]=c;break;case 1:e[0]=l+c,e[1]=a+c,e[2]=c;break;case 2:e[0]=c,e[1]=a+c,e[2]=l+c;break;case 3:e[0]=c,e[1]=l+c,e[2]=a+c;break;case 4:e[0]=l+c,e[1]=c,e[2]=a+c;break;case 5:case 6:e[0]=a+c,e[1]=c,e[2]=l+c;break}}function Jm(o){return o<=.03928?o/12.92:((o+.055)/1.055)**2.4}function Zm(o,e,t){yh(o,t),t.map(Jm);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];yh(e,t),t.map(Jm);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}const eg=new Map;function RA(o,e){const t=o[0]+o[1]*256+o[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=eg.get(t);if(n)return n;const i=new Float32Array(9),a=i.subarray(0,3),l=i.subarray(3,6);Qm(o,l);const c=i.subarray(6,9);Qm(e,c);const h=c[2]<.5,d=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),Zm(l,c,a)<d){let p,m;h?(p=l[2],m=1):(p=0,m=l[2]);const y=.005;for(;m-p>y;){const w=l[2]=(p+m)/2;h===Zm(l,c,a)<d?p=w:m=w}l[2]=h?m:p}return yh(l,a),n=ue.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),eg.set(t,n),n}function Iy({html:o,dir:e,className:t},n){const i=document.createDocumentFragment();if(typeof o=="string"){const a=document.createElement("p");a.dir=e||"auto";const l=o.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const d=l[c];a.append(document.createTextNode(d)),c<h-1&&a.append(document.createElement("br"))}i.append(a)}else My.render({xfaHtml:o,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),n.append(i)}function Dy(o){const e=new Path2D;if(!o)return e;for(let t=0,n=o.length;t<n;)switch(o[t++]){case zr.moveTo:e.moveTo(o[t++],o[t++]);break;case zr.lineTo:e.lineTo(o[t++],o[t++]);break;case zr.curveTo:e.bezierCurveTo(o[t++],o[t++],o[t++],o[t++],o[t++],o[t++]);break;case zr.quadraticCurveTo:e.quadraticCurveTo(o[t++],o[t++],o[t++],o[t++]);break;case zr.closePath:e.closePath();break;default:Te(`Unrecognized drawing path operator: ${o[t-1]}`);break}return e}class ia{#e=null;#t=null;#s;#n=null;#a=null;#r=null;#i=null;#o=null;static#c=null;constructor(e){this.#s=e,ia.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",xn,{signal:t}),e.addEventListener("pointerdown",ia.#l,{signal:t}));const n=this.#n=document.createElement("div");n.className="buttons",e.append(n);const i=this.#s.toolbarPosition;if(i){const{style:a}=e,l=this.#s._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#d(e){this.#s._focusEventsAllowed=!1,st(e)}#h(e){this.#s._focusEventsAllowed=!0,st(e)}#f(e){const t=this.#s._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",xn,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#s,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",ia.#c[e]),this.#f(n)&&n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#n.append(n)}get#g(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#n.append(t,this.#g),this.#a=e}addComment(e,t=null){if(this.#r)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const i=this.#i=this.#g;t?(this.#n.insertBefore(n,t),this.#n.insertBefore(i,t)):this.#n.append(n,i),this.#r=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#n.append(t,this.#g)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#s);this.#f(t),this.#n.append(t,this.#g)}removeButton(e){switch(e){case"comment":this.#r?.removeToolbarCommentButton(),this.#r=null,this.#i?.remove(),this.#i=null;break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const i=this.#n.querySelector(n);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class MA{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#s._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",xn,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#s.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#s.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#s.highlightSelection("floating_button")}),e}#a(e,t){let n=0,i=0;for(const a of e){const l=a.y+a.height;if(l<n)continue;const c=a.x+(t?a.width:0);if(l>n){i=c,n=l;continue}t?c>i&&(i=c):c<i&&(i=c)}return[t?1-i:i,n]}show(e,t,n){const[i,a]=this.#a(t,n),{style:l}=this.#t||=this.#n();e.append(this.#t),l.insetInlineEnd=`${100*i}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#r(e,t,n,i){const a=document.createElement("button");a.classList.add("basic",e),a.tabIndex=0,a.setAttribute("data-l10n-id",t);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=this.#s._signal;c instanceof AbortSignal&&!c.aborted&&(a.addEventListener("contextmenu",xn,{signal:c}),a.addEventListener("click",i,{signal:c})),this.#e.append(a)}}function Ly(o,e,t){for(const n of t)e.addEventListener(n,o[n].bind(o))}class ze{static#e=NaN;static#t=null;static#s=NaN;static#n=null;static initializeAndAddPointerId(e){(ze.#t||=new Set).add(e)}static setPointer(e,t){ze.#e||=t,ze.#n??=e}static setTimeStamp(e){ze.#s=e}static isSamePointerId(e){return ze.#e===e}static isSamePointerIdOrRemove(e){return ze.#e===e?!0:(ze.#t?.delete(e),!1)}static isSamePointerType(e){return ze.#n===e}static isInitializedAndDifferentPointerType(e){return ze.#n!==null&&!ze.isSamePointerType(e)}static isSameTimeStamp(e){return ze.#s===e}static isUsingMultiplePointers(){return ze.#t?.size>=1}static clearPointerType(){ze.#n=null}static clearPointerIds(){ze.#e=NaN,ze.#t=null}static clearTimeStamp(){ze.#s=NaN}}class IA{#e=0;get id(){return`${ua}${this.#e++}`}}class Qh{#e=Ny();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const a=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Pe(this,"_isSVGFittingCanvas",a)}async#n(e,t){this.#s||=new Map;let n=this.#s.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(n.url=t,i=await ga(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const a=Qh._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((d,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,d()},l.onload=async()=>{const m=n.svgUrl=l.result;c.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=l.onerror=p});l.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){Te(i),n=null}return this.#s.set(e,n),n&&this.#s.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:i,type:a}=e;return this.#n(`${t}_${n}_${i}_${a}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const n=await t;return this.#n(e,n)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let n=this.#s.get(e);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,n),this.#s.set(n.id,n),n}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class DA{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(i&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:a};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(l&&this.#e[this.#n].type===a){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const d=this.#n+1;d===this.#s?this.#e.splice(0,1):(this.#n=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class wa{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Mt.platform;for(const[n,i,a={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:i,options:a}),this.allKeys.add(l.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:i,options:{bubbles:a=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(i.bind(e,...l,t)(),a||st(t))}}class Jh{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return EA(e),Pe(this,"_colors",e)}convert(e){const t=va(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((a,l)=>a===t[l]))return Jh._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?ue.makeHexColor(...t):e}}class Ns{#e=new AbortController;#t=null;#s=null;#n=new Map;#a=new Map;#r=null;#i=null;#o=null;#c=new DA;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#w=!1;#v=!1;#C=null;#A=null;#x=null;#E=null;#b=!1;#S=null;#N=new IA;#T=!1;#P=!1;#F=!1;#M=null;#D=null;#j=null;#L=null;#W=null;#k=Ne.NONE;#_=new Set;#I=null;#B=null;#z=null;#q=null;#G=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#U=[0,0];#O=null;#V=null;#J=null;#Z=null;#$=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Ns.prototype,t=l=>l.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Pe(this,"_keyboardManager",new wa([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#V.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,n,i,a,l,c,h,d,p,m,y,w,_,b,A){const C=this._signal=this.#e.signal;this.#V=e,this.#J=t,this.#Z=n,this.#r=i,this.#l=a,this.#B=l,this.#G=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:C}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:C}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:C}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:C}),c._on("setpreference",this.onSetPreference.bind(this),{signal:C}),c._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:C}),window.addEventListener("pointerdown",()=>{this.#P=!0},{capture:!0,signal:C}),window.addEventListener("pointerup",()=>{this.#P=!1},{capture:!0,signal:C}),this.#ae(),this.#de(),this.#te(),this.#i=h.annotationStorage,this.#C=h.filterFactory,this.#z=d,this.#E=p||null,this.#y=m,this.#w=y,this.#v=w,this.#W=_||null,this.viewParameters={realScale:Xi.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=A!==!1,a?.setSidebarUiManager(this)}destroy(){this.#$?.resolve(),this.#$=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#a.values())e.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#L?.clear(),this.#t=null,this.#_.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#B?.destroy(),this.#S?.hide(),this.#S=null,this.#j?.destroy(),this.#j=null,this.#s=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#O&&(clearTimeout(this.#O),this.#O=null),this._editorUndoBar?.destroy(),this.#G=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#W}get useNewAltTextFlow(){return this.#w}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Pe(this,"hcmFilter",this.#z?this.#C.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Pe(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Pe(this,"_highlightColors",this.#E?new Map(this.#E.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Pe(this,"highlightColors",null);const t=new Map,n=!!this.#z;for(const[i,a]of e){const l=i.endsWith("_HCM");if(n&&l){t.set(i.replace("_HCM",""),a);continue}!n&&!l&&t.set(i,a)}return Pe(this,"highlightColors",t)}get highlightColorNames(){return Pe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=e}setMainHighlightColorPicker(e){this.#j=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,i){this.#l?.showDialog(this,e,t,n,i)}selectComment(e,t){this.#a.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#a.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=a=>{a.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){this.#B?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#B}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#v=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#V.focus()}findParent(e,t){for(const n of this.#a.values()){const{x:i,y:a,width:l,height:c}=n.div.getBoundingClientRect();if(e>=i&&e<=i+l&&t>=a&&t<=a+c)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Xi.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#a.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:a,focusNode:l,focusOffset:c}=n,h=n.toString(),p=this.#Q(n).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;n.empty();const y=this.#ee(p),w=this.#k===Ne.NONE,_=()=>{const b=y?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:i,anchorOffset:a,focusNode:l,focusOffset:c,text:h});w&&this.showAllEditors("highlight",!0,!0),t&&b?.editComment()};if(w){this.switchToMode(Ne.HIGHLIGHT,_);return}_()}commentSelection(e=""){this.highlightSelection(e,!0)}#ie(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Q(e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(this.#S||=new MA(this),this.#S.show(n,i,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#i)return null;const t=`${ua}${e}`,n=this.#i.getRawValue(t);return n&&this.#i.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#I&&(this.#S?.hide(),this.#I=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#I)return;const i=this.#Q(e).closest(".textLayer");if(!i){this.#I&&(this.#S?.hide(),this.#I=null,this.#R({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#I=t,this.#R({hasSelectedText:!0}),!(this.#k!==Ne.HIGHLIGHT&&this.#k!==Ne.NONE)&&(this.#k===Ne.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#b=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#k===Ne.HIGHLIGHT?this.#ee(i):null;if(a?.toggleDrawing(),this.#P){const l=new AbortController,c=this.combinedSignal(l),h=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),a?.toggleDrawing(!0),d.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else a?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(e=""){this.#k===Ne.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#ie()}#ae(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#oe(){if(this.#x)return;this.#x=new AbortController;const e=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#_)if(t.div.contains(e)){this.#D=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#D)return;const[e,t]=this.#D;this.#D=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#M)return;this.#M=new AbortController;const e=this.combinedSignal(this.#M);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#M?.abort(),this.#M=null}#ue(){if(this.#d)return;this.#d=new AbortController;const e=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#he(){this.#d?.abort(),this.#d=null}#de(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#_){const i=n.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Te(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const h of n){const d=await i.deserialize(h);if(!d)return;a.push(d)}const l=()=>{for(const h of a)this.#ne(h);this.#se(a)},c=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){Te(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#k!==Ne.NONE&&!this.isEditorHandlingKeyboard&&Ns._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#K("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#R(e){Object.entries(e).some(([n,i])=>this.#X[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,e)}),this.#k===Ne.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#H([[Oe.HIGHLIGHT_FREE,!0]]))}#H(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#ue(),this.#R({isEditing:this.#k!==Ne.NONE,isEmpty:this.#Y(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#he(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#H(t.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(e){return this.#a.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#a.set(e.pageIndex,e),this.#T?e.enable():e.disable()}removeLayer(e){this.#a.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,i=!1,a=!1){if(this.#k!==e&&!(this.#$&&(await this.#$.promise,!this.#$))){if(this.#$=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#k===Ne.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#k=e,e===Ne.NONE){this.setEditingState(!1),this.#pe();for(const l of this.#n.values())l.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#$.resolve();return}for(const l of this.#n.values())l.addStandaloneCommentButton();e===Ne.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const l of this.#a.values())l.updateMode(e);if(e===Ne.POPUP){this.#s||=await this.#G.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const l=new Set,c=[];for(const h of this.#n.values()){const{annotationElementId:d,hasComment:p,deleted:m}=h;d&&l.add(d),p&&!m&&c.push(h.getData())}for(const h of this.#s){const{id:d,popupRef:p,contentsObj:m}=h;p&&m?.str&&!l.has(d)&&!this.#g.has(d)&&c.push(h)}this.#l?.showSidebar(c)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#$.resolve();return}for(const l of this.#n.values())l.uid===t?(this.setSelected(l),a?l.editComment():i?l.enterInEditMode():l.focus()):l.unselect();this.#$.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#k&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case Oe.CREATE:this.currentLayer.addNewEditor(t);return;case Oe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#_)n.updateParams(e,t);else for(const n of this.#u)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const a of this.#n.values())a.editorType===e&&a.show(t);(this.#q?.get(Oe.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#H([[Oe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#F!==e){this.#F=e;for(const t of this.#a.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#T){this.#T=!0;const e=[];for(const t of this.#a.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#pe(){if(this.unselectAll(),this.#T){this.#T=!1;for(const e of this.#a.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#L?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#g.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#g.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#g.has(e)}removeDeletedAnnotationElement(e){this.#g.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#a.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#H(e.propertiesToUpdate))}get#me(){let e=null;for(e of this.#_);return e}updateUI(e){this.#me===e&&this.#H(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#H(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#_.has(e)){this.#_.delete(e),e.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#_.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#h?.commitOrRemove();for(const t of this.#_)t!==e&&t.unselect();this.#_.clear(),this.#_.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(e){return this.#_.has(e)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(e){e.unselect(),this.#_.delete(e),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#R({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Y()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Y()})}addCommands(e){this.#c.add(e),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Y()})}cleanUndoStack(e){this.#c.cleanType(e)}#Y(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#_],n=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const a of t)this.#ne(a)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#se(e){for(const t of this.#_)t.unselect();this.#_.clear();for(const t of e)t.isEmpty()||(this.#_.add(t),t.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#_)e.commit();this.#se(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#k!==Ne.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const e of this.#_)e.unselect();this.#_.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#U[0]+=e,this.#U[1]+=t;const[i,a]=this.#U,l=[...this.#_],c=1e3;this.#O&&clearTimeout(this.#O),this.#O=setTimeout(()=>{this.#O=null,this.#U[0]=this.#U[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(i,a),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-i,-a),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const e of this.#_)this.#m.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const e=this.#m;this.#m=null;let t=!1;for(const[{x:i,y:a,pageIndex:l},c]of e)c.newX=i,c.newY=a,c.newPageIndex=l,t||=i!==c.savedX||a!==c.savedY||l!==c.savedPageIndex;if(!t)return!1;const n=(i,a,l,c)=>{if(this.#n.has(i.id)){const h=this.#a.get(c);h?i._setParentAndPosition(h,a,l):(i.pageIndex=c,i.x=a,i.y=l)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:l,newPageIndex:c}]of e)n(i,a,l,c)},undo:()=>{for(const[i,{savedX:a,savedY:l,savedPageIndex:c}]of e)n(i,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#m)for(const n of this.#m.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#k}isEditingMode(){return this.#k!==Ne.NONE}get imageManager(){return Pe(this,"imageManager",new Qh)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,p=t.rangeCount;d<p;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:i,width:a,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(d,p,m,y)=>({x:(p-i)/l,y:1-(d+m-n)/a,width:y/l,height:m/a});break;case"180":c=(d,p,m,y)=>({x:1-(d+m-n)/a,y:1-(p+y-i)/l,width:m/a,height:y/l});break;case"270":c=(d,p,m,y)=>({x:1-(p+y-i)/l,y:(d-n)/a,width:y/l,height:m/a});break;default:c=(d,p,m,y)=>({x:(d-n)/a,y:(p-i)/l,width:m/a,height:y/l});break}const h=[];for(let d=0,p=t.rangeCount;d<p;d++){const m=t.getRangeAt(d);if(!m.collapsed)for(const{x:y,y:w,width:_,height:b}of m.getClientRects())_===0||b===0||h.push(c(y,w,_,b))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#i.getRawValue(t);n&&(this.#k===Ne.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const i=this.#L?.get(e);i&&(i.setCanvas(t,n),this.#L.delete(e))}addMissingCanvas(e,t){(this.#L||=new Map).set(e,t)}}class Un{#e=null;#t=!1;#s=null;#n=null;#a=null;#r=null;#i=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#h=e._uiManager.useNewAltTextFlow,Un.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Un._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#h?(e.classList.add("new"),e.setAttribute("data-l10n-id",Un.#f.missing),t.setAttribute("data-l10n-id",Un.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",xn,{signal:n}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#i=!0,i(a))},{signal:n}),await this.#m(),e}get#g(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#i}),this.#i=!1)}isEmpty(){return this.#h?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#h?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#d=await Un._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#m())}toggleAltTextBadge(e=!1){if(!this.#h||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#d),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:a=!1}){n&&(this.#l=n,this.#d=i),!(this.#e===e&&this.#t===t)&&(a||(this.#e=e,this.#t=t),this.#m())}toggle(e=!1){this.#s&&(!e&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#m(){const e=this.#s;if(!e)return;if(this.#h){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Un.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",Un.#f[`${this.#g}-label`]),!this.#e){this.#a?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#a?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#a;if(!t){this.#a=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const i=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:a}),e.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:a})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class jo{#e=null;#t=null;#s=!1;#n=null;#a=null;#r=null;#i=null;#o=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#d(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=this.#n.commentButtonColor;i&&(n.backgroundColor=i)}return this.#d(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:i,y:a,width:l,height:c}=this.#n.parent.boundingClientRect;return[(e-i)/l,(t+n-a)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#d(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",xn,{signal:n}),t&&(e.addEventListener("focusin",a=>{this.#n._focusEventsAllowed=!1,st(a)},{capture:!0,signal:n}),e.addEventListener("focusout",a=>{this.#n._focusEventsAllowed=!0,st(a)},{capture:!0,signal:n})),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const i=a=>{a.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#s=!0,i(a))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=this.#n.commentButtonPosition;const{width:p,height:m,x:y,y:w}=this.#n;n=y+n*p,i=w+i*m}const a=this.#n.parent.boundingClientRect,{x:l,y:c,width:h,height:d}=a;this.#n._uiManager.editComment(this.#n,l+n*h,c+i*d,{...e,parentDimensions:a})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#s}),this.#s=!1)}isDeleted(){return this.#c||this.#i===""}isEmpty(){return this.#i===null}hasBeenEdited(){return this.isDeleted()||this.#i!==this.#a}serialize(){return this.data}get data(){return{text:this.#i,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#i&&(this.#r=null),e===null){this.#i="",this.#c=!0;return}this.#i=e,this.#o=new Date,this.#c=!1}setInitialText(e,t=null){this.#a=e,this.data=e,this.#o=null,this.#r=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#i="",this.#r=null,this.#o=null,this.#n=null,this.#s=!1,this.#c=!1}}class Dl{#e;#t=!1;#s=null;#n;#a;#r;#i;#o=null;#c;#l=null;#d;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){this.#e=e,this.#s=n,this.#n=t,this.#a=i,this.#r=a,this.#i=l,this.#d=new AbortController,this.#c=AbortSignal.any([c,this.#d.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Vn.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,a=AbortSignal.any([this.#c,i.signal]),l=this.#e,c={capture:!0,signal:a,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(st(d),h(d))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#h){this.#h=new AbortController;const i=AbortSignal.any([this.#c,this.#h.signal]),a=this.#e,l={signal:i,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),l);const c=this.#m.bind(this);a.addEventListener("touchend",c,l),a.addEventListener("touchcancel",c,l),l.capture=!0,a.addEventListener("pointerdown",st,l),a.addEventListener("pointermove",st,l),a.addEventListener("pointercancel",st,l),a.addEventListener("pointerup",st,l),this.#a?.()}if(st(e),e.touches.length!==2||this.#s?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(e){if(!this.#l||e.touches.length!==2)return;st(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:a}=t,{screenX:l,screenY:c}=n,h=this.#l,{touch0X:d,touch0Y:p,touch1X:m,touch1Y:y}=h,w=m-d,_=y-p,b=l-i,A=c-a,C=Math.hypot(b,A)||1,k=Math.hypot(w,_)||1;if(!this.#t&&Math.abs(k-C)<=Dl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=a,h.touch1X=l,h.touch1Y=c,!this.#t){this.#t=!0;return}const E=[(i+l)/2,(a+c)/2];this.#r?.(E,k,C)}#m(e){e.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#i?.()),this.#l&&(st(e),this.#l=null,this.#t=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class we{#e=null;#t=null;#s=null;#n=null;#a=null;#r=!1;#i=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#w=!1;#v=null;#C=0;#A=0;#x=null;#E=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#b=!1;#S=we._zIndex++;static _borderLineWidth=-1;static _colorManager=new Jh;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=we.prototype._resizeWithKeyboard,t=Ns.TRANSLATE_SMALL,n=Ns.TRANSLATE_BIG;return Pe(this,"_resizerKeyboardManager",new wa([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],we.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[a,l];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Pe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new LA({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(we._l10n??=e,we._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),we._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);we._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){We("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#b}set _isDraggable(e){this.#b=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#O(),this.#h?.remove(),this.#h=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[a,l]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/a,this.y=(t+i)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}#N([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#N(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,a]}=this;if(this.x+=e/i,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,d]=this.getBaseTranslation();l+=h,c+=d;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=we,i=n/e,a=n/t;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:a,y:l,width:c,height:h}=this;if(c*=n,h*=i,a*=n,l*=i,this._mustFixPosition)switch(e){case 0:a=Ht(a,0,n-c),l=Ht(l,0,i-h);break;case 90:a=Ht(a,0,n-h),l=Ht(l,c,i);break;case 180:a=Ht(a,c,n),l=Ht(l,h,i);break;case 270:a=Ht(a,h,n),l=Ht(l,0,i-c);break}this.x=a/=n,this.y=l/=i;const[d,p]=this.getBaseTranslation();a+=d,l+=p,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#T(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return we.#T(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return we.#T(e,t,360-this.parentRotation)}#P(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#F(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");this.#c.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#M.bind(this,n),{signal:t}),i.addEventListener("contextmenu",xn,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#c)}#M(e,t){t.preventDefault();const{isMac:n}=Mt.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#s?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",st,{passive:!1,signal:l}),window.addEventListener("contextmenu",xn,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#j()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#D(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#j(){if(!this.#d)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=this.#d;this.#d=null;const a=this.x,l=this.y,c=this.width,h=this.height;a===e&&l===t&&c===n&&h===i||this.addCommands({cmd:this.#D.bind(this,a,l,c,h),undo:this.#D.bind(this,e,t,n,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#L(e,t){const[n,i]=this.parentDimensions,a=this.x,l=this.y,c=this.width,h=this.height,d=we.MIN_SIZE/n,p=we.MIN_SIZE/i,m=this.#P(this.rotation),y=(J,K)=>[m[0]*J+m[2]*K,m[1]*J+m[3]*K],w=this.#P(360-this.rotation),_=(J,K)=>[w[0]*J+w[2]*K,w[1]*J+w[3]*K];let b,A,C=!1,k=!1;switch(e){case"topLeft":C=!0,b=(J,K)=>[0,0],A=(J,K)=>[J,K];break;case"topMiddle":b=(J,K)=>[J/2,0],A=(J,K)=>[J/2,K];break;case"topRight":C=!0,b=(J,K)=>[J,0],A=(J,K)=>[0,K];break;case"middleRight":k=!0,b=(J,K)=>[J,K/2],A=(J,K)=>[0,K/2];break;case"bottomRight":C=!0,b=(J,K)=>[J,K],A=(J,K)=>[0,0];break;case"bottomMiddle":b=(J,K)=>[J/2,K],A=(J,K)=>[J/2,0];break;case"bottomLeft":C=!0,b=(J,K)=>[0,K],A=(J,K)=>[J,0];break;case"middleLeft":k=!0,b=(J,K)=>[0,K/2],A=(J,K)=>[J,K/2];break}const E=b(c,h),P=A(c,h);let R=y(...P);const N=we._round(a+R[0]),O=we._round(l+R[1]);let L=1,H=1,V,q;if(t.fromKeyboard)({deltaX:V,deltaY:q}=t);else{const{screenX:J,screenY:K}=t,[j,ne]=this.#l;[V,q]=this.screenToPageTranslation(J-j,K-ne),this.#l[0]=J,this.#l[1]=K}if([V,q]=_(V/n,q/i),C){const J=Math.hypot(c,h);L=H=Math.max(Math.min(Math.hypot(P[0]-E[0]-V,P[1]-E[1]-q)/J,1/c,1/h),d/c,p/h)}else k?L=Ht(Math.abs(P[0]-E[0]-V),d,1)/c:H=Ht(Math.abs(P[1]-E[1]-q),p,1)/h;const xe=we._round(c*L),X=we._round(h*H);R=y(...A(xe,X));const re=N-R[0],te=O-R[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=xe,this.height=X,this.x=re,this.y=te,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new ia(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#s?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#s||(Un.initialize(we._l10n),this.#s=new Un(this),this.#e&&(this.#s.data=this.#e,this.#e=null)),this.#s}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new jo(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:i}}=this.#n;return{text:t,richText:e,date:n,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new jo(this),this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#n||=new jo(this),this.#n.setInitialText(e,n),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new jo(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,c=l+a+1,h=i-100,d=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,d,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#r?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#z();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[i,a]=this.getInitialTranslation();return this.translate(i,a),Ly(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#E||=new Dl({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#W.bind(this),onPinching:this.#k.bind(this),onPinchEnd:this.#_.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#W(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#k(e,t,n){let a=.7*(n/t)+1-.7;if(a===1)return;const l=this.#P(this.rotation),c=(N,O)=>[l[0]*N+l[2]*O,l[1]*N+l[3]*O],[h,d]=this.parentDimensions,p=this.x,m=this.y,y=this.width,w=this.height,_=we.MIN_SIZE/h,b=we.MIN_SIZE/d;a=Math.max(Math.min(a,1/y,1/w),_/y,b/w);const A=we._round(y*a),C=we._round(w*a);if(A===y&&C===w)return;this.#u||=[p,m,y,w];const k=c(y/2,w/2),E=we._round(p+k[0]),P=we._round(m+k[1]),R=c(A/2,C/2);this.x=E-R[0],this.y=P-R[1],this.width=A,this.height=C,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#_(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#j()}pointerdown(e){const{isMac:t}=Mt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#B(e);return}this.#I(e)}#I(e){const{isMac:t}=Mt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#B(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),l={capture:!0,passive:!1,signal:a},c=d=>{i.abort(),this.#i=null,this.#m=!1,this._uiManager.endDragSession()||this.#I(d),n&&this._onStopDragging()};t&&(this.#C=e.clientX,this.#A=e.clientY,this.#i=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:m,pointerId:y}=d;if(y!==this.#i){st(d);return}const[w,_]=this.screenToPageTranslation(p-this.#C,m-this.#A);this.#C=p,this.#A=m,this._uiManager.dragSelectedEditors(w,_)},l),window.addEventListener("touchmove",st,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#E||d.isPrimary)&&c(d),st(d)},l));const h=d=>{if(!this.#i||this.#i===d.pointerId){c(d);return}st(d)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[a,l]=this.pageDimensions,[c,h]=this.pageTranslation,d=e/i,p=t/i,m=this.x*a,y=this.y*l,w=this.width*a,_=this.height*l;switch(n){case 0:return[m+d+c,l-y-p-_+h,m+d+w+c,l-y-p+h];case 90:return[m+p+c,l-y+d+h,m+p+_+c,l-y+d+w+h];case 180:return[m-d-w+c,l-y+p+h,m-d+c,l-y+p+_+h];case 270:return[m-p-_+c,l-y-d-w+h,m-p+c,l-y-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,a,l]=e,c=a-n,h=l-i;switch(this.rotation){case 0:return[n,t-l,c,h];case 90:return[n,t-i,h,c];case 180:return[a,t-i,c,h];case 270:return[a,t-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&we._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:a,richText:l},uid:c,pageIndex:h,creationDate:d,modificationDate:p}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:d,modificationDate:n||p,popupRef:!a,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#w}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return t<l&&i>0&&e<a&&n>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#z()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[a,l]=i.pageDimensions,[c,h,d,p]=i.getRectInCurrentCoords(e.rect,l);return i.x=c/a,i.y=h/l,i.width=d/a,i.height=p/l,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#O(),this.removeEditToolbar(),this.#x){for(const e of this.#x.values())clearTimeout(e);this.#x=null}this.parent=null,this.#E?.destroy(),this.#E=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#F(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,a,l]=this.getPDFRect();return[we._round(n+(a-n)*e),we._round(i+(l-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const l=this.#q.bind(this),c=this.#G.bind(this),h=this._uiManager._signal;for(const d of this.#t){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:h}),d.addEventListener("blur",c,{signal:h}),d.addEventListener("focus",this.#X.bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",we._l10nResizer[p])}}const n=this.#t[0];let i=0;for(const l of t){if(l===n)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(a!==i){if(a<i)for(let c=0;c<i-a;c++)this.#c.append(this.#c.firstElementChild);else if(a>i)for(let c=0;c<a-i;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const c of t){const d=this.#t[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",we._l10nResizer[d])}}this.#U(0),this.#w=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#q(e){we._resizerKeyboardManager.exec(this,e)}#G(e){this.#w&&e.relatedTarget?.parentNode!==this.#c&&this.#O()}#X(e){this.#g=this.#w?e:""}#U(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#w&&this.#L(this.#g,{deltaX:e,deltaY:t,fromKeyboard:!0})}#O(){this.#w=!1,this.#U(-1),this.#j()}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#x||=new Map;const{action:n}=e;let i=this.#x.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#x.delete(n),this.#x.size===0&&(this.#x=null)},we._telemetryTimeout),this.#x.set(n,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(e){if(!this.#h&&!this.deleted){this.#h=e.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class LA extends we{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const tg=3285377520,gn=4294901760,Bn=65535;class Oy{constructor(e){this.h1=e?e&4294967295:tg,this.h2=e?e&4294967295:tg}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let b=0,A=e.length;b<A;b++){const C=e.charCodeAt(b);C<=255?t[n++]=C:(t[n++]=C>>>8,t[n++]=C&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,a=n-i*4,l=new Uint32Array(t.buffer,0,i);let c=0,h=0,d=this.h1,p=this.h2;const m=3432918353,y=461845907,w=m&Bn,_=y&Bn;for(let b=0;b<i;b++)b&1?(c=l[b],c=c*m&gn|c*w&Bn,c=c<<15|c>>>17,c=c*y&gn|c*_&Bn,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(h=l[b],h=h*m&gn|h*w&Bn,h=h<<15|h>>>17,h=h*y&gn|h*_&Bn,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=t[i*4+2]<<16;case 2:c^=t[i*4+1]<<8;case 1:c^=t[i*4],c=c*m&gn|c*w&Bn,c=c<<15|c>>>17,c=c*y&gn|c*_&Bn,i&1?d^=c:p^=c}this.h1=d,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&gn|e*36045&Bn,t=t*4283543511&gn|((t<<16|e>>>16)*2950163797&gn)>>>16,e^=t>>>1,e=e*444984403&gn|e*60499&Bn,t=t*3301882366&gn|((t<<16|e>>>16)*3120437893&gn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const vh=Object.freeze({map:null,hash:"",transfer:void 0});class Zh{#e=!1;#t=null;#s=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof we&&this.#s.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof we)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let i=!1;if(n!==void 0)for(const[a,l]of Object.entries(t))n[a]!==l&&(i=!0,n[a]=l);else i=!0,this.#n.set(e,t);i&&this.#a(),t instanceof we&&((this.#s||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#a(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Fy(this)}get serializable(){if(this.#n.size===0)return vh;const e=new Map,t=new Oy,n=[],i=Object.create(null);let a=!1;for(const[l,c]of this.#n){const h=c instanceof we?c.serialize(!1,i):c;h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:vh}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const a of this.#n.values()){if(!(a instanceof we)){a.popup&&(a.popup.deleted?i+=1:n+=1);continue}a.isCommentDeleted?i+=1:a.hasEditedComment&&(n+=1);const l=a.telemetryFinalData;if(!l)continue;const{type:c}=l;t.has(c)||t.set(c,Object.getPrototypeOf(a).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[d,p]of Object.entries(l)){if(d==="type")continue;let m=h.get(d);m||(m=new Map,h.set(d,m));const y=m.get(p)??0;m.set(p,y+1)}}if((i>0||n>0)&&(e||=Object.create(null),e.comments={deleted:i,edited:n}),!e)return null;for(const[a,l]of t)e[a]=l.computeTelemetryFinalData(e[a]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#s?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#s?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#s)for(const t of this.#s.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Fy extends Zh{#e;constructor(e){super();const{map:t,hash:n,transfer:i}=e.serializable,a=structuredClone(t,i?{transfer:i}:null);this.#e={map:a,hash:n,transfer:i}}get print(){We("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Pe(this,"modifiedIds",{ids:new Set,hash:""})}}class OA{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(Fe(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:a,style:l}=e,c=new FontFace(i,a,l);this.addNativeFontFace(c);try{await c.load(),this.#e.add(i),n?.(e)}catch{Te(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}We("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw Te(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Pe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Pe(this,"isSyncFontLoadingSupported",Ut||Mt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Fe(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Pe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(P,R){return P.charCodeAt(R)<<24|P.charCodeAt(R+1)<<16|P.charCodeAt(R+2)<<8|P.charCodeAt(R+3)&255}function i(P,R,N,O){const L=P.substring(0,R),H=P.substring(R+N);return L+O+H}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let d=0;function p(P,R){if(++d>30){Te("Load test font never loaded."),R();return}if(h.font="30px "+P,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(p.bind(null,P,R))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=i(y,976,m.length,m);const _=16,b=1482184792;let A=n(y,_);for(a=0,l=m.length-3;a<l;a+=4)A=A-b+n(m,a)|0;a<m.length&&(A=A-b+n(m+"XXX",a)|0),y=i(y,_,4,gA(A));const C=`url(data:font/opentype;base64,${btoa(y)});`,k=`@font-face {font-family:"${m}";src:${C}}`;this.insertRule(k);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const P of[e.loadedName,m]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=P,E.append(R)}this._document.body.append(E),p(m,()=>{E.remove(),t.complete()})}}class FA{#e;constructor(e,t=null,n,i){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Ry(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(l){Te(`getPathGenerator - ignoring character: "${l}".`)}const a=Dy(i);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=a}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){Pe(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){Pe(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class Wi{#e;#t;#s;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let i=0;for(const d of Wi.strings){const p=t.encode(e[d]);n[d]=p,i+=4+p.length}const a=new ArrayBuffer(i),l=new Uint8Array(a),c=new DataView(a);let h=0;for(const d of Wi.strings){const p=n[d],m=p.length;c.setUint32(h,m),l.set(p,h+4),h+=4+m}return Fe(h===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#s=new TextDecoder}#n(e){Fe(e<Wi.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#s.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class Vi{#e;#t;#s;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let i=0;for(const y of Vi.strings){const w=t.encode(e[y]);n[y]=w,i+=4+w.length}i+=4;let a,l,c=1+i;e.style&&(a=t.encode(e.style.style),l=t.encode(e.style.weight),c+=4+a.length+4+l.length);const h=new ArrayBuffer(c),d=new Uint8Array(h),p=new DataView(h);let m=0;p.setUint8(m++,e.guessFallback?1:0),p.setUint32(m,0),m+=4,i=0;for(const y of Vi.strings){const w=n[y],_=w.length;i+=4+_,p.setUint32(m,_),d.set(w,m+4),m+=4+_}return p.setUint32(m-i-4,i),e.style&&(p.setUint32(m,a.length),d.set(a,m+4),m+=4+a.length,p.setUint32(m,l.length),d.set(l,m+4),m+=4+l.length),Fe(m<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(m)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#s=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){Fe(e<Vi.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#s.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#s.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const i=this.#t.getUint32(e),a=this.#s.decode(new Uint8Array(this.#e,e+4,i));return{style:n,weight:a}}}class He{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#s=this.#t+1+8;static#n=this.#s+1+48;static#a=this.#n+1+6;#r;#i;#o;constructor({data:e,extra:t}){this.#r=e,this.#i=new TextDecoder,this.#o=new DataView(this.#r),t&&Object.assign(this,t)}#c(e){Fe(e<He.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,i=this.#o.getUint8(t)>>n&3;return i===0?void 0:i===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return Fe(e<He.numbers.length,"Invalid number index"),this.#o.getFloat64(He.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=He.#t;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<4;i++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=He.#s;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<6;i++)n.push(this.#o.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=He.#n;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<3;i++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}#d(e){Fe(e<He.strings.length,"Invalid string index");let t=He.#a+4;for(let a=0;a<e;a++)t+=this.#o.getUint32(t)+4;const n=this.#o.getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(this.#r,t+4,n)),this.#i.decode(i)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let e=He.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);e+=4+i;const a=this.#o.getUint32(e);if(a!==0)return new Uint8Array(this.#r,e+4,a)}clearData(){let e=He.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);e+=4+i;const a=this.#o.getUint32(e);new Uint8Array(this.#r,e+4,a).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=He.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);if(i===0)return null;const a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,e+4,i)),new Wi(a.buffer)}get systemFontInfo(){let e=He.#a;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);if(n===0)return null;const i=new Uint8Array(n);return i.set(new Uint8Array(this.#r,e+4,n)),new Vi(i.buffer)}static write(e){const t=e.systemFontInfo?Vi.write(e.systemFontInfo):null,n=e.cssFontInfo?Wi.write(e.cssFontInfo):null,i=new TextEncoder,a={};let l=0;for(const b of He.strings)a[b]=i.encode(e[b]),l+=4+a[b].length;const c=He.#a+4+l+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),d=new Uint8Array(h),p=new DataView(h);let m=0;const y=He.bools.length;let w=0,_=0;for(let b=0;b<y;b++){const A=e[He.bools[b]];w|=(A===void 0?0:A?2:1)<<_,_+=2,(_===8||b===y-1)&&(p.setUint8(m++,w),w=0,_=0)}Fe(m===He.#e,"FontInfo.write: Boolean properties offset mismatch");for(const b of He.numbers)p.setFloat64(m,e[b]),m+=8;if(Fe(m===He.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){p.setUint8(m++,4);for(const b of e.bbox)p.setInt16(m,b,!0),m+=2}else p.setUint8(m++,0),m+=8;if(Fe(m===He.#s,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){p.setUint8(m++,6);for(const b of e.fontMatrix)p.setFloat64(m,b,!0),m+=8}else p.setUint8(m++,0),m+=48;if(Fe(m===He.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){p.setUint8(m++,1);for(const b of e.defaultVMetrics)p.setInt16(m,b,!0),m+=2}else p.setUint8(m++,0),m+=6;Fe(m===He.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(He.#a,0),m+=4;for(const b of He.strings){const A=a[b],C=A.length;p.setUint32(m,C),d.set(A,m+4),m+=4+C}if(p.setUint32(He.#a,m-He.#a-4),!t)p.setUint32(m,0),m+=4;else{const b=t.byteLength;p.setUint32(m,b),Fe(m+4+b<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(t),m+4),m+=4+b}if(!n)p.setUint32(m,0),m+=4;else{const b=n.byteLength;p.setUint32(m,b),Fe(m+4+b<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(n),m+4),m+=4+b}return e.data===void 0?(p.setUint32(m,0),m+=4):(p.setUint32(m,e.data.length),d.set(e.data,m+4),m+=4+e.data.length),Fe(m<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(m)}}class bt{static#e=0;static#t=1;static#s=2;static#n=3;static#a=4;static#r=8;static#i=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,i=[],a=[],l=[],c=[],h=null,d=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],l=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],i=e[2],a=e[3],c=e[4]||[],n=e[6],d=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const p=Math.floor(i.length/2),m=Math.floor(a.length/3),y=l.length,w=c.length;let _=0;for(const R of c)_+=1,_=Math.ceil(_/4)*4,_+=4+R.coords.length*4,_+=4+R.colors.length*4,R.verticesPerRow!==void 0&&(_+=4);const b=20+p*8+m*3+y*8+(n?16:0)+(d?3:0)+_,A=new ArrayBuffer(b),C=new DataView(A),k=new Uint8Array(A);C.setUint8(bt.#e,t),C.setUint8(bt.#t,n?1:0),C.setUint8(bt.#s,d?1:0),C.setUint8(bt.#n,h),C.setUint32(bt.#a,p,!0),C.setUint32(bt.#r,m,!0),C.setUint32(bt.#i,y,!0),C.setUint32(bt.#o,w,!0);let E=20;new Float32Array(A,E,p*2).set(i),E+=p*8,k.set(a,E),E+=m*3;for(const[R,N]of l)C.setFloat32(E,R,!0),E+=4,C.setUint32(E,parseInt(N.slice(1),16),!0),E+=4;if(n)for(const R of n)C.setFloat32(E,R,!0),E+=4;d&&(k.set(d,E),E+=3);for(let R=0;R<c.length;R++){const N=c[R];C.setUint8(E,N.type),E+=1,E=Math.ceil(E/4)*4,C.setUint32(E,N.coords.length,!0),E+=4,new Int32Array(A,E,N.coords.length).set(N.coords),E+=N.coords.length*4,C.setUint32(E,N.colors.length,!0),E+=4,new Int32Array(A,E,N.colors.length).set(N.colors),E+=N.colors.length*4,N.verticesPerRow!==void 0&&(C.setUint32(E,N.verticesPerRow,!0),E+=4)}return A}getIR(){const e=this.view,t=this.data[bt.#e],n=!!this.data[bt.#t],i=!!this.data[bt.#s],a=e.getUint32(bt.#a,!0),l=e.getUint32(bt.#r,!0),c=e.getUint32(bt.#i,!0),h=e.getUint32(bt.#o,!0);let d=20;const p=new Float32Array(this.buffer,d,a*2);d+=a*8;const m=new Uint8Array(this.buffer,d,l*3);d+=l*3;const y=[];for(let A=0;A<c;++A){const C=e.getFloat32(d,!0);d+=4;const k=e.getUint32(d,!0);d+=4,y.push([C,`#${k.toString(16).padStart(6,"0")}`])}let w=null;if(n){w=[];for(let A=0;A<4;++A)w.push(e.getFloat32(d,!0)),d+=4}let _=null;i&&(_=new Uint8Array(this.buffer,d,3),d+=3);const b=[];for(let A=0;A<h;++A){const C=e.getUint8(d);d+=1,d=Math.ceil(d/4)*4;const k=e.getUint32(d,!0);d+=4;const E=new Int32Array(this.buffer,d,k);d+=k*4;const P=e.getUint32(d,!0);d+=4;const R=new Int32Array(this.buffer,d,P);d+=P*4;const N={type:C,coords:E,colors:R};C===fh.LATTICE&&(N.verticesPerRow=e.getUint32(d,!0),d+=4),b.push(N)}if(t===1)return["RadialAxial","axial",w,y,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",w,y,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(t===3){const A=this.data[bt.#n];let C=null;if(p.length>0){let k=p[0],E=p[0],P=p[1],R=p[1];for(let N=0;N<p.length;N+=2){const O=p[N],L=p[N+1];k=k>O?O:k,P=P>L?L:P,E=E<O?O:E,R=R<L?L:R}C=[k,P,E,R]}return["Mesh",A,p,m,b,C,w,_]}throw new Error(`Unsupported pattern kind: ${t}`)}}function jA(o){if(o instanceof URL)return o.href;if(typeof o=="string"){if(Ut)return o;const e=URL.parse(o,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function BA(o){if(Ut&&typeof Buffer<"u"&&o instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return ma(o);if(o instanceof ArrayBuffer||ArrayBuffer.isView(o)||typeof o=="object"&&!isNaN(o?.length))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Bo(o){if(typeof o!="string")return null;if(o.endsWith("/"))return o;throw new Error(`Invalid factory url: "${o}" must include trailing slash.`)}const wh=o=>typeof o=="object"&&Number.isInteger(o?.num)&&o.num>=0&&Number.isInteger(o?.gen)&&o.gen>=0,$A=o=>typeof o=="object"&&typeof o?.name=="string",zA=xA.bind(null,wh,$A);class UA{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Te("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);i=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const $o={DATA:1,ERROR:2},ct={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ng(){}function Yt(o){if(o instanceof Ps||o instanceof ph||o instanceof Xm||o instanceof yl||o instanceof Xu)return o;switch(o instanceof Error||typeof o=="object"&&o!==null||We('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),o.name){case"AbortException":return new Ps(o.message);case"InvalidPDFException":return new ph(o.message);case"PasswordException":return new Xm(o.message,o.code);case"ResponseException":return new yl(o.message,o.status,o.missing);case"UnknownErrorException":return new Xu(o.message,o.details)}return new Xu(o.message,o.toString())}class Xr{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===$o.DATA)i.resolve(e.data);else if(e.callback===$o.ERROR)i.reject(Yt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(l){a.postMessage({sourceName:n,targetName:i,callback:$o.DATA,callbackId:e.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:i,callback:$o.ERROR,callbackId:e.callbackId,reason:Yt(l)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(e,t,n,i){const a=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:e,streamId:a,data:t,desiredSize:d.desiredSize},i),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:l,targetName:c,stream:ct.PULL,streamId:a,desiredSize:d.desiredSize}),p.promise},cancel:d=>{Fe(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:ct.CANCEL,streamId:a,reason:Yt(d)}),p.promise}},n)}#s(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,l=this,c=this.actionHandler[e.action],h={enqueue(d,p=1,m){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=p,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:i,stream:ct.ENQUEUE,streamId:t,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:ct.CLOSE,streamId:t}),delete l.streamSinks[t])},error(d){Fe(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:i,stream:ct.ERROR,streamId:t,reason:Yt(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){a.postMessage({sourceName:n,targetName:i,stream:ct.START_COMPLETE,streamId:t,success:!0})},function(d){a.postMessage({sourceName:n,targetName:i,stream:ct.START_COMPLETE,streamId:t,reason:Yt(d)})})}#n(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,a=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case ct.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Yt(e.reason));break;case ct.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Yt(e.reason));break;case ct.PULL:if(!c){a.postMessage({sourceName:n,targetName:i,stream:ct.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||ng).then(function(){a.postMessage({sourceName:n,targetName:i,stream:ct.PULL_COMPLETE,streamId:t,success:!0})},function(d){a.postMessage({sourceName:n,targetName:i,stream:ct.PULL_COMPLETE,streamId:t,reason:Yt(d)})});break;case ct.ENQUEUE:if(Fe(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case ct.CLOSE:if(Fe(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#a(l,t);break;case ct.ERROR:Fe(l,"error should have stream controller"),l.controller.error(Yt(e.reason)),this.#a(l,t);break;case ct.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Yt(e.reason)),this.#a(l,t);break;case ct.CANCEL:if(!c)break;const h=Yt(e.reason);Promise.try(c.onCancel||ng,h).then(function(){a.postMessage({sourceName:n,targetName:i,stream:ct.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){a.postMessage({sourceName:n,targetName:i,stream:ct.CANCEL_COMPLETE,streamId:t,reason:Yt(d)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#a(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class jy{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){We("Abstract method `_createCanvas` called.")}}class HA extends jy{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class By{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){We("Abstract method `_fetch` called.")}}class sg extends By{async _fetch(e){const t=await ga(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):ma(t)}}class $y{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,a){return"none"}destroy(e=!1){}}class WA extends $y{#e;#t;#s;#n;#a;#r;#i=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#a=t}get#o(){return this.#t||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#s){const e=this.#a.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#a.createElementNS(ns,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#s=this.#a.createElementNS(ns,"defs"),e.append(n),n.append(this.#s),this.#a.body.append(e)}return this.#s}#d(e){if(e.length===1){const h=e[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=h[m]/255;const p=d.join(",");return[p,p,p]}const[t,n,i]=e,a=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=t[h]/255,l[h]=n[h]/255,c[h]=i[h]/255;return[a.join(","),l.join(","),c.join(",")]}#h(e){if(this.#e===void 0){this.#e="";const t=this.#a.URL;t!==this.#a.baseURI&&(Il(t)?Te('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=Ty(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,i,a]=this.#d(e),l=e.length===1?n:`${n}${i}${a}`;if(t=this.#o.get(l),t)return this.#o.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#i++}`,h=this.#h(c);this.#o.set(e,h),this.#o.set(l,h);const d=this.#m(c);return this.#p(n,i,a,d),h}addHCMFilter(e,t){const n=`${e}-${t}`,i="base";let a=this.#c.get(i);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#c.set(i,a)),!e||!t))return a.url;const l=this.#w(e);e=ue.makeHexColor(...l);const c=this.#w(t);if(t=ue.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return a.url;const h=new Array(256);for(let w=0;w<=255;w++){const _=w/255;h[w]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const d=h.join(","),p=`g_${this.#n}_hcm_filter`,m=a.filter=this.#m(p);this.#p(d,d,d,m),this.#g(m);const y=(w,_)=>{const b=l[w]/255,A=c[w]/255,C=new Array(_+1);for(let k=0;k<=_;k++)C[k]=b+k/_*(A-b);return C.join(",")};return this.#p(y(0,5),y(1,5),y(2,5),m),a.url=this.#h(p),a.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#d([e]),i=`alpha_${n}`;if(t=this.#o.get(i),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_alpha_map_${this.#i++}`,l=this.#h(a);this.#o.set(e,l),this.#o.set(i,l);const c=this.#m(a);return this.#y(n,c),l}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,i;if(e?([n]=this.#d([e]),i=`luminosity_${n}`):i="luminosity",t=this.#o.get(i),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_luminosity_map_${this.#i++}`,l=this.#h(a);this.#o.set(e,l),this.#o.set(i,l);const c=this.#m(a);return this.#f(c),e&&this.#y(n,c),l}addHighlightHCMFilter(e,t,n,i,a){const l=`${t}-${n}-${i}-${a}`;let c=this.#c.get(e);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#c.set(e,c)),!t||!n))return c.url;const[h,d]=[t,n].map(this.#w.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[y,w]=[i,a].map(this.#w.bind(this));m<p&&([p,m,y,w]=[m,p,w,y]),this.#l.style.color="";const _=(C,k,E)=>{const P=new Array(256),R=(m-p)/E,N=C/255,O=(k-C)/(255*E);let L=0;for(let H=0;H<=E;H++){const V=Math.round(p+H*R),q=N+H*O;for(let xe=L;xe<=V;xe++)P[xe]=q;L=V+1}for(let H=L;H<256;H++)P[H]=P[L-1];return P.join(",")},b=`g_${this.#n}_hcm_${e}_filter`,A=c.filter=this.#m(b);return this.#g(A),this.#p(_(y[0],w[0],5),_(y[1],w[1],5),_(y[2],w[2],5),A),c.url=this.#h(b),c.url}destroy(e=!1){e&&this.#r?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#r?.clear(),this.#r=null,this.#i=0)}#f(e){const t=this.#a.createElementNS(ns,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#g(e){const t=this.#a.createElementNS(ns,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#m(e){const t=this.#a.createElementNS(ns,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,n){const i=this.#a.createElementNS(ns,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}#p(e,t,n,i){const a=this.#a.createElementNS(ns,"feComponentTransfer");i.append(a),this.#u(a,"feFuncR",e),this.#u(a,"feFuncG",t),this.#u(a,"feFuncB",n)}#y(e,t){const n=this.#a.createElementNS(ns,"feComponentTransfer");t.append(n),this.#u(n,"feFuncA",e)}#w(e){return this.#l.style.color=e,va(getComputedStyle(this.#l).getPropertyValue("color"))}}class zy{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){We("Abstract method `_fetch` called.")}}class ig extends zy{async _fetch(e){const t=await ga(e,"arraybuffer");return new Uint8Array(t)}}class Uy{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){We("Abstract method `_fetch` called.")}}class rg extends Uy{async _fetch(e){const t=await ga(e,"arraybuffer");return new Uint8Array(t)}}Ut&&Te("Please use the `legacy` build in Node.js environments.");async function ed(o){const t=await process.getBuiltinModule("fs").promises.readFile(o);return new Uint8Array(t)}class VA extends $y{}class GA extends jy{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class qA extends By{async _fetch(e){return ed(e)}}class XA extends zy{async _fetch(e){return ed(e)}}class KA extends Uy{async _fetch(e){return ed(e)}}const Ti="__forcedDependency",{floor:ag,ceil:og}=Math;function zo(o,e,t,n,i,a){o[e*4+0]=Math.min(o[e*4+0],t),o[e*4+1]=Math.min(o[e*4+1],n),o[e*4+2]=Math.max(o[e*4+2],i),o[e*4+3]=Math.max(o[e*4+3],a)}const bh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class YA{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===bh}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const Uo=(o,e)=>{if(!o)return;let t=o.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},o.set(e,t)),t};class QA{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[Ti]:[]};#s=new Map;#n=[];#a=[];#r=[[1,0,0,1,0,0]];#i=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(e,t,n=!1){this.#f=e.width,this.#g=e.height,this.#y(t),n&&(this.#p=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#y(e,this.#u)}#y(e,t){const n=new ArrayBuffer(e*4);this.#m=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),t&&t.length>0?(this.#u.set(t),this.#u.fill(bh,t.length)):this.#u.fill(bh)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[Ti]:{__proto__:this.#t[Ti]}},this.#i={__proto__:this.#i},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#i=Object.getPrototypeOf(this.#i);const n=this.#n.pop();return n!==void 0&&(Uo(this.#p,e)?.dependencies.add(n),this.#u[e]=this.#u[n]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(Uo(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#a.push(e),this}endMarkedContent(e){const t=this.#a.pop();return t!==void 0&&(Uo(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#r.push(ue.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#s.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#s.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Ti,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(Ti,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,n,i,a,l){const c=ue.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];ue.axialAlignedBoundingBox([n,a,i,l],c,h);const d=ue.intersect(this.#i,h);return d?(this.#i[0]=d[0],this.#i[1]=d[1],this.#i[2]=d[2],this.#i[3]=d[3]):(this.#i[0]=this.#i[1]=1/0,this.#i[2]=this.#i[3]=-1/0),this}recordBBox(e,t,n,i,a,l){const c=this.#i;if(c[0]===1/0)return this;const h=ue.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform());if(c[0]===-1/0)return ue.axialAlignedBoundingBox([n,a,i,l],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return ue.axialAlignedBoundingBox([n,a,i,l],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],c[3])),this}recordCharacterBBox(e,t,n,i=1,a=0,l=0,c){const h=n.bbox;let d,p;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(n),d!==!1&&(p=[0,0,0,0],ue.axialAlignedBoundingBox(h,n.fontMatrix,p),(i!==1||a!==0||l!==0)&&ue.scaleMinMax([i,0,0,-i,a,l],p),d)))return this.recordBBox(e,t,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(e);const m=c();return h&&p&&d===void 0&&(d=p[0]<=a-m.actualBoundingBoxLeft&&p[2]>=a+m.actualBoundingBoxRight&&p[1]<=l-m.actualBoundingBoxAscent&&p[3]>=l+m.actualBoundingBoxDescent,this.#h.set(n,d),d)?this.recordBBox(e,t,p[0],p[2],p[1],p[3]):this.recordBBox(e,t,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,l-m.actualBoundingBoxAscent,l+m.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#i[0]),this.#o[1]=Math.max(0,this.#i[1]),this.#o[2]=Math.min(this.#f,this.#i[2]),this.#o[3]=Math.min(this.#g,this.#i[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,i=this.#e,a=this.#t;for(const l of t)l in this.#e?n.add(i[l]):l in a&&a[l].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#s.has(t)&&this.#l.add(this.#s.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Ti]),this.#p){const n=Uo(this.#p,e),{dependencies:i}=n;this.#l.forEach(i.add,i),this.#n.forEach(i.add,i),this.#a.forEach(i.add,i),i.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=ag(this.#o[0]*256/this.#f),i=ag(this.#o[1]*256/this.#g),a=og(this.#o[2]*256/this.#f),l=og(this.#o[3]*256/this.#g);zo(this.#m,e,n,i,a,l);for(const c of this.#l)c!==e&&zo(this.#m,c,n,i,a,l);for(const c of this.#n)c!==e&&zo(this.#m,c,n,i,a,l);for(const c of this.#a)c!==e&&zo(this.#m,c,n,i,a,l);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#i[0]=Math.max(this.#i[0],this.#o[0]),this.#i[1]=Math.max(this.#i[1],this.#o[1]),this.#i[2]=Math.min(this.#i[2],this.#o[2]),this.#i[3]=Math.min(this.#i[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#d.get(e);return this.#d.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#h.clear(),new YA(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class vl{#e;#t;#s;#n=0;#a=0;constructor(e,t,n){if(e instanceof vl&&e.#s===!!n)return e;this.#e=e,this.#t=t,this.#s=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#a++,this.#e.save(this.#t),this}restore(e){return this.#a>0&&(this.#e.restore(this.#t),this.#a--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#s||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,i,a,l){return this.#s||this.#e.recordClipBox(this.#t,t,n,i,a,l),this}recordBBox(e,t,n,i,a,l){return this.#s||this.#e.recordBBox(this.#t,t,n,i,a,l),this}recordCharacterBBox(e,t,n,i,a,l,c){return this.#s||this.#e.recordCharacterBBox(this.#t,t,n,i,a,l,c),this}recordFullPageBBox(e){return this.#s||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#s||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const yn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Rt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function xh(o,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),o.clip(i)}class td{isModifyingCurrentTransform(){return!1}getPattern(){We("Abstract method `getPattern` called.")}}class JA extends td{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let a;if(i===Rt.STROKE||i===Rt.FILL){const l=t.current.getClippedPathBoundingBox(i,Ze(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,d=t.cachedCanvases.getCanvas("pattern",c,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=ue.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),xh(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=e.createPattern(d.canvas,"no-repeat");const m=new DOMMatrix(n);a.setTransform(m)}else xh(e,this._bbox),a=this._createGradient(e);return a}}function Qu(o,e,t,n,i,a,l,c){const h=e.coords,d=e.colors,p=o.data,m=o.width*4;let y;h[t+1]>h[n+1]&&(y=t,t=n,n=y,y=a,a=l,l=y),h[n+1]>h[i+1]&&(y=n,n=i,i=y,y=l,l=c,c=y),h[t+1]>h[n+1]&&(y=t,t=n,n=y,y=a,a=l,l=y);const w=(h[t]+e.offsetX)*e.scaleX,_=(h[t+1]+e.offsetY)*e.scaleY,b=(h[n]+e.offsetX)*e.scaleX,A=(h[n+1]+e.offsetY)*e.scaleY,C=(h[i]+e.offsetX)*e.scaleX,k=(h[i+1]+e.offsetY)*e.scaleY;if(_>=k)return;const E=d[a],P=d[a+1],R=d[a+2],N=d[l],O=d[l+1],L=d[l+2],H=d[c],V=d[c+1],q=d[c+2],xe=Math.round(_),X=Math.round(k);let re,te,J,K,j,ne,se,D;for(let U=xe;U<=X;U++){if(U<A){const oe=U<_?0:(_-U)/(_-A);re=w-(w-b)*oe,te=E-(E-N)*oe,J=P-(P-O)*oe,K=R-(R-L)*oe}else{let oe;U>k?oe=1:A===k?oe=0:oe=(A-U)/(A-k),re=b-(b-C)*oe,te=N-(N-H)*oe,J=O-(O-V)*oe,K=L-(L-q)*oe}let ie;U<_?ie=0:U>k?ie=1:ie=(_-U)/(_-k),j=w-(w-C)*ie,ne=E-(E-H)*ie,se=P-(P-V)*ie,D=R-(R-q)*ie;const ge=Math.round(Math.min(re,j)),ke=Math.round(Math.max(re,j));let Ee=m*U+ge*4;for(let oe=ge;oe<=ke;oe++)ie=(re-oe)/(re-j),ie<0?ie=0:ie>1&&(ie=1),p[Ee++]=te-(te-ne)*ie|0,p[Ee++]=J-(J-se)*ie|0,p[Ee++]=K-(K-D)*ie|0,p[Ee++]=255}}function ZA(o,e,t){const n=e.coords,i=e.colors;let a,l;switch(e.type){case fh.LATTICE:const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,d=c-1;for(a=0;a<h;a++){let p=a*c;for(let m=0;m<d;m++,p++)Qu(o,t,n[p],n[p+1],n[p+c],i[p],i[p+1],i[p+c]),Qu(o,t,n[p+c+1],n[p+1],n[p+c],i[p+c+1],i[p+1],i[p+c])}break;case fh.TRIANGLES:for(a=0,l=n.length;a<l;a+=3)Qu(o,t,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class e1 extends td{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),w=d/m,_=p/y,b={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/w,scaleY:1/_},A=m+4,C=y+4,k=n.getCanvas("mesh",A,C),E=k.context,P=E.createImageData(m,y);if(t){const N=P.data;for(let O=0,L=N.length;O<L;O+=4)N[O]=t[0],N[O+1]=t[1],N[O+2]=t[2],N[O+3]=255}for(const N of this._figures)ZA(P,N,b);return E.putImageData(P,2,2),{canvas:k.canvas,offsetX:c-2*w,offsetY:h-2*_,scaleX:w,scaleY:_}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){xh(e,this._bbox);const a=new Float32Array(2);if(i===Rt.SHADING)ue.singularValueDecompose2dScale(Ze(e),a);else if(this.matrix){ue.singularValueDecompose2dScale(this.matrix,a);const[c,h]=a;ue.singularValueDecompose2dScale(t.baseTransform,a),a[0]*=c,a[1]*=h}else ue.singularValueDecompose2dScale(t.baseTransform,a);const l=this._createMeshCanvas(a,i===Rt.SHADING?null:this._background,t.cachedCanvases);return i!==Rt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class t1 extends td{getPattern(){return"hotpink"}}function n1(o){switch(o[0]){case"RadialAxial":return new JA(o);case"Mesh":return new e1(o);case"Dummy":return new t1}throw new Error(`Unknown IR type: ${o[0]}`)}const lg={COLORED:1,UNCOLORED:2};class nd{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){const{bbox:n,operatorList:i,paintType:a,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:p}=this;d=Math.abs(d),p=Math.abs(p),Ml("TilingType: "+l);const m=n[0],y=n[1],w=n[2],_=n[3],b=w-m,A=_-y,C=new Float32Array(2);ue.singularValueDecompose2dScale(this.matrix,C);const[k,E]=C;ue.singularValueDecompose2dScale(this.baseTransform,C);const P=k*C[0],R=E*C[1];let N=b,O=A,L=!1,H=!1;const V=Math.ceil(d*P),q=Math.ceil(p*R),xe=Math.ceil(b*P),X=Math.ceil(A*R);V>=xe?N=d:L=!0,q>=X?O=p:H=!0;const re=this.getSizeAndScale(N,this.ctx.canvas.width,P),te=this.getSizeAndScale(O,this.ctx.canvas.height,R),J=e.cachedCanvases.getCanvas("pattern",re.size,te.size),K=J.context,j=h.createCanvasGraphics(K,t);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,a,c),K.translate(-re.scale*m,-te.scale*y),j.transform(0,re.scale,0,0,te.scale,0,0),K.save(),j.dependencyTracker?.save(),this.clipBbox(j,m,y,w,_),j.baseTransform=Ze(j.ctx),j.executeOperatorList(i),j.endDrawing(),j.dependencyTracker?.restore(),K.restore(),L||H){const ne=J.canvas;L&&(N=d),H&&(O=p);const se=this.getSizeAndScale(N,this.ctx.canvas.width,P),D=this.getSizeAndScale(O,this.ctx.canvas.height,R),U=se.size,ie=D.size,ge=e.cachedCanvases.getCanvas("pattern-workaround",U,ie),ke=ge.context,Ee=L?Math.floor(b/d):0,oe=H?Math.floor(A/p):0;for(let Ie=0;Ie<=Ee;Ie++)for(let Le=0;Le<=oe;Le++)ke.drawImage(ne,U*Ie,ie*Le,U,ie,0,0,U,ie);return{canvas:ge.canvas,scaleX:se.scale,scaleY:D.scale,offsetX:m,offsetY:y}}return{canvas:J.canvas,scaleX:re.scale,scaleY:te.scale,offsetX:m,offsetY:y}}getSizeAndScale(e,t,n){const i=Math.max(nd.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*n);return a>=i?a=i:n=a/e,{scale:n,size:a}}clipBbox(e,t,n,i,a){const l=i-t,c=a-n;e.ctx.rect(t,n,l,c),ue.axialAlignedBoundingBox([t,n,i,a],Ze(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,a=e.current;switch(t){case lg.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;i.fillStyle=a.fillColor=l,i.strokeStyle=a.strokeColor=c;break;case lg.UNCOLORED:i.fillStyle=i.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new mA(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,a){let l=n;i!==Rt.SHADING&&(l=ue.transform(l,t.baseTransform),this.matrix&&(l=ue.transform(l,this.matrix)));const c=this.createPatternCanvas(t,a);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const d=e.createPattern(c.canvas,"repeat");return d.setTransform(h),d}}function s1({src:o,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=Mt.isLittleEndian?4278190080:255,[h,d]=l?[a,c]:[c,a],p=n>>3,m=n&7,y=o.length;t=new Uint32Array(t.buffer);let w=0;for(let _=0;_<i;_++){for(const A=e+p;e<A;e++){const C=e<y?o[e]:255;t[w++]=C&128?d:h,t[w++]=C&64?d:h,t[w++]=C&32?d:h,t[w++]=C&16?d:h,t[w++]=C&8?d:h,t[w++]=C&4?d:h,t[w++]=C&2?d:h,t[w++]=C&1?d:h}if(m===0)continue;const b=e<y?o[e++]:255;for(let A=0;A<m;A++)t[w++]=b&1<<7-A?d:h}return{srcPos:e,destPos:w}}const cg=16,ug=100,i1=15,hg=10,Qt=16,Ju=new DOMMatrix,ln=new Float32Array(2),$i=new Float32Array([1/0,1/0,-1/0,-1/0]);function r1(o,e){if(o._removeMirroring)throw new Error("Context is already forwarding operations.");o.__originalSave=o.save,o.__originalRestore=o.restore,o.__originalRotate=o.rotate,o.__originalScale=o.scale,o.__originalTranslate=o.translate,o.__originalTransform=o.transform,o.__originalSetTransform=o.setTransform,o.__originalResetTransform=o.resetTransform,o.__originalClip=o.clip,o.__originalMoveTo=o.moveTo,o.__originalLineTo=o.lineTo,o.__originalBezierCurveTo=o.bezierCurveTo,o.__originalRect=o.rect,o.__originalClosePath=o.closePath,o.__originalBeginPath=o.beginPath,o._removeMirroring=()=>{o.save=o.__originalSave,o.restore=o.__originalRestore,o.rotate=o.__originalRotate,o.scale=o.__originalScale,o.translate=o.__originalTranslate,o.transform=o.__originalTransform,o.setTransform=o.__originalSetTransform,o.resetTransform=o.__originalResetTransform,o.clip=o.__originalClip,o.moveTo=o.__originalMoveTo,o.lineTo=o.__originalLineTo,o.bezierCurveTo=o.__originalBezierCurveTo,o.rect=o.__originalRect,o.closePath=o.__originalClosePath,o.beginPath=o.__originalBeginPath,delete o._removeMirroring},o.save=function(){e.save(),this.__originalSave()},o.restore=function(){e.restore(),this.__originalRestore()},o.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},o.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},o.transform=function(t,n,i,a,l,c){e.transform(t,n,i,a,l,c),this.__originalTransform(t,n,i,a,l,c)},o.setTransform=function(t,n,i,a,l,c){e.setTransform(t,n,i,a,l,c),this.__originalSetTransform(t,n,i,a,l,c)},o.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},o.rotate=function(t){e.rotate(t),this.__originalRotate(t)},o.clip=function(t){e.clip(t),this.__originalClip(t)},o.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},o.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},o.bezierCurveTo=function(t,n,i,a,l,c){e.bezierCurveTo(t,n,i,a,l,c),this.__originalBezierCurveTo(t,n,i,a,l,c)},o.rect=function(t,n,i,a){e.rect(t,n,i,a),this.__originalRect(t,n,i,a)},o.closePath=function(){e.closePath(),this.__originalClosePath()},o.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class a1{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Ho(o,e,t,n,i,a,l,c,h,d){const[p,m,y,w,_,b]=Ze(o);if(m===0&&y===0){const k=l*p+_,E=Math.round(k),P=c*w+b,R=Math.round(P),N=(l+h)*p+_,O=Math.abs(Math.round(N)-E)||1,L=(c+d)*w+b,H=Math.abs(Math.round(L)-R)||1;return o.setTransform(Math.sign(p),0,0,Math.sign(w),E,R),o.drawImage(e,t,n,i,a,0,0,O,H),o.setTransform(p,m,y,w,_,b),[O,H]}if(p===0&&w===0){const k=c*y+_,E=Math.round(k),P=l*m+b,R=Math.round(P),N=(c+d)*y+_,O=Math.abs(Math.round(N)-E)||1,L=(l+h)*m+b,H=Math.abs(Math.round(L)-R)||1;return o.setTransform(0,Math.sign(m),Math.sign(y),0,E,R),o.drawImage(e,t,n,i,a,0,0,H,O),o.setTransform(p,m,y,w,_,b),[H,O]}o.drawImage(e,t,n,i,a,l,c,h,d);const A=Math.hypot(p,m),C=Math.hypot(y,w);return[A*h,C*d]}class dg{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=dh;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=kt.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=$i.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Rt.FILL,t=null){const n=this.minMax.slice();if(e===Rt.STROKE){t||We("Stroke bounding box must include transform."),ue.singularValueDecompose2dScale(t,ln);const i=ln[0]*this.lineWidth/2,a=ln[1]*this.lineWidth/2;n[0]-=i,n[1]-=a,n[2]+=i,n[3]+=a}return n}updateClipFromPath(){const e=ue.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set($i,0)}getClippedPathBoundingBox(e=Rt.FILL,t=null){return ue.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function fg(o,e){if(e instanceof ImageData){o.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%Qt,a=(t-i)/Qt,l=i===0?a:a+1,c=o.createImageData(n,Qt);let h=0,d;const p=e.data,m=c.data;let y,w,_,b;if(e.kind===il.GRAYSCALE_1BPP){const A=p.byteLength,C=new Uint32Array(m.buffer,0,m.byteLength>>2),k=C.length,E=n+7>>3,P=4294967295,R=Mt.isLittleEndian?4278190080:255;for(y=0;y<l;y++){for(_=y<a?Qt:i,d=0,w=0;w<_;w++){const N=A-h;let O=0;const L=N>E?n:N*8-7,H=L&-8;let V=0,q=0;for(;O<H;O+=8)q=p[h++],C[d++]=q&128?P:R,C[d++]=q&64?P:R,C[d++]=q&32?P:R,C[d++]=q&16?P:R,C[d++]=q&8?P:R,C[d++]=q&4?P:R,C[d++]=q&2?P:R,C[d++]=q&1?P:R;for(;O<L;O++)V===0&&(q=p[h++],V=128),C[d++]=q&V?P:R,V>>=1}for(;d<k;)C[d++]=0;o.putImageData(c,0,y*Qt)}}else if(e.kind===il.RGBA_32BPP){for(w=0,b=n*Qt*4,y=0;y<a;y++)m.set(p.subarray(h,h+b)),h+=b,o.putImageData(c,0,w),w+=Qt;y<l&&(b=n*i*4,m.set(p.subarray(h,h+b)),o.putImageData(c,0,w))}else if(e.kind===il.RGB_24BPP)for(_=Qt,b=n*_,y=0;y<l;y++){for(y>=a&&(_=i,b=n*_),d=0,w=b;w--;)m[d++]=p[h++],m[d++]=p[h++],m[d++]=p[h++],m[d++]=255;o.putImageData(c,0,y*Qt)}else throw new Error(`bad image kind: ${e.kind}`)}function pg(o,e){if(e.bitmap){o.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%Qt,a=(t-i)/Qt,l=i===0?a:a+1,c=o.createImageData(n,Qt);let h=0;const d=e.data,p=c.data;for(let m=0;m<l;m++){const y=m<a?Qt:i;({srcPos:h}=s1({src:d,srcPos:h,dest:p,width:n,height:y,nonBlackColor:0})),o.putImageData(c,0,m*Qt)}}function Ur(o,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)o[n]!==void 0&&(e[n]=o[n]);o.setLineDash!==void 0&&(e.setLineDash(o.getLineDash()),e.lineDashOffset=o.lineDashOffset)}function Wo(o){o.strokeStyle=o.fillStyle="#000000",o.fillRule="nonzero",o.globalAlpha=1,o.lineWidth=1,o.lineCap="butt",o.lineJoin="miter",o.miterLimit=10,o.globalCompositeOperation="source-over",o.font="10px sans-serif",o.setLineDash!==void 0&&(o.setLineDash([]),o.lineDashOffset=0);const{filter:e}=o;e!=="none"&&e!==""&&(o.filter="none")}function mg(o,e){if(e)return!0;ue.singularValueDecompose2dScale(o,ln);const t=Math.fround(Vn.pixelRatio*Xi.PDF_TO_CSS_UNITS);return ln[0]<=t&&ln[1]<=t}const o1=["butt","round","square"],l1=["miter","round","bevel"],c1={},gg={};class Gi{constructor(e,t,n,i,a,{optionalContentConfig:l,markedContentStack:c=null},h,d,p){this.ctx=e,this.current=new dg(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new a1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ze(this.compositeCtx))}this.ctx.save(),Wo(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ze(this.ctx)}executeOperatorList(e,t,n,i,a){const l=e.argsArray,c=e.fnArray;let h=t||0;const d=l.length;if(d===h)return h;const p=d-h>hg&&typeof n=="function",m=p?Date.now()+i1:0;let y=0;const w=this.commonObjs,_=this.objs;let b,A;for(;;){if(i!==void 0&&h===i.nextBreakPoint)return i.breakIt(h,n),h;if(!a||a(h))if(b=c[h],A=l[h]??null,b!==ha.dependency)A===null?this[b](h):this[b](h,...A);else for(const C of A){this.dependencyTracker?.recordNamedData(C,h);const k=C.startsWith("g_")?w:_;if(!k.has(C))return k.get(C,n),h}if(h++,h===d)return h;if(p&&++y>hg){if(Date.now()>m)return n(),h;y=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=i,d="prescale1",p,m;for(;a>2&&c>1||l>2&&h>1;){let y=c,w=h;a>2&&c>1&&(y=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/y),l>2&&h>1&&(w=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/w),p=this.cachedCanvases.getCanvas(d,y,w),m=p.context,m.clearRect(0,0,y,w),m.drawImage(e,0,0,c,h,0,0,y,w),e=p.canvas,c=y,h=w,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:i,height:a}=t,l=this.current.fillColor,c=this.current.patternFill,h=Ze(n);let d,p,m,y;if((t.bitmap||t.data)&&t.count>1){const V=t.bitmap||t.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),l]),d=this._cachedBitmapsMap.get(V),d||(d=new Map,this._cachedBitmapsMap.set(V,d));const q=d.get(p);if(q&&!c){const xe=Math.round(Math.min(h[0],h[2])+h[4]),X=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,yn.transformAndFill),{canvas:q,offsetX:xe,offsetY:X}}m=q}m||(y=this.cachedCanvases.getCanvas("maskCanvas",i,a),pg(y.context,t));let w=ue.transform(h,[1/i,0,0,-1/a,0,0]);w=ue.transform(w,[1,0,0,1,0,-a]);const _=$i.slice();ue.axialAlignedBoundingBox([0,0,i,a],w,_);const[b,A,C,k]=_,E=Math.round(C-b)||1,P=Math.round(k-A)||1,R=this.cachedCanvases.getCanvas("fillCanvas",E,P),N=R.context,O=b,L=A;N.translate(-O,-L),N.transform(...w),m||(m=this._scaleImage(y.canvas,jn(N)),m=m.img,d&&c&&d.set(p,m)),N.imageSmoothingEnabled=mg(Ze(N),t.interpolate),Ho(N,m,0,0,m.width,m.height,0,0,i,a),N.globalCompositeOperation="source-in";const H=ue.transform(jn(N),[1,0,0,1,-O,-L]);return N.fillStyle=c?l.getPattern(n,this,H,Rt.FILL,e):l,N.fillRect(0,0,i,a),d&&!c&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,R.canvas)),this.dependencyTracker?.recordDependencies(e,yn.transformAndFill),{canvas:R.canvas,offsetX:Math.round(O),offsetY:Math.round(L)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=o1[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=l1[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,i]of t)switch(n){case"LW":this.setLineWidth(e,i);break;case"LC":this.setLineCap(e,i);break;case"LJ":this.setLineJoin(e,i);break;case"ML":this.setMiterLimit(e,i);break;case"D":this.setDash(e,i[0],i[1]);break;case"RI":this.setRenderingIntent(e,i);break;case"FL":this.setFlatness(e,i);break;case"Font":this.setFont(e,i[0],i[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=i;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=i;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),Ur(this.suspendedCtx,l),r1(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ur(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const a=i[0],l=i[1],c=i[2]-a,h=i[3]-l;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,a,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,a,l,c,h,d,p,m){let y=e.canvas,w=h-p,_=d-m;if(l)if(w<0||_<0||w+n>y.width||_+i>y.height){const A=this.cachedCanvases.getCanvas("maskExtension",n,i),C=A.context;C.drawImage(y,-w,-_),C.globalCompositeOperation="destination-atop",C.fillStyle=l,C.fillRect(0,0,n,i),C.globalCompositeOperation="source-over",y=A.canvas,w=_=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(w,_,n,i),e.clip(A),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(w,_,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const b=new Path2D;b.rect(h,d,n,i),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(y,w,_,n,i,h,d,n,i),t.restore()}save(e){this.inSMaskMode&&Ur(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Ur(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,i,a,l,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,a,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[a]=n;if(!i){a||=n[0]=new Path2D,this[t](e,a);return}if(this.dependencyTracker!==null){const l=t===ha.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-l,i[2]+l,i[1]-l,i[3]+l).recordDependencies(e,["transform"])}a instanceof Path2D||(a=n[0]=Dy(a)),ue.axialAlignedBoundingBox(i,Ze(this.ctx),this.current.minMax),this[t](e,a),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const i=this.ctx,a=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const l=a.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=a.getPattern(i,this,jn(i),Rt.STROKE,e),l){const c=new Path2D;c.addPath(t,i.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,yn.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Rt.STROKE,Ze(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const d=a.isModifyingCurrentTransform()?i.getTransform():null;if(this.dependencyTracker?.save(e),i.save(),i.fillStyle=a.getPattern(i,this,jn(i),Rt.FILL,e),d){const p=new Path2D;p.addPath(t,i.getTransform().invertSelf().multiplySelf(d)),t=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),this.dependencyTracker?.recordDependencies(e,yn.fill),c&&(i.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,yn.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=c1}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=gg}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,a=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:d,path:p}of t)p&&i.addPath(p,new DOMMatrix(l).preMultiplySelf(a).translate(c,h).scale(d,-d));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),a=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=i.fontMatrix||dh,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Te("Invalid font matrix for font "+t),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const l=i.loadedName||"sans-serif",c=i.systemFontInfo?.css||`"${l}", ${i.fallbackName}`;let h="normal";i.black?h="900":i.bold&&(h="bold");const d=i.italic?"italic":"normal";let p=n;n<cg?p=cg:n>ug&&(p=ug),this.current.fontSizeScale=n/p,this.ctx.font=`${d} ${h} ${p}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#s(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}paintChar(e,t,n,i,a,l){const c=this.ctx,h=this.current,d=h.font,p=h.textRenderingMode,m=h.fontSize/h.fontSizeScale,y=p&kt.FILL_STROKE_MASK,w=!!(p&kt.ADD_TO_PATH_FLAG),_=h.patternFill&&!d.missingFile,b=h.patternStroke&&!d.missingFile;let A;if((d.disableFontFace||w||_||b)&&!d.missingFile&&(A=d.getPathGenerator(this.commonObjs,t)),A&&(d.disableFontFace||_||b)){c.save(),c.translate(n,i),c.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(e,c,d);let C;if(y===kt.FILL||y===kt.FILL_STROKE)if(a){C=c.getTransform(),c.setTransform(...a);const k=this.#s(A,C,a);c.fill(k)}else c.fill(A);if(y===kt.STROKE||y===kt.FILL_STROKE)if(l){C||=c.getTransform(),c.setTransform(...l);const{a:k,b:E,c:P,d:R}=C,N=ue.inverseTransform(l),O=ue.transform([k,E,P,R,0,0],N);ue.singularValueDecompose2dScale(O,ln),c.lineWidth*=Math.max(ln[0],ln[1])/m,c.stroke(this.#s(A,C,l))}else c.lineWidth/=m,c.stroke(A);c.restore()}else(y===kt.FILL||y===kt.FILL_STROKE)&&(c.fillText(t,n,i),this.dependencyTracker?.recordCharacterBBox(e,c,d,m,n,i,()=>c.measureText(t))),(y===kt.STROKE||y===kt.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,d,m,n,i,()=>c.measureText(t)).recordDependencies(e,yn.stroke),c.strokeText(t,n,i));w&&((this.pendingTextPaths||=[]).push({transform:Ze(c),x:n,y:i,fontSize:m,path:A}),this.dependencyTracker?.recordCharacterBBox(e,c,d,m,n,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Pe(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,yn.showText).resetBBox(e),this.current.textRenderingMode&kt.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(e);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,d=n.wordSpacing,p=n.fontDirection,m=n.textHScale*p,y=t.length,w=i.vertical,_=w?1:-1,b=i.defaultVMetrics,A=a*n.fontMatrix[0],C=n.textRenderingMode===kt.FILL&&!i.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),p>0?l.scale(m,-1):l.scale(m,1);let k,E;if(n.patternFill){l.save();const L=n.fillColor.getPattern(l,this,jn(l),Rt.FILL,e);k=Ze(l),l.restore(),l.fillStyle=L}if(n.patternStroke){l.save();const L=n.strokeColor.getPattern(l,this,jn(l),Rt.STROKE,e);E=Ze(l),l.restore(),l.strokeStyle=L}let P=n.lineWidth;const R=n.textMatrixScale;if(R===0||P===0){const L=n.textRenderingMode&kt.FILL_STROKE_MASK;(L===kt.STROKE||L===kt.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=R;if(c!==1&&(l.scale(c,c),P/=c),l.lineWidth=P,i.isInvalidPDFjsFont){const L=[];let H=0;for(const q of t)L.push(q.unicode),H+=q.width;const V=L.join("");if(l.fillText(V,0,0),this.dependencyTracker!==null){const q=l.measureText(V);this.dependencyTracker.recordBBox(e,this.ctx,-q.actualBoundingBoxLeft,q.actualBoundingBoxRight,-q.actualBoundingBoxAscent,q.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=H*A*m,l.restore(),this.compose();return}let N=0,O;for(O=0;O<y;++O){const L=t[O];if(typeof L=="number"){N+=_*L*a/1e3;continue}let H=!1;const V=(L.isSpace?d:0)+h,q=L.fontChar,xe=L.accent;let X,re,te=L.width;if(w){const j=L.vmetric||b,ne=-(L.vmetric?j[1]:te*.5)*A,se=j[2]*A;te=j?-j[0]:te,X=ne/c,re=(N+se)/c}else X=N/c,re=0;let J;if(i.remeasure&&te>0){J=l.measureText(q);const j=J.width*1e3/a*c;if(te<j&&this.isFontSubpixelAAEnabled){const ne=te/j;H=!0,l.save(),l.scale(ne,1),X/=ne}else te!==j&&(X+=(te-j)/2e3*a/c)}if(this.contentVisible&&(L.isInFont||i.missingFile)){if(C&&!xe)l.fillText(q,X,re),this.dependencyTracker?.recordCharacterBBox(e,l,J?{bbox:null}:i,a/c,X,re,()=>J??l.measureText(q));else if(this.paintChar(e,q,X,re,k,E),xe){const j=X+a*xe.offset.x/c,ne=re-a*xe.offset.y/c;this.paintChar(e,xe.fontChar,j,ne,k,E)}}const K=w?te*A-V*p:te*A+V*p;N+=K,H&&l.restore()}w?n.y-=N:n.x+=N*m,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,a=i.font,l=i.fontSize,c=i.fontDirection,h=a.vertical?1:-1,d=i.charSpacing,p=i.wordSpacing,m=i.textHScale*c,y=i.fontMatrix||dh,w=t.length,_=i.textRenderingMode===kt.INVISIBLE;let b,A,C,k;if(_||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(m,c);const E=this.dependencyTracker;for(this.dependencyTracker=E?new vl(E,e):null,b=0;b<w;++b){if(A=t[b],typeof A=="number"){k=h*A*l/1e3,this.ctx.translate(k,0),i.x+=k*m;continue}const P=(A.isSpace?p:0)+d,R=a.charProcOperatorList[A.operatorListId];R?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...y),this.executeOperatorList(R),this.restore()):Te(`Type3 character "${A.operatorListId}" is not available.`);const N=[A.width,0];ue.applyTransform(N,y),C=N[0]*l+P,n.translate(C,0),i.x+=C*m}n.restore(),E&&(this.dependencyTracker=E)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,a,l,c){const h=new Path2D;h.rect(i,a,l-i,c-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,i,l,a,c).recordClipBox(e,this.ctx,i,l,a,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const i=this.baseTransform||Ze(this.ctx),a={createCanvasGraphics:(l,c)=>new Gi(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new vl(this.dependencyTracker,c,!0):null)};n=new nd(t,this.ctx,a,i)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=n1(this.getObject(e,t)),this.cachedPatterns.set(t,i)),n&&(i.matrix=n),i}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const i=this._getPattern(e,t);n.fillStyle=i.getPattern(n,this,jn(n),Rt.SHADING,e);const a=jn(n);if(a){const{width:l,height:c}=n.canvas,h=$i.slice();ue.axialAlignedBoundingBox([0,0,l,c],a,h);const[d,p,m,y]=h;this.ctx.fillRect(d,p,m-d,y-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,yn.transform).recordDependencies(e,yn.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){We("Should not call beginInlineImage")}beginImageData(){We("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Ze(this.ctx),n)){ue.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,a,l,c]=n,h=new Path2D;h.rect(i,a,l-i,c-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,i,l,a,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Ml("TODO: Support non-isolated groups."),t.knockout&&Te("Knockout groups not supported.");const i=Ze(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=$i.slice();ue.axialAlignedBoundingBox(t.bbox,Ze(n),a);const l=[0,0,n.canvas.width,n.canvas.height];a=ue.intersect(a,l)||[0,0,0,0];const c=Math.floor(a[0]),h=Math.floor(a[1]),d=Math.max(Math.ceil(a[2])-c,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,p]);let m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(m,d,p),w=y.context;w.translate(-c,-h),w.transform(...i);let _=new Path2D;const[b,A,C,k]=t.bbox;if(_.rect(b,A,C-b,k-A),t.matrix){const E=new Path2D;E.addPath(_,new DOMMatrix(t.matrix)),_=E}w.clip(_),t.smask&&this.smaskStack.push({canvas:y.canvas,context:w,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),Ur(n,w),this.ctx=w,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Ze(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const l=$i.slice();ue.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,n,i,a,l){if(this.#e(),Wo(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,ue.singularValueDecompose2dScale(Ze(this.ctx),ln);const{viewportScale:d}=this,p=Math.ceil(c*this.outputScaleX*d),m=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:y,context:w}=this.annotationCanvas;this.annotationCanvasMap.set(t,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=w,this.ctx.save(),this.ctx.setTransform(ln[0],0,0,-ln[1],0,h*ln[1]),Wo(this.ctx)}else{Wo(this.ctx),this.endPath(e);const d=new Path2D;d.rect(n[0],n[1],c,h),this.ctx.clip(d)}}this.current=new dg(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...a)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const i=this.ctx,a=this._createMaskCanvas(e,t),l=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(l,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,i=0,a=0,l,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const d=Ze(h);h.transform(n,i,a,l,0,0);const p=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(e);for(let m=0,y=c.length;m<y;m+=2){const w=ue.transform(d,[n,i,a,l,c[m],c[m+1]]);h.drawImage(p.canvas,w[4],w[5]),this.dependencyTracker?.recordBBox(e,this.ctx,w[4],w[4]+p.canvas.width,w[5],w[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,yn.transformAndFill);for(const l of t){const{data:c,width:h,height:d,transform:p}=l,m=this.cachedCanvases.getCanvas("maskCanvas",h,d),y=m.context;y.save();const w=this.getObject(e,c,l);pg(y,w),y.globalCompositeOperation="source-in",y.fillStyle=a?i.getPattern(y,this,jn(n),Rt.FILL,e):i,y.fillRect(0,0,h,d),y.restore(),n.save(),n.transform(...p),n.scale(1,-1),Ho(n,m.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,d),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Te("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,i,a){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){Te("Dependent image isn't ready yet");return}const c=l.width,h=l.height,d=[];for(let p=0,m=a.length;p<m;p+=2)d.push({transform:[n,0,0,i,a[p],a[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,l,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,a=this.cachedCanvases.getCanvas("inlineImage",n,i),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",a.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,i=t.height,a=this.ctx;this.save(e);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/n,-1/i);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const p=this.cachedCanvases.getCanvas("inlineImage",n,i).context;fg(p,t),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,jn(a));a.imageSmoothingEnabled=mg(Ze(a),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,a,0,n,-i,0).recordDependencies(e,yn.imageXObject).recordOperation(e),Ho(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-i,n,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const i=this.ctx;let a;if(t.bitmap)a=t.bitmap;else{const l=t.width,c=t.height,d=this.cachedCanvases.getCanvas("inlineImage",l,c).context;fg(d,t),a=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(e);for(const l of n)i.save(),i.transform(...l.transform),i.scale(1,-1),Ho(i,a,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,i,0,1,-1,0),i.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,yn.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(i||(this.pendingClip===gg?a.clip(t,"evenodd"):a.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ze(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:a}=this.ctx.getTransform();let l,c;if(n===0&&i===0){const h=Math.abs(t),d=Math.abs(a);if(h===d)if(e===0)l=c=1/h;else{const p=h*e;l=c=p<1?1/p:1}else if(e===0)l=1/h,c=1/d;else{const p=h*e,m=d*e;l=p<1?1/p:1,c=m<1?1/m:1}}else{const h=Math.abs(t*a-n*i),d=Math.hypot(t,n),p=Math.hypot(i,a);if(e===0)l=p/h,c=d/h;else{const m=e*h;l=p>m?p/m:1,c=d>m?d/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[a,l]=this.getScaleForStroking();if(a===l){n.lineWidth=(i||1)*a,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(a,l),Ju.a=1/a,Ju.d=1/l;const h=new Path2D;if(h.addPath(e,Ju),c.length>0){const d=Math.max(a,l);n.setLineDash(c.map(p=>p/d)),n.lineDashOffset/=d}n.lineWidth=i||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const o in ha)Gi.prototype[o]!==void 0&&(Gi.prototype[ha[o]]=Gi.prototype[o]);class qi{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class u1{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Di=Symbol("INTERNAL");class h1{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:n,usage:i,rbGroups:a}){this.#e=!!(e&on.DISPLAY),this.#t=!!(e&on.PRINT),this.name=t,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==Di&&We("Internal method `_setVisible` called."),this.#s=n,this.#n=t}}class d1{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=on.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const n of e.groups)this.#t.set(n.id,new h1(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(Di,!1);for(const n of e.on)this.#t.get(n)._setVisible(Di,!0);for(const n of e.off)this.#t.get(n)._setVisible(Di,!1);this.#s=this.getHash()}}#a(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const a=e[i];let l;if(Array.isArray(a))l=this.#a(a);else if(this.#t.has(a))l=this.#t.get(a).visible;else return Te(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Ml("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Te(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#a(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Te(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Te(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Te(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Te(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Te(`Unknown optional content policy ${e.policy}.`),!0}return Te(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const i=this.#t.get(e);if(!i){Te(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const l of a)l!==e&&this.#t.get(l)?._setVisible(Di,!1,!0);i._setVisible(Di,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const a=this.#t.get(i);if(a)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!a.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new Oy;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class f1{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Fe(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),e.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(n),!0)});Fe(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Fe(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new p1(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new m1(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class p1{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=Yh(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class m1{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function g1(o){let e=!0,t=n("filename\\*","i").exec(o);if(t){t=t[1];let p=c(t);return p=unescape(p),p=h(p),p=d(p),a(p)}if(t=l(o),t){const p=d(t);return a(p)}if(t=n("filename","i").exec(o),t){t=t[1];let p=c(t);return p=d(p),a(p)}function n(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function i(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const y=new TextDecoder(p,{fatal:!0}),w=ma(m);m=y.decode(w),e=!1}catch{}}return m}function a(p){return e&&/[\x80-\xff]/.test(p)&&(p=i("utf-8",p),e&&(p=i("iso-8859-1",p))),p}function l(p){const m=[];let y;const w=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=w.exec(p))!==null;){let[,b,A,C]=y;if(b=parseInt(b,10),b in m){if(b===0)break;continue}m[b]=[A,C]}const _=[];for(let b=0;b<m.length&&b in m;++b){let[A,C]=m[b];C=c(C),A&&(C=unescape(C),b===0&&(C=h(C))),_.push(C)}return _.join("")}function c(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let y=0;y<m.length;++y){const w=m[y].indexOf('"');w!==-1&&(m[y]=m[y].slice(0,w),m.length=y+1),m[y]=m[y].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const y=p.slice(0,m),_=p.slice(m+1).replace(/^[^']*'/,"");return i(y,_)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,y,w,_){if(w==="q"||w==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,A){return String.fromCharCode(parseInt(A,16))}),i(y,_);try{_=atob(_)}catch{}return i(y,_)})}return""}function Hy(o,e){const t=new Headers;if(!o||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function Ll(o){return URL.parse(o)?.origin??null}function Wy({responseHeaders:o,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(o.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*t)||n||!e||o.get("Accept-Ranges")!=="bytes"||(o.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Vy(o){const e=o.get("Content-Disposition");if(e){let t=g1(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Yh(t))return t}return null}function ba(o,e){return new yl(`Unexpected server response (${o}) while retrieving PDF "${e}".`,o,o===404||o===0&&e.startsWith("file:"))}function Gy(o){return o===200||o===206}function qy(o,e,t){return{method:"GET",headers:o,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Xy(o){return o instanceof Uint8Array?o.buffer:o instanceof ArrayBuffer?o:(Te(`getArrayBuffer - unexpected data format: ${o}`),new Uint8Array(o).buffer)}class y1{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Hy(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Fe(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new v1(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new w1(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class v1{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,qy(n,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=Ll(a.url),!Gy(a.status))throw ba(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:h}=Wy({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=Vy(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Ps("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Xy(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class w1{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${n-1}`);const l=i.url;fetch(l,qy(a,this._withCredentials,this._abortController)).then(c=>{const h=Ll(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!Gy(c.status))throw ba(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Xy(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Zu=200,eh=206;function b1(o){const e=o.response;return typeof e!="string"?e:ma(e).buffer}class x1{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Hy(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,l]of this.headers)t.setRequestHeader(a,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=eh):i.expectedStatus=Zu,t.responseType="arraybuffer",Fe(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError(i.status);return}const a=i.status||Zu;if(!(a===Zu&&n.expectedStatus===eh)&&a!==n.expectedStatus){n.onError(i.status);return}const c=b1(i);if(a===eh){const h=i.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?n.onDone({begin:parseInt(d[1],10),chunk:c}):(Te('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class _1{constructor(e){this._source=e,this._manager=new x1(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Fe(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new A1(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new S1(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class A1{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ll(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...d]=c.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=Wy({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=Vy(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ba(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class S1{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Ll(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=ba(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const C1=/^[a-z][a-z0-9\-+.]+:/i;function k1(o){if(C1.test(o))return new URL(o);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(o))}class E1{constructor(e){this.source=e,this.url=k1(e.url),Fe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Fe(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new T1(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new P1(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class T1{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=ba(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Ps("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P1{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Hr=Symbol("INITIAL_DATA");class Ky{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Hr}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const n=this.#e[e];if(!n||n.data===Hr)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==Hr}delete(e){const t=this.#e[e];return!t||t.data===Hr?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Hr&&(yield[e,t])}}}const N1=1e5,yg=30;class zt{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#i=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#w=new Map;static#v=new Map;static#C=new WeakMap;static#A=null;static#x=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#m=e;else if(typeof e=="object")this.#m=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#h=n.scale*Vn.pixelRatio,this.#d=n.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:a,pageX:l,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-l,c+a],this.#o=i,this.#i=a,zt.#P(),Qs(t,n),this.#e.promise.finally(()=>{zt.#x.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Mt.platform;return Pe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#a??=t.lang,Object.assign(this.#f,t.styles),this.#E(t.items),e()},this.#e.reject)};return this.#c=this.#m.getReader(),zt.#x.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*Vn.pixelRatio,i=e.rotation;if(i!==this.#d&&(t?.(),this.#d=i,Qs(this.#l,{rotation:i})),n!==this.#h){t?.(),this.#h=n;const a={div:null,properties:null,ctx:zt.#N(this.#a)};for(const l of this.#u)a.properties=this.#p.get(l),a.div=l,this.#S(a)}}cancel(){const e=new Ps("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#E(e){if(this.#s)return;this.#r.ctx??=zt.#N(this.#a);const t=this.#u,n=this.#g;for(const i of e){if(t.length>N1){Te("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const a=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id&&this.#t.setAttribute("id",`${i.id}`),a.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(i.str),this.#b(i)}}#b(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const i=ue.transform(this.#y,e.transform);let a=Math.atan2(i[1],i[0]);const l=this.#f[e.fontName];l.vertical&&(a+=Math.PI/2);let c=this.#n&&l.fontSubstitution||l.fontFamily;c=zt.fontFamilyMap.get(c)||c;const h=Math.hypot(i[2],i[3]),d=h*zt.#F(c,l,this.#a);let p,m;a===0?(p=i[4],m=i[5]-d):(p=i[4]+d*Math.sin(a),m=i[5]-d*Math.cos(a));const y="calc(var(--total-scale-factor) *",w=t.style;this.#t===this.#l?(w.left=`${(100*p/this.#o).toFixed(2)}%`,w.top=`${(100*m/this.#i).toFixed(2)}%`):(w.left=`${y}${p.toFixed(2)}px)`,w.top=`${y}${m.toFixed(2)}px)`),w.fontSize=`${y}${(zt.#A*h).toFixed(2)}px)`,w.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),a!==0&&(n.angle=a*(180/Math.PI));let _=!1;if(e.str.length>1)_=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);b!==A&&Math.max(b,A)/Math.min(b,A)>1.5&&(_=!0)}if(_&&(n.canvasWidth=l.vertical?e.height:e.width),this.#p.set(t,n),this.#r.div=t,this.#r.properties=n,this.#S(this.#r),n.hasText&&this.#t.append(t),n.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this.#t.append(b)}}#S(e){const{div:t,properties:n,ctx:i}=e,{style:a}=t;let l="";if(zt.#A>1&&(l=`scale(${1/zt.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=a,{canvasWidth:h,fontSize:d}=n;zt.#T(i,d*this.#h,c);const{width:p}=i.measureText(t.textContent);p>0&&(l=`scaleX(${h*this.#h/p}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)}static cleanup(){if(!(this.#x.size>0)){this.#w.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#N(e=null){let t=this.#v.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#C.set(t,{size:0,family:""})}return t}static#T(e,t,n){const i=this.#C.get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)}static#P(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#F(e,t,n){const i=this.#w.get(e);if(i)return i;const a=this.#N(n);a.canvas.width=a.canvas.height=yg,this.#T(a,yg,e);const l=a.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let d=.8;return c?d=c/(c+h):(Mt.platform.isFirefox&&Te("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),this.#w.set(e,d),d}}const R1=100;function Yy(o={}){typeof o=="string"||o instanceof URL?o={url:o}:(o instanceof ArrayBuffer||ArrayBuffer.isView(o))&&(o={data:o});const e=new sd,{docId:t}=e,n=o.url?jA(o.url):null,i=o.data?BA(o.data):null,a=o.httpHeaders||null,l=o.withCredentials===!0,c=o.password??null,h=o.range instanceof Qy?o.range:null,d=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:2**16;let p=o.worker instanceof Tt?o.worker:null;const m=o.verbosity,y=typeof o.docBaseUrl=="string"&&!Il(o.docBaseUrl)?o.docBaseUrl:null,w=Bo(o.cMapUrl),_=o.cMapPacked!==!1,b=o.CMapReaderFactory||(Ut?qA:sg),A=Bo(o.iccUrl),C=Bo(o.standardFontDataUrl),k=o.StandardFontDataFactory||(Ut?XA:ig),E=Bo(o.wasmUrl),P=o.WasmFactory||(Ut?KA:rg),R=o.stopAtErrors!==!0,N=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,O=o.isEvalSupported!==!1,L=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!Ut,H=typeof o.isImageDecoderSupported=="boolean"?o.isImageDecoderSupported:!Ut&&(Mt.platform.isFirefox||!globalThis.chrome),V=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,q=typeof o.disableFontFace=="boolean"?o.disableFontFace:Ut,xe=o.fontExtraProperties===!0,X=o.enableXfa===!0,re=o.ownerDocument||globalThis.document,te=o.disableRange===!0,J=o.disableStream===!0,K=o.disableAutoFetch===!0,j=o.pdfBug===!0,ne=o.CanvasFactory||(Ut?GA:HA),se=o.FilterFactory||(Ut?VA:WA),D=o.enableHWA===!0,U=o.useWasm!==!1,ie=h?h.length:o.length??NaN,ge=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!Ut&&!q,ke=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:!!(b===sg&&k===ig&&P===rg&&w&&C&&E&&qr(w,document.baseURI)&&qr(C,document.baseURI)&&qr(E,document.baseURI)),Ee=null;dA(m);const oe={canvasFactory:new ne({ownerDocument:re,enableHWA:D}),filterFactory:new se({docId:t,ownerDocument:re}),cMapReaderFactory:ke?null:new b({baseUrl:w,isCompressed:_}),standardFontDataFactory:ke?null:new k({baseUrl:C}),wasmFactory:ke?null:new P({baseUrl:E})};p||(p=Tt.create({verbosity:m,port:qi.workerPort}),e._worker=p);const Ie={docId:t,apiVersion:"5.4.449",data:i,password:c,disableAutoFetch:K,rangeChunkSize:d,length:ie,docBaseUrl:y,enableXfa:X,evaluatorOptions:{maxImageSize:N,disableFontFace:q,ignoreErrors:R,isEvalSupported:O,isOffscreenCanvasSupported:L,isImageDecoderSupported:H,canvasMaxAreaInBytes:V,fontExtraProperties:xe,useSystemFonts:ge,useWasm:U,useWorkerFetch:ke,cMapUrl:w,iccUrl:A,standardFontDataUrl:C,wasmUrl:E}},Le={ownerDocument:re,pdfBug:j,styleElement:Ee,loadingParams:{disableAutoFetch:K,enableXfa:X}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ot=p.messageHandler.sendWithPromise("GetDocRequest",Ie,i?[i.buffer]:null);let cn;if(h)cn=new f1(h,{disableRange:te,disableStream:J});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const _n=qr(n)?y1:Ut?E1:_1;cn=new _n({url:n,length:ie,httpHeaders:a,withCredentials:l,rangeChunkSize:d,disableRange:te,disableStream:J})}return ot.then(_n=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Rs=new Xr(t,_n,p.port),Zi=new D1(Rs,e,cn,Le,oe,D);e._transport=Zi,Rs.send("Ready",null)})}).catch(e._capability.reject),e}class sd{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${sd.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Qy{#e=Promise.withResolvers();#t=[];#s=[];#n=[];#a=[];constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){this.#a.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#s.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#a)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#n)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#s)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){We("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class M1{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Pe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class I1{#e=!1;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new Ym:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new Ky,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:a=!1}={}){return new ya({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Pe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:i="display",annotationMode:a=Ts.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:y=!1,recordOperations:w=!1,operationsFilter:_=null}){this._stats?.time("Overall");const b=this._transport.getRenderingIntent(i,a,m,y),{renderingIntent:A,cacheKey:C}=b;this.#e=!1,h||=this._transport.getOptionalContentConfig(A);let k=this._intentStates.get(C);k||(k=Object.create(null),this._intentStates.set(C,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const E=!!(A&on.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(b));const P=!!(this._pdfBug&&globalThis.StepperManager?.enabled),R=!this.recordedBBoxes&&(w||P),N=H=>{if(k.renderTasks.delete(O),R){const V=O.gfx?.dependencyTracker.take();V&&(O.stepper&&O.stepper.setOperatorBBoxes(V,O.gfx.dependencyTracker.takeDebugMetadata()),w&&(this.recordedBBoxes=V))}E&&(this.#e=!0),this.#t(),H?(O.capability.reject(H),this._abortOperatorList({intentState:k,reason:H instanceof Error?H:new Error(H)})):O.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},O=new zi({callback:N,params:{canvas:t,canvasContext:e,dependencyTracker:R?new QA(t,k.operatorList.length,P):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:_});(k.renderTasks||=new Set).add(O);const L=O.task;return Promise.all([k.displayReadyCapability.promise,h]).then(([H,V])=>{if(this.destroyed){N();return}if(this._stats?.time("Rendering"),!(V.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");O.initializeGraphics({transparency:H,optionalContentConfig:V}),O.operatorListChanged()}).catch(N),L}getOperatorList({intent:e="display",annotationMode:t=Ts.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,n,i,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>da.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function a(){l.read().then(function({value:h,done:d}){if(d){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),a()},i)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Ym),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:a,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:i},l).getReader(),d=this._intentStates.get(t);d.streamReader=h;const p=()=>{h.read().then(({value:m,done:y})=>{if(y){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),p())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const y of d.renderTasks)y.operatorListChanged();this.#t()}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Kh){let i=R1;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Ps(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}class Tt{#e=Promise.withResolvers();#t=null;#s=null;#n=null;static#a=0;static#r=!1;static#i=new WeakMap;static{Ut&&(this.#r=!0,qi.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const i=new URL(t,n);return n.origin===i.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},this.fromPort=e=>{if(CA("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.create(e)}}constructor({name:e=null,port:t=null,verbosity:n=fA()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(Tt.#i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");Tt.#i.set(t,this),this.#c(t)}else this.#l()}get promise(){return this.#e.promise}#o(){this.#e.resolve(),this.#t.send("configure",{verbosity:this.verbosity})}get port(){return this.#s}get messageHandler(){return this.#t}#c(e){this.#s=e,this.#t=new Xr("main","worker",e),this.#t.on("ready",()=>{}),this.#o()}#l(){if(Tt.#r||Tt.#h){this.#d();return}let{workerSrc:e}=Tt;try{Tt._isSameOrigin(window.location,e)||(e=Tt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Xr("main","worker",t),i=()=>{a.abort(),n.destroy(),t.terminate(),this.destroyed?this.#e.reject(new Error("Worker was destroyed")):this.#d()},a=new AbortController;t.addEventListener("error",()=>{this.#n||i()},{signal:a.signal}),n.on("test",c=>{if(a.abort(),this.destroyed||!c){i();return}this.#t=n,this.#s=t,this.#n=t,this.#o()}),n.on("ready",c=>{if(a.abort(),this.destroyed){i();return}try{l()}catch{this.#d()}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{Ml("The worker has been disabled.")}this.#d()}#d(){Tt.#r||(Te("Setting up fake worker."),Tt.#r=!0),Tt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this.#e.reject(new Error("Worker was destroyed"));return}const t=new UA;this.#s=t;const n=`fake${Tt.#a++}`,i=new Xr(n+"_worker",n,t);e.setup(i,t),this.#t=new Xr(n,n+"_worker",t),this.#o()}).catch(e=>{this.#e.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this.#n?.terminate(),this.#n=null,Tt.#i.delete(this.#s),this.#s=null,this.#t?.destroy(),this.#t=null}static create(e){const t=this.#i.get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Tt(e)}static get workerSrc(){if(qi.workerSrc)return qi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#h(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Pe(this,"_setupFakeWorkerGlobal",(async()=>this.#h?this.#h:(await import(this.workerSrc)).WorkerMessageHandler)())}}class D1{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#a=null;constructor(e,t,n,i,a,l){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Ky,this.fontLoader=new OA({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#r(e,t=null){const n=this.#e.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return Pe(this,"annotationStorage",new Zh)}getRenderingIntent(e,t=Ts.ENABLE,n=null,i=!1,a=!1){let l=on.DISPLAY,c=vh;switch(e){case"any":l=on.ANY;break;case"display":break;case"print":l=on.PRINT;break;default:Te(`getRenderingIntent - invalid intent: ${e}`)}const h=l&on.PRINT&&n instanceof Fy?n:this.annotationStorage;switch(t){case Ts.DISABLE:l+=on.ANNOTATIONS_DISABLE;break;case Ts.ENABLE:break;case Ts.ENABLE_FORMS:l+=on.ANNOTATIONS_FORMS;break;case Ts.ENABLE_STORAGE:l+=on.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Te(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(l+=on.IS_EDITING),a&&(l+=on.OPLIST);const{ids:d,hash:p}=h.modifiedIds,m=[l,c.hash,p];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),zt.cleanup(),this._networkStream?.cancelAllRequests(new Ps("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{Fe(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){i.close();return}Fe(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:l}=this._fullReader;return(!i||!a)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:l}}),e.on("GetRangeReader",(n,i)=>{Fe(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){i.close();return}Fe(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{a.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new M1(n,this))}),e.on("DocException",n=>{t._capability.reject(Yt(n))}),e.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!t.onPassword)throw Yt(n);const i=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};t.onPassword(i,n.code)}catch(i){this.#a.reject(i)}return this.#a.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in a){const m=a.error;Te(`Error during font loading: ${m}`),this.commonObjs.resolve(n,m);break}const l=new He(a),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(m,y)=>globalThis.FontInspector.fontAdded(m,y):null,h=new FA(l,c,a.extra,a.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:d}=a;Fe(d,"The imageRef must be defined.");for(const m of this.#t.values())for(const[,y]of m.objs)if(y?.ref===d)return y.dataLen?(this.commonObjs.resolve(n,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(n,a);break;case"Pattern":const p=new bt(a);this.commonObjs.resolve(n,p.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,a,l])=>{if(this.destroyed)return;const c=this.#t.get(i);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Te("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#s.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#n.set(a.refStr,e);const l=new I1(t,a,this,this._params.pdfBug);return this.#t.set(t,l),l});return this.#s.set(t,i),i}getPageIndex(e){return wh(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#r("GetOptionalContentConfig").then(t=>new d1(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new u1(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:i[2]}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),zt.cleanup()}}cachedPageNumber(e){if(!wh(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class L1{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class zi{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:y=null,enableHWA:w=!1,operationsFilter:_=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=m,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new L1(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=w,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=_}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(zi.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");zi.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Gi(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),zi.#t.delete(this._canvas),e||=new Kh(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),zi.#t.delete(this._canvas),this.callback())))}}const O1="5.4.449",F1="f44e5f0e6";class vn{#e=null;#t=null;#s;#n=null;#a=!1;#r=!1;#i=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Pe(this,"_keyboardManager",new wa([[["Escape","mac+Escape"],vn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],vn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],vn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],vn.prototype._moveToPrevious],[["Home","mac+Home"],vn.prototype._moveToBeginning],[["End","mac+End"],vn.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#r=!1,this.#i=e):this.#r=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#s=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",vn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#i&&(e.ariaControls=`${this.#i.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#g.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#s,e.append(n),e}renderMainDropdown(){const e=this.#n=this.#h();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#h(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",xn,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#i&&(e.id=`${this.#i.id}_colorpicker_dropdown`);for(const[n,i]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=n,a.setAttribute("data-l10n-id",vn.#d[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=i,a.ariaSelected=i===this.#s,a.addEventListener("click",this.#f.bind(this,i),{signal:t}),e.append(a)}return e.addEventListener("keydown",this.#g.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Oe.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#m(e);return}if(e.target===this.#e){this.#n.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstElementChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#m(e);return}this.#n.firstElementChild?.focus()}_moveToEnd(e){if(!this.#p){this.#m(e);return}this.#n.lastElementChild?.focus()}#g(e){vn._keyboardManager.exec(this,e)}#m(e){if(this.#p){this.hideDropdown();return}if(this.#a=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#h();this.#e.append(t)}#u(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#i?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class fa{#e=null;#t=null;#s=null;static#n=null;constructor(e){this.#t=e,this.#s=e._uiManager,fa.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:n}=this.#t,i=this.#e=document.createElement("input");return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",fa.#n[e]),i.addEventListener("input",()=>{this.#s.updateParams(t,i.value)},{signal:this.#s._signal}),i}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function vg(o){return Math.floor(Math.max(0,Math.min(1,o))*255).toString(16).padStart(2,"0")}function Wr(o){return Math.max(0,Math.min(255,255*o))}class wg{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Wr(e),[e,e,e]}static G_HTML([e]){const t=vg(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Wr)}static RGB_HTML(e){return`#${e.map(vg).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[Wr(1-Math.min(1,e+i)),Wr(1-Math.min(1,n+i)),Wr(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,a=1-t,l=1-n,c=Math.min(i,a,l);return["CMYK",i,a,l,c]}}class j1{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){We("Abstract method `_createSVG` called.")}}class wl extends j1{_createSVG(e){return document.createElementNS(ns,e)}}const B1=9,Js=new WeakSet,$1=new Date().getTimezoneOffset()*60*1e3;class th{static create(e){switch(e.data.annotationType){case ut.LINK:return new id(e);case ut.TEXT:return new U1(e);case ut.WIDGET:switch(e.data.fieldType){case"Tx":return new H1(e);case"Btn":return e.data.radioButton?new Jy(e):e.data.checkBox?new V1(e):new G1(e);case"Ch":return new q1(e);case"Sig":return new W1(e)}return new ti(e);case ut.POPUP:return new _h(e);case ut.FREETEXT:return new Zy(e);case ut.LINE:return new K1(e);case ut.SQUARE:return new Y1(e);case ut.CIRCLE:return new Q1(e);case ut.POLYLINE:return new e0(e);case ut.CARET:return new Z1(e);case ut.INK:return new rd(e);case ut.POLYGON:return new J1(e);case ut.HIGHLIGHT:return new t0(e);case ut.UNDERLINE:return new eS(e);case ut.SQUIGGLY:return new tS(e);case ut.STRIKEOUT:return new nS(e);case ut.STAMP:return new n0(e);case ut.FILEATTACHMENT:return new sS(e);default:return new et(e)}}}class et{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return et._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:i}=this.data;let a=-1/0,l=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>l?(l=t[c+1],a=t[c+2]):t[c+1]===l&&(a=Math.max(a,t[c+2]));return[a,l]}if(n?.length>=1){for(const c of n)for(let h=0,d=c.length;h<d;h+=2)c[h+1]>l?(l=c[h+1],a=c[h]):c[h+1]===l&&(a=Math.max(a,c[h]));if(a!==1/0)return[a,l]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-a)/n,e[1]=100*(e[1]-l)/i,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${ua}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${ua}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#s?.popup||this.popup)?.remove(),this.#s=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#n(t);let i=this.#s?.popup||this.popup;!i&&n?.text&&(this._createPopup(n),i=this.#s.popup),i&&(i.updateEdited(e),n?.deleted&&(i.remove(),this.#s=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(l-e[3]+h)/l}%`,i===0?(t.width=`${100*(e[2]-e[0])/a}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),!(this instanceof ti)&&!(this instanceof id)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof _h){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,a),a}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(b>0||A>0){const k=`calc(${b}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;l.borderRadius=k}else if(this instanceof Jy){const k=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=k}switch(t.borderStyle.style){case Ii.SOLID:l.borderStyle="solid";break;case Ii.DASHED:l.borderStyle="dashed";break;case Ii.BEVELED:Te("Unimplemented border style: beveled");break;case Ii.INSET:Te("Unimplemented border style: inset");break;case Ii.UNDERLINE:l.borderBottomStyle="solid";break}const C=t.borderColor||null;C?(this.#t=!0,l.borderColor=ue.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):l.borderWidth=0}const d=ue.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:m,pageX:y,pageY:w}=i.rawDims;l.left=`${100*(d[0]-y)/p}%`,l.top=`${100*(d[1]-w)/m}%`;const{rotation:_}=t;return t.hasOwnCanvas||_===0?(l.width=`${100*c/p}%`,l.height=`${100*h/m}%`):this.setRotation(_,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:a,height:l}=this;e%180!==0&&([a,l]=[l,a]),t.style.width=`${100*a/n}%`,t.style.height=`${100*l/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const a=i.detail[t],l=a[0],c=a.slice(1);i.target.style[n]=wg[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:wg[`${l}_rgb`](c)})};return Pe(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||n[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,a]of Object.entries(t)){const l=n[i];if(l){const c={detail:{[i]:a},target:e};l(c),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,a]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,A,C,k]=e.subarray(2,6);if(i===b&&a===A&&t===C&&n===k)return}const{style:l}=this.container;let c;if(this.#t){const{borderColor:b,borderWidth:A}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const h=i-t,d=a-n,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const y=p.createElement("defs");m.append(y);const w=p.createElement("clipPath"),_=`clippath_${this.data.id}`;w.setAttribute("id",_),w.setAttribute("clipPathUnits","objectBoundingBox"),y.append(w);for(let b=2,A=e.length;b<A;b+=8){const C=e[b],k=e[b+1],E=e[b+2],P=e[b+3],R=p.createElement("rect"),N=(E-t)/h,O=(a-k)/d,L=(C-E)/h,H=(k-P)/d;R.setAttribute("x",N),R.setAttribute("y",O),R.setAttribute("width",L),R.setAttribute("height",H),w.append(R),c?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${O}" width="${L}" height="${H}"/>`)}this.#t&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${_})`}_createPopup(e=null){const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate),this.#s=new _h({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#s||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#s}render(){We("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:a,id:l,exportValues:c}of i){if(a===-1||l===t)continue;const h=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!Js.has(d)){Te(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:d})}return n}for(const i of document.getElementsByName(e)){const{exportValue:a}=i,l=i.getAttribute("data-element-id");l!==t&&Js.has(i)&&n.push({id:l,exportValue:a,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class z1 extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class id extends et{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(this.#s(n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=n,this.container.append(n)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",i=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#s(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const a=n.get(i);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Te('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:i,refs:a,include:l}=t,c=[];if(i.length!==0||a.length!==0){const p=new Set(a);for(const m of i){const y=this._fieldObjects[m]||[];for(const{id:w}of y)p.add(w)}for(const m of Object.values(this._fieldObjects))for(const y of m)p.has(y.id)===l&&c.push(y)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,d=[];for(const p of c){const{id:m}=p;switch(d.push(m),p.type){case"text":{const w=p.defaultValue||"";h.setValue(m,{value:w});break}case"checkbox":case"radiobutton":{const w=p.defaultValue===p.exportValues;h.setValue(m,{value:w});break}case"combobox":case"listbox":{const w=p.defaultValue||"";h.setValue(m,{value:w});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!Js.has(y)){Te(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class U1 extends et{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class ti extends et{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Mt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,a){n.includes("mouse")?e.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(l)}})})}_setEventListeners(e,t,n,i){for(const[a,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,a,l,i),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ue.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||B1,a=e.style;let l;const c=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(d/(qu*i))||1,m=d/p;l=Math.min(i,h(m/qu))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(i,h(d/qu))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=ue.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class H1 extends ti{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const a=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),a.setValue(l.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let a=i.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=i.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Js.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:m}=this.data,y=!!p&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",_=>{e.setValue(t,{value:_.target.value}),this.setPropertyOnSiblings(n,"value",_.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",_=>{const b=this.data.defaultFieldValue??"";n.value=h.userValue=b,h.formattedValue=null});let w=_=>{const{formattedValue:b}=h;b!=null&&(_.target.value=b),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",b=>{if(h.focused)return;const{target:A}=b;if(y&&(A.type=p,m&&(A.step=m)),h.userValue){const C=h.userValue;if(y)if(p==="time"){const k=new Date(C),E=[k.getHours(),k.getMinutes(),k.getSeconds()];A.value=E.map(P=>P.toString().padStart(2,"0")).join(":")}else A.value=new Date(C-$1).toISOString().split(p==="date"?"T":".",1)[0];else A.value=C}h.lastCommittedValue=A.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const A={value(C){h.userValue=C.detail.value??"",y||e.setValue(t,{value:h.userValue.toString()}),C.target.value=h.userValue},formattedValue(C){const{formattedValue:k}=C.detail;h.formattedValue=k,k!=null&&C.target!==document.activeElement&&(C.target.value=k);const E={formattedValue:k};y&&(E.value=k),e.setValue(t,E)},selRange(C){C.target.setSelectionRange(...C.detail.selRange)},charLimit:C=>{const{charLimit:k}=C.detail,{target:E}=C;if(k===0){E.removeAttribute("maxLength");return}E.setAttribute("maxLength",k);let P=h.userValue;!P||P.length<=k||(P=P.slice(0,k),E.value=h.userValue=P,e.setValue(t,{value:P}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:E.selectionStart,selEnd:E.selectionEnd}}))}};this._dispatchEventFromSandbox(A,b)}),n.addEventListener("keydown",b=>{h.commitKey=1;let A=-1;if(b.key==="Escape"?A=0:b.key==="Enter"&&!this.data.multiLine?A=2:b.key==="Tab"&&(h.commitKey=3),A===-1)return;const{value:C}=b.target;h.lastCommittedValue!==C&&(h.lastCommittedValue=C,h.userValue=C,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:A,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const _=w;w=null,n.addEventListener("blur",b=>{if(!h.focused||!b.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:A}=b;let{value:C}=A;if(y){if(C&&p==="time"){const k=C.split(":").map(E=>parseInt(E,10));C=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),A.step=""}else C.includes("T")||(C=`${C}T00:00`),C=new Date(C).valueOf();A.type="text"}h.userValue=C,h.lastCommittedValue!==C&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:h.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}),_(b)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",b=>{h.lastCommittedValue=null;const{data:A,target:C}=b,{value:k,selectionStart:E,selectionEnd:P}=C;let R=E,N=P;switch(b.inputType){case"deleteWordBackward":{const O=k.substring(0,E).match(/\w*[^\w]*$/);O&&(R-=O[0].length);break}case"deleteWordForward":{const O=k.substring(E).match(/^[^\w]*\w*/);O&&(N+=O[0].length);break}case"deleteContentBackward":E===P&&(R-=1);break;case"deleteContentForward":E===P&&(N+=1);break}b.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,change:A||"",willCommit:!1,selStart:R,selEnd:N}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(w&&n.addEventListener("blur",w),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class W1 extends ti{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class V1 extends ti{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Js.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n)){const p=h&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=p),e.setValue(d.id,{value:p})}e.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Jy extends ti{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const a=document.createElement("input");if(Js.add(a),a.setAttribute("data-element-id",n),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n))e.setValue(d.id,{value:!1});e.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const h={value:d=>{const p=l===d.detail.value;for(const m of this._getElementsByName(d.target.name)){const y=p&&m.id===n;m.domElement&&(m.domElement.checked=y),e.setValue(m.id,{value:y})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class G1 extends id{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class q1 extends ti{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Js.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const y of i.options)y.selected=y.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,n.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),a=!1),i.append(m)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),i.prepend(p),l=()=>{p.remove(),i.removeEventListener("input",l),l=null},i.addEventListener("input",l)}const c=p=>{const m=p?"value":"textContent",{options:y,multiple:w}=i;return w?Array.prototype.filter.call(y,_=>_.selected).map(_=>_[m]):y.selectedIndex===-1?null:y[y.selectedIndex][m]};let h=c(!1);const d=p=>{const m=p.target.options;return Array.prototype.map.call(m,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",p=>{const m={value(y){l?.();const w=y.detail.value,_=new Set(Array.isArray(w)?w:[w]);for(const b of i.options)b.selected=_.has(b.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(y){i.multiple=!0},remove(y){const w=i.options,_=y.detail.remove;w[_].selected=!1,i.remove(_),w.length>0&&Array.prototype.findIndex.call(w,A=>A.selected)===-1&&(w[0].selected=!0),e.setValue(t,{value:c(!0),items:d(y)}),h=c(!1)},clear(y){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(y){const{index:w,displayValue:_,exportValue:b}=y.detail.insert,A=i.children[w],C=document.createElement("option");C.textContent=_,C.value=b,A?A.before(C):i.append(C),e.setValue(t,{value:c(!0),items:d(y)}),h=c(!1)},items(y){const{items:w}=y.detail;for(;i.length!==0;)i.remove(0);for(const _ of w){const{displayValue:b,exportValue:A}=_,C=document.createElement("option");C.textContent=b,C.value=A,i.append(C)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:c(!0),items:d(y)}),h=c(!1)},indices(y){const w=new Set(y.detail.indices);for(const _ of y.target.options)_.selected=w.has(_.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(m,p)}),i.addEventListener("input",p=>{const m=c(!0),y=c(!1);e.setValue(t,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:y,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):i.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class _h extends et{constructor(e){const{data:t,elements:n,parent:i}=e,a=!!i._commentManager;if(super(e,{isRenderable:!a&&et._hasPopupData(t)}),this.elements=n,a&&et._hasPopupData(t)){const l=this.popup=this.#e();for(const c of n)c.popup=l}else this.popup=null}#e(){return new X1({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(i=>`${Bi}${i}`).join(",")),this.container}}class X1{#e=null;#t=this.#W.bind(this);#s=this.#B.bind(this);#n=this.#I.bind(this);#a=this.#_.bind(this);#r=null;#i=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#w=null;#v=null;#C=null;#A=null;#x=null;#E=!1;#b=null;#S=null;constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:a,contentsObj:l,richText:c,parent:h,rect:d,parentRect:p,open:m,commentManager:y=null}){this.#i=e,this.#A=i,this.#o=l,this.#C=c,this.#d=h,this.#r=t,this.#v=d,this.#h=p,this.#l=n,this.#e=y,this.#b=n[0],this.#c=mh.toDateObject(a),this.trigger=n.flatMap(w=>w.getElementsToTriggerPopup()),y||(this.#N(),this.#i.hidden=!0,m&&this.#_())}#N(){if(this.#m)return;this.#m=new AbortController;const{signal:e}=this.#m;for(const t of this.trigger)t.addEventListener("click",this.#a,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#s,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#T(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#b.container.after(this.#p);return}if(this.#y||this.#T(),!this.#y)return;const{signal:e}=this.#m=new AbortController,t=this.#b.hasOwnCommentButton,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},a=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#b.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#t,{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",i,{signal:e}),l.addEventListener("pointerleave",a,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=this.#p=document.createElement("button");l.className="annotationCommentButton";const c=this.#b.container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#F(),this.#P(),l.addEventListener("keydown",this.#t,{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",i,{signal:e}),l.addEventListener("pointerleave",a,{signal:e}),c.after(l)}}#P(){if(this.#b.extraPopupElement&&!this.#b.editor)return;this.#p||this.renderCommentButton();const[e,t]=this.#y,{style:n}=this.#p;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#F(){this.#b.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#b.commentData;return e?this.#d._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:a}=this.#b.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#S||=this.#b.commentText,this.#S}set comment(e){e!==this.comment&&(this.#b.commentText=this.#S=e)}focus(){this.#b.container?.focus()}get parentBoundingClientRect(){return this.#b.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#w)return this.#w;const{x:e,y:t,height:n}=this.#p.getBoundingClientRect(),{x:i,y:a,width:l,height:c}=this.#b.layer.getBoundingClientRect();return[(e-i)/l,(t+n-a)/c]}set commentPopupPosition(e){this.#w=e}hasDefaultPopupPosition(){return this.#w===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#w||this.commentButtonPosition.map(d=>d/100),i=this.parentBoundingClientRect,{x:a,y:l,width:c,height:h}=i;this.#e.showDialog(null,this,a+t*c,l+n*h,{...e,parentDimensions:i})}render(){if(this.#g)return;const e=this.#g=document.createElement("div");if(e.className="popup",this.#r){const n=e.style.outlineColor=ue.makeHexColor(...this.#r);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#A?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#A}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}Iy({html:this.#M||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#i.append(e)}get#M(){const e=this.#C,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#C.html||null}get#D(){return this.#M?.attributes?.style?.fontSize||0}get#j(){return this.#M?.attributes?.style?.color||null}#L(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#j,fontSize:this.#D?`calc(${this.#D}px * var(--total-scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:i});return n}#W(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#_()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#S=null):t&&(t.deleted?this.remove():(this.#F(),this.#S=t.text)),e&&(this.#y=null,this.#T(),this.#P());return}if(n||t?.deleted){this.remove();return}this.#N(),this.#x||={contentsObj:this.#o,richText:this.#C},e&&(this.#u=null),t&&t.text&&(this.#C=this.#L(t.text),this.#c=mh.toDateObject(t.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#x&&({contentsObj:this.#o,richText:this.#C}=this.#x,this.#x=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#E=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#k(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:a}}}=this.#d;let l=!!this.#h,c=l?this.#h:this.#v;for(const _ of this.#l)if(!c||ue.intersect(_.data.rect,c)!==null){c=_.data.rect,l=!0;break}const h=ue.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=l?c[2]-c[0]+5:0,m=h[0]+p,y=h[1];this.#u=[100*(m-i)/t,100*(y-a)/n];const{style:w}=this.#i;w.left=`${this.#u[0]}%`,w.top=`${this.#u[1]}%`}#_(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#I(),this.#i.addEventListener("click",this.#a),this.#i.addEventListener("keydown",this.#t)):(this.#B(),this.#i.removeEventListener("click",this.#a),this.#i.removeEventListener("keydown",this.#t))}#I(){this.#g||this.render(),this.isVisible?this.#f&&this.#i.classList.add("focused"):(this.#k(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#B(){this.#i.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#E=this.isVisible,this.#E&&(this.#i.hidden=!0)}maybeShow(){this.#e||(this.#N(),this.#E&&(this.#g||this.#I(),this.#E=!1,this.#i.hidden=!1))}get isVisible(){return this.#e?!1:this.#i.hidden===!1}}class Zy extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ne.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class K1 extends et{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Y1 extends et{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",t-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Q1 extends et{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),a=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",t/2),l.setAttribute("cy",n/2),l.setAttribute("rx",t/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class e0 extends et{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:a,height:l}=this;if(!t)return this.container;const c=this.svgFactory.create(a,l,!0);let h=[];for(let p=0,m=t.length;p<m;p+=2){const y=t[p]-e[0],w=e[3]-t[p+1];h.push(`${y},${w}`)}h=h.join(" ");const d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class J1 extends e0{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z1 extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class rd extends et{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ne.HIGHLIGHT:Ne.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:a}}=this,{transform:l,width:c,height:h}=this.#s(t,e),d=this.svgFactory.create(c,h,!0),p=this.#e=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let m=0,y=n.length;m<y;m++){const w=this.svgFactory.createElement(this.svgElementName);this.#t.push(w),w.setAttribute("points",n[m].join(",")),p.append(w)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,a=this.#e;if(t>=0&&a.setAttribute("stroke-width",t||1),n)for(let l=0,c=this.#t.length;l<c;l++)this.#t[l].setAttribute("points",n[l].join(","));if(i){const{transform:l,width:c,height:h}=this.#s(this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class t0 extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ne.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class eS extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class tS extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class nS extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class n0 extends et{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ne.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class sS extends et{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:i}=Mt.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class ad{#e=null;#t=null;#s=null;#n=new Map;#a=null;#r=null;#i=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:l,structTreeLayer:c,commentManager:h,linkService:d,annotationStorage:p}){this.div=e,this.#e=t,this.#t=n,this.#a=c||null,this.#r=d||null,this.#s=p||new Zh,this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(e){const{annotations:t}=e,n=this.div;Qs(n,this.viewport);const i=new Map,a=[],l={data:null,layer:n,linkService:this.#r,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new wl,annotationStorage:this.#s,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===ut.POPUP;if(h){const m=i.get(c.id);if(!m)continue;if(!this._commentManager){a.push(c);continue}l.elements=m}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;l.data=c;const d=th.create(l);if(!d.isRenderable)continue;if(!h&&(this.#i.push(d),c.popupRef)){const m=i.get(c.popupRef);m?m.push(d):i.set(c.popupRef,[d])}const p=d.render();c.hidden&&(p.style.visibility="hidden"),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}await this.#c();for(const c of a){const h=l.elements=i.get(c.id);l.data=c;const d=th.create(l);if(!d.isRenderable)continue;const p=d.render();d.contentElement.id=`${Bi}${c.id}`,c.hidden&&(p.style.visibility="hidden"),h.at(-1).container.after(p)}this.#l()}async#c(){if(this.#i.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:i}}of this.#i){const a=n.id=`${Bi}${i}`;e.push(this.#a?.getAriaAttributes(a).then(l=>{if(l)for(const[c,h]of l)n.setAttribute(c,h)}))}}this.#i.sort(({data:{rect:[n,i,a,l]}},{data:{rect:[c,h,d,p]}})=>{if(n===a&&i===l)return 1;if(c===d&&h===p)return-1;const m=l,y=i,w=(i+l)/2,_=p,b=h,A=(h+p)/2;if(w>=_&&A<=y)return-1;if(A>=m&&w<=b)return 1;const C=(n+a)/2,k=(c+d)/2;return C-k});const t=document.createDocumentFragment();for(const n of this.#i)t.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&t.append(n.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const n of this.#i)this.#e.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#r,svgFactory:new wl,parent:this};for(const n of e){n.borderStyle||=ad._defaultBorderStyle,t.data=n;const i=th.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${Bi}${n.id}`,this.#i.push(i))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,Qs(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):i.append(n);const l=this.#n.get(t);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,a=new z1({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#s});return a.render(),a.contentElement.id=`${Bi}${n}`,a.createOrUpdatePopup(),this.#i.push(a),a}removeAnnotation(e){const t=this.#i.findIndex(i=>i.data.id===e);if(t<0)return;const[n]=this.#i.splice(t,1);this.#e?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Pe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Ii.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Vo=/\r\n?|\n/g;class xt extends we{#e="";#t=`${this.id}-editor`;#s=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=xt.prototype,t=a=>a.isEmpty(),n=Ns.TRANSLATE_SMALL,i=Ns.TRANSLATE_BIG;return Pe(this,"_keyboardManager",new wa([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=Ne.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||xt._defaultColor||we._defaultLineColor,this.#n=e.fontSize||xt._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){we.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Oe.FREETEXT_SIZE:xt._defaultFontSize=t;break;case Oe.FREETEXT_COLOR:xt._defaultColor=t;break}}updateParams(e,t){switch(e){case Oe.FREETEXT_SIZE:this.#a(t);break;case Oe.FREETEXT_COLOR:this.#r(t);break}}static get defaultPropertiesToUpdate(){return[[Oe.FREETEXT_SIZE,xt._defaultFontSize],[Oe.FREETEXT_COLOR,xt._defaultColor||we._defaultLineColor]]}get propertiesToUpdate(){return[[Oe.FREETEXT_SIZE,this.#n],[Oe.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new fa(this),[["colorPicker",this._colorPicker]]}get colorType(){return Oe.FREETEXT_COLOR}#a(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#n)*this.parentScale),this.#n=i,this.#o()},n=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Oe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(e){const t=i=>{this.color=i,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Oe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-xt._internalPadding*e,-(xt._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;const e=this._uiManager.combinedSignal(this.#s);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#i(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(xt.#c(n)),t=n);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#i().trimEnd();if(e===t)return;const n=i=>{if(this.#e=i,!i){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){xt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[d,p]=this.pageDimensions,[m,y]=this.pageTranslation;let w,_;switch(this.rotation){case 0:w=e+(l[0]-m)/d,_=t+this.height-(l[1]-y)/p;break;case 90:w=e+(l[0]-m)/d,_=t-(l[1]-y)/p,[c,h]=[h,-c];break;case 180:w=e-this.width+(l[0]-m)/d,_=t-(l[1]-y)/p,[c,h]=[-c,-h];break;case 270:w=e+(l[0]-m-this.height*p)/d,_=t+(l[1]-y-this.width*d)/p,[c,h]=[-h,c];break}this.setAt(w*i,_*a,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Vo,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const i=xt.#h(t.getData("text")||"").replaceAll(Vo,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!i.includes(`
`)){l.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=l,d=[],p=[];if(c.nodeType===Node.TEXT_NODE){const w=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(Vo,"")),w!==this.editorDiv){let _=d;for(const b of this.editorDiv.childNodes){if(b===w){_=p;continue}_.push(xt.#c(b))}}d.push(c.nodeValue.slice(0,h).replaceAll(Vo,""))}else if(c===this.editorDiv){let w=d,_=0;for(const b of this.editorDiv.childNodes)_++===h&&(w=p),w.push(xt.#c(b))}this.#e=`${d.join(`
`)}${i}${p.join(`
`)}`,this.#l();const m=new Range;let y=Math.sumPrecise(d.map(w=>w.length));for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const _=w.nodeValue.length;if(y<=_){m.setStart(w,y),m.setEnd(w,y);break}y-=_}a.removeAllRanges(),a.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#e.replaceAll(""," ")}static#h(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=xt._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let i=null;if(e instanceof Zy){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:d,id:p,popupRef:m,richText:y,contentsObj:w,creationDate:_,modificationDate:b},textContent:A,textPosition:C,parent:{page:{pageNumber:k}}}=e;if(!A||A.length===0)return null;i=e={annotationType:Ne.FREETEXT,color:Array.from(c),fontSize:l,value:A.join(`
`),position:C,pageIndex:k-1,rect:h.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:w?.str||null,richText:y,creationDate:_,modificationDate:b}}const a=await super.deserialize(e,t,n);return a.#n=e.fontSize,a.color=ue.makeHexColor(...e.color),a.#e=xt.#h(e.value),a._initialData=i,e.comment&&a.setCommentData(e),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=we._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#d()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((l,c)=>l!==i[c])||e.pageIndex!==a}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const i of this.#e.split(`
`)){const a=document.createElement("div");a.append(i?document.createTextNode(i):document.createElement("br")),t.append(a)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ce{static PRECISION=1e-4;toSVGPath(){We("Abstract method `toSVGPath` must be implemented.")}get box(){We("Abstract getter `box` must be implemented.")}serialize(e,t){We("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,a,l){l||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c]*i,l[c+1]=n+e[c+1]*a;return l}static _rescaleAndSwap(e,t,n,i,a,l){l||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c+1]*i,l[c+1]=n+e[c]*a;return l}static _translate(e,t,n,i){i||=new Float32Array(e.length);for(let a=0,l=e.length;a<l;a+=2)i[a]=t+e[a],i[a+1]=n+e[a+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,a){switch(a){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,a,l){return[(e+5*n)/6,(t+5*i)/6,(5*n+a)/6,(5*i+l)/6,(n+a)/2,(i+l)/2]}}class Xs{#e;#t=[];#s;#n;#a=[];#r=new Float32Array(18);#i;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=Xs.#g+Xs.#m;constructor({x:e,y:t},n,i,a,l,c=0){this.#e=n,this.#h=a*i,this.#n=l,this.#r.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=c,this.#l=Xs.#g*i,this.#c=Xs.#u*i,this.#d=i,this.#f.push(e,t)}isEmpty(){return isNaN(this.#r[8])}#p(){const e=this.#r.subarray(4,6),t=this.#r.subarray(16,18),[n,i,a,l]=this.#e;return[(this.#i+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-i)/l,(this.#i+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-i)/l]}add({x:e,y:t}){this.#i=e,this.#o=t;const[n,i,a,l]=this.#e;let[c,h,d,p]=this.#r.subarray(8,12);const m=e-d,y=t-p,w=Math.hypot(m,y);if(w<this.#c)return!1;const _=w-this.#l,b=_/w,A=b*m,C=b*y;let k=c,E=h;c=d,h=p,d+=A,p+=C,this.#f?.push(e,t);const P=-C/_,R=A/_,N=P*this.#h,O=R*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([d+N,p+O],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([d-N,p-O],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([c+N,h+O],2),this.#a.push(NaN,NaN,NaN,NaN,(c+N-n)/a,(h+O-i)/l),this.#r.set([c-N,h-O],14),this.#t.push(NaN,NaN,NaN,NaN,(c-N-n)/a,(h-O-i)/l)),this.#r.set([k,E,c,h,d,p],6),!this.isEmpty()):(this.#r.set([k,E,c,h,d,p],6),Math.abs(Math.atan2(E-h,k-c)-Math.atan2(C,A))<Math.PI/2?([c,h,d,p]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((c+d)/2-n)/a,((h+p)/2-i)/l),[c,h,k,E]=this.#r.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((k+c)/2-n)/a,((E+h)/2-i)/l),!0):([k,E,c,h,d,p]=this.#r.subarray(0,6),this.#a.push(((k+5*c)/6-n)/a,((E+5*h)/6-i)/l,((5*c+d)/6-n)/a,((5*h+p)/6-i)/l,((c+d)/2-n)/a,((h+p)/2-i)/l),[d,p,c,h,k,E]=this.#r.subarray(12,18),this.#t.push(((k+5*c)/6-n)/a,((E+5*h)/6-i)/l,((5*c+d)/6-n)/a,((5*h+p)/6-i)/l,((c+d)/2-n)/a,((h+p)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#a,t=this.#t;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#v(n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#w(n),n.join(" ")}#y(){const[e,t,n,i]=this.#e,[a,l,c,h]=this.#p();return`M${(this.#r[2]-e)/n} ${(this.#r[3]-t)/i} L${(this.#r[4]-e)/n} ${(this.#r[5]-t)/i} L${a} ${l} L${c} ${h} L${(this.#r[16]-e)/n} ${(this.#r[17]-t)/i} L${(this.#r[14]-e)/n} ${(this.#r[15]-t)/i} Z`}#w(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,n,i,a]=this.#e,l=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,d,p,m]=this.#p();e.push(`L${(l[0]-t)/i} ${(l[1]-n)/a} L${h} ${d} L${p} ${m} L${(c[0]-t)/i} ${(c[1]-n)/a}`)}newFreeDrawOutline(e,t,n,i,a,l){return new s0(e,t,n,i,a,l)}getOutlines(){const e=this.#a,t=this.#t,n=this.#r,[i,a,l,c]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let m=0,y=h.length-2;m<y;m+=2)h[m]=(this.#f[m]-i)/l,h[m+1]=(this.#f[m+1]-a)/c;if(h[h.length-2]=(this.#i-i)/l,h[h.length-1]=(this.#o-a)/c,isNaN(n[6])&&!this.isEmpty())return this.#C(h);const d=new Float32Array(this.#a.length+24+this.#t.length);let p=e.length;for(let m=0;m<p;m+=2){if(isNaN(e[m])){d[m]=d[m+1]=NaN;continue}d[m]=e[m],d[m+1]=e[m+1]}p=this.#x(d,p);for(let m=t.length-6;m>=6;m-=6)for(let y=0;y<6;y+=2){if(isNaN(t[m+y])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=t[m+y],d[p+1]=t[m+y+1],p+=2}return this.#A(d,p),this.newFreeDrawOutline(d,h,this.#e,this.#d,this.#s,this.#n)}#C(e){const t=this.#r,[n,i,a,l]=this.#e,[c,h,d,p]=this.#p(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-n)/a,(t[3]-i)/l,NaN,NaN,NaN,NaN,(t[4]-n)/a,(t[5]-i)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(t[16]-n)/a,(t[17]-i)/l,NaN,NaN,NaN,NaN,(t[14]-n)/a,(t[15]-i)/l],0),this.newFreeDrawOutline(m,e,this.#e,this.#d,this.#s,this.#n)}#A(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#x(e,t){const n=this.#r.subarray(4,6),i=this.#r.subarray(16,18),[a,l,c,h]=this.#e,[d,p,m,y]=this.#p();return e.set([NaN,NaN,NaN,NaN,(n[0]-a)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,m,y,NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-l)/h],t),t+=24}}class s0 extends ce{#e;#t=new Float32Array(4);#s;#n;#a;#r;#i;constructor(e,t,n,i,a,l){super(),this.#i=e,this.#a=t,this.#e=n,this.#r=i,this.#s=a,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,d,p]=this.#t;for(let m=0,y=e.length;m<y;m+=2)e[m]=(e[m]-c)/d,e[m+1]=(e[m+1]-h)/p;for(let m=0,y=t.length;m<y;m+=2)t[m]=(t[m]-c)/d,t[m+1]=(t[m+1]-h)/p}toSVGPath(){const e=[`M${this.#i[4]} ${this.#i[5]}`];for(let t=6,n=this.#i.length;t<n;t+=6){if(isNaN(this.#i[t])){e.push(`L${this.#i[t+4]} ${this.#i[t+5]}`);continue}e.push(`C${this.#i[t]} ${this.#i[t+1]} ${this.#i[t+2]} ${this.#i[t+3]} ${this.#i[t+4]} ${this.#i[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,i],a){const l=n-e,c=i-t;let h,d;switch(a){case 0:h=ce._rescale(this.#i,e,i,l,-c),d=ce._rescale(this.#a,e,i,l,-c);break;case 90:h=ce._rescaleAndSwap(this.#i,e,t,l,c),d=ce._rescaleAndSwap(this.#a,e,t,l,c);break;case 180:h=ce._rescale(this.#i,n,t,-l,c),d=ce._rescale(this.#a,n,t,-l,c);break;case 270:h=ce._rescaleAndSwap(this.#i,n,i,-l,-c),d=ce._rescaleAndSwap(this.#a,n,i,-l,-c);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(e){const t=this.#i;let n=t[4],i=t[5];const a=[n,i,n,i];let l=n,c=i,h=n,d=i;const p=e?Math.max:Math.min,m=new Float32Array(4);for(let w=6,_=t.length;w<_;w+=6){const b=t[w+4],A=t[w+5];isNaN(t[w])?(ue.pointBoundingBox(b,A,a),c>A?(l=b,c=A):c===A&&(l=p(l,b)),d<A?(h=b,d=A):d===A&&(h=p(h,b))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,ue.bezierBoundingBox(n,i,...t.slice(w,w+6),m),ue.rectBoundingBox(m[0],m[1],m[2],m[3],a),c>m[1]?(l=m[0],c=m[1]):c===m[1]&&(l=p(l,m[0])),d<m[3]?(h=m[2],d=m[3]):d===m[3]&&(h=p(h,m[2]))),n=b,i=A}const y=this.#t;y[0]=a[0]-this.#s,y[1]=a[1]-this.#s,y[2]=a[2]-a[0]+2*this.#s,y[3]=a[3]-a[1]+2*this.#s,this.firstPoint=[l,c],this.lastPoint=[h,d]}get box(){return this.#t}newOutliner(e,t,n,i,a,l=0){return new Xs(e,t,n,i,a,l)}getNewOutline(e,t){const[n,i,a,l]=this.#t,[c,h,d,p]=this.#e,m=a*d,y=l*p,w=n*d+c,_=i*p+h,b=this.newOutliner({x:this.#a[0]*m+w,y:this.#a[1]*y+_},this.#e,this.#r,e,this.#n,t??this.#s);for(let A=2;A<this.#a.length;A+=2)b.add({x:this.#a[A]*m+w,y:this.#a[A+1]*y+_});return b.getOutlines()}}class Ah{#e;#t;#s;#n=[];#a=[];constructor(e,t=0,n=0,i=!0){const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:b,y:A,width:C,height:k}of e){const E=Math.floor((b-t)/l)*l,P=Math.ceil((b+C+t)/l)*l,R=Math.floor((A-t)/l)*l,N=Math.ceil((A+k+t)/l)*l,O=[E,R,N,!0],L=[P,R,N,!1];this.#n.push(O,L),ue.rectBoundingBox(E,R,P,N,a)}const c=a[2]-a[0]+2*n,h=a[3]-a[1]+2*n,d=a[0]-n,p=a[1]-n;let m=i?-1/0:1/0,y=1/0;const w=this.#n.at(i?-1:-2),_=[w[0],w[2]];for(const b of this.#n){const[A,C,k,E]=b;!E&&i?C<y?(y=C,m=A):C===y&&(m=Math.max(m,A)):E&&!i&&(C<y?(y=C,m=A):C===y&&(m=Math.min(m,A))),b[0]=(A-d)/c,b[1]=(C-p)/h,b[2]=(k-p)/h}this.#e=new Float32Array([d,p,c,h]),this.#t=[m,y],this.#s=_}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#r(e)}#r(e){const t=[],n=new Set;for(const l of e){const[c,h,d]=l;t.push([c,h,l],[c,d,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const h=t[l][2],d=t[l+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const i=[];let a;for(;n.size>0;){const l=n.values().next().value;let[c,h,d,p,m]=l;n.delete(l);let y=c,w=h;for(a=[c,d],i.push(a);;){let _;if(n.has(p))_=p;else if(n.has(m))_=m;else break;n.delete(_),[c,h,d,p,m]=_,y!==c&&(a.push(y,w,c,w===h?h:d),y=c),w=w===h?d:h}a.push(y,w)}return new iS(i,this.#e,this.#t,this.#s)}#i(e){const t=this.#a;let n=0,i=t.length-1;for(;n<=i;){const a=n+i>>1,l=t[a][0];if(l===e)return a;l<e?n=a+1:i=a-1}return i+1}#o([,e,t]){const n=this.#i(e);this.#a.splice(n,0,[e,t])}#c([,e,t]){const n=this.#i(e);for(let i=n;i<this.#a.length;i++){const[a,l]=this.#a[i];if(a!==e)break;if(a===e&&l===t){this.#a.splice(i,1);return}}for(let i=n-1;i>=0;i--){const[a,l]=this.#a[i];if(a!==e)break;if(a===e&&l===t){this.#a.splice(i,1);return}}}#l(e){const[t,n,i]=e,a=[[t,n,i]],l=this.#i(i);for(let c=0;c<l;c++){const[h,d]=this.#a[c];for(let p=0,m=a.length;p<m;p++){const[,y,w]=a[p];if(!(d<=y||w<=h)){if(y>=h){if(w>d)a[p][1]=d;else{if(m===1)return[];a.splice(p,1),p--,m--}continue}a[p][2]=h,w>d&&a.push([t,d,w])}}}return a}}class iS extends ce{#e;#t;constructor(e,t,n,i){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[n,i]=t;e.push(`M${n} ${i}`);for(let a=2;a<t.length;a+=2){const l=t[a],c=t[a+1];l===n?(e.push(`V${c}`),i=c):c===i&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,t,n,i],a){const l=[],c=n-e,h=i-t;for(const d of this.#t){const p=new Array(d.length);for(let m=0;m<d.length;m+=2)p[m]=e+d[m]*c,p[m+1]=i-d[m+1]*h;l.push(p)}return l}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Sh extends Xs{newFreeDrawOutline(e,t,n,i,a,l){return new rS(e,t,n,i,a,l)}}class rS extends s0{newOutliner(e,t,n,i,a,l=0){return new Sh(e,t,n,i,a,l)}}class at extends we{#e=null;#t=0;#s;#n=null;#a=null;#r=null;#i=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ne.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=at.prototype;return Pe(this,"_keyboardManager",new wa([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||at._defaultColor,this.#p=e.thickness||at._defaultThickness,this.opacity=e.opacity||at._defaultOpacity,this.#s=e.boxes||null,this.#y=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#h=!0,this.#v(e),this.#b()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#i=e.focusNode,this.#o=e.focusOffset,this.#w(),this.#b(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#w(){const e=new Ah(this.#s,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Ah(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#r=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:i}=this.#r;this.#g=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const i=1.5;if(this.#r=e.getNewOutline(this.#p/2+i,.0025),t>=0)this.#d=t,this.#n=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:at.#S(this.#l.box,(m-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:at.#S(this.#r.box,m),path:{d:this.#r.toSVGPath()}})}const[a,l,c,h]=e.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=h;break;case 90:{const[m,y]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*y/m,this.height=h*m/y;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[m,y]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*y/m,this.height=h*m/y;break}}const{firstPoint:d}=e;this.#f=[(d[0]-a)/c,(d[1]-l)/h];const{lastPoint:p}=this.#r;this.#g=[(p[0]-a)/c,(p[1]-l)/h]}static initialize(e,t){we.initialize(e,t),at._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Oe.HIGHLIGHT_COLOR:at._defaultColor=t;break;case Oe.HIGHLIGHT_THICKNESS:at._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case Oe.HIGHLIGHT_COLOR:this.#C(t);break;case Oe.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[Oe.HIGHLIGHT_COLOR,at._defaultColor],[Oe.HIGHLIGHT_THICKNESS,at._defaultThickness]]}get propertiesToUpdate(){return[[Oe.HIGHLIGHT_COLOR,this.color||at._defaultColor],[Oe.HIGHLIGHT_THICKNESS,this.#p||at._defaultThickness],[Oe.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#C(e){const t=(a,l)=>{this.color=a,this.opacity=l,this.onUpdatedColor()},n=this.color,i=this.opacity;this.addCommands({cmd:t.bind(this,e,at._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Oe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#A(e){const t=this.#p,n=i=>{this.#p=i,this.#x(i)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Oe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new vn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#E(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#b(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#E():e&&(this.#b(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#x(e){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#E(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#b(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#S([e,t,n,i],a){switch(a){case 90:return[1-t-i,e,i,n];case 180:return[1-e-n,1-t-i,n,i];case 270:return[t,1-e-n,i,n]}return[e,t,n,i]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#h?(e=(e-this.rotation+360)%360,n=at.#S(this.#l.box,e)):n=at.#S([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#m,{bbox:at.#S(this.#r.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#h?e.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(),Ly(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#N(e){at._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#i,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#T(!1))}get _mustFixPosition(){return!this.#h}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!e}}))}#P(){return this.#h?this.rotation:0}#F(){if(this.#h)return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,a=this.#s,l=new Float32Array(a.length*8);let c=0;for(const{x:h,y:d,width:p,height:m}of a){const y=h*e+n,w=(1-d)*t+i;l[c]=l[c+4]=y,l[c+1]=l[c+3]=w,l[c+2]=l[c+6]=y+p*e,l[c+5]=l[c+7]=w-m*t,c+=8}return l}#M(e){return this.#l.serialize(e,this.#P())}static startHighlighting(e,t,{target:n,x:i,y:a}){const{x:l,y:c,width:h,height:d}=n.getBoundingClientRect(),p=new AbortController,m=e.combinedSignal(p),y=w=>{p.abort(),this.#j(e,w)};window.addEventListener("blur",y,{signal:m}),window.addEventListener("pointerup",y,{signal:m}),window.addEventListener("pointerdown",st,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",xn,{signal:m}),n.addEventListener("pointermove",this.#D.bind(this,e),{signal:m}),this._freeHighlight=new Sh({x:i,y:a},[l,c,h,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#D(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#j(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let i=null;if(e instanceof t0){const{data:{quadPoints:_,rect:b,rotation:A,id:C,color:k,opacity:E,popupRef:P,richText:R,contentsObj:N,creationDate:O,modificationDate:L},parent:{page:{pageNumber:H}}}=e;i=e={annotationType:Ne.HIGHLIGHT,color:Array.from(k),opacity:E,quadPoints:_,boxes:null,pageIndex:H-1,rect:b.slice(0),rotation:A,annotationElementId:C,id:C,deleted:!1,popupRef:P,richText:R,comment:N?.str||null,creationDate:O,modificationDate:L}}else if(e instanceof rd){const{data:{inkLists:_,rect:b,rotation:A,id:C,color:k,borderStyle:{rawWidth:E},popupRef:P,richText:R,contentsObj:N,creationDate:O,modificationDate:L},parent:{page:{pageNumber:H}}}=e;i=e={annotationType:Ne.HIGHLIGHT,color:Array.from(k),thickness:E,inkLists:_,boxes:null,pageIndex:H-1,rect:b.slice(0),rotation:A,annotationElementId:C,id:C,deleted:!1,popupRef:P,richText:R,comment:N?.str||null,creationDate:O,modificationDate:L}}const{color:a,quadPoints:l,inkLists:c,opacity:h}=e,d=await super.deserialize(e,t,n);d.color=ue.makeHexColor(...a),d.opacity=h||1,c&&(d.#p=e.thickness),d._initialData=i,e.comment&&d.setCommentData(e);const[p,m]=d.pageDimensions,[y,w]=d.pageTranslation;if(l){const _=d.#s=[];for(let b=0;b<l.length;b+=8)_.push({x:(l[b]-y)/p,y:1-(l[b+1]-w)/m,width:(l[b+2]-l[b])/p,height:(l[b+1]-l[b+5])/m});d.#w(),d.#b(),d.rotate(d.rotation)}else if(c){d.#h=!0;const _=c[0],b={x:_[0]-y,y:m-(_[1]-w)},A=new Sh(b,[0,0,p,m],1,d.#p/2,!0,.001);for(let E=0,P=_.length;E<P;E+=2)b.x=_[E]-y,b.y=m-(_[E+1]-w),A.add(b);const{id:C,clipPathId:k}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);d.#v({highlightOutlines:A.getOutlines(),highlightId:C,clipPathId:k}),d.#b(),d.rotate(d.parentRotation)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=we._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#F(),outlines:this.#M(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#L(n)?null:(n.id=this.annotationElementId,n)}#L(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,i)=>n!==t[i])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class i0{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){We("Not implemented")}}class $e extends we{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#n=null;static#a=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#r(e),this.#c())}#r({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#i(e,this.parent),this.#h(e.box)}#i(e,t){const{id:n}=t.drawLayer.draw($e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,a]of Object.entries(t))n.has(i)?Object.assign(e[i],a):e[i]=a;return e}static getDefaultDrawingOptions(e){We("Not implemented")}static get typesMap(){We("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&($e.#s.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,a=i[t],l=c=>{i.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,$e._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,$e._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,$e._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#i(this.#e,e)}}#l([e,t,n,i]){const{parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(l/a),i*(a/l)];case 180:return[1-e,1-t,n,i];case 270:return[1-t,e,n*(l/a),i*(a/l)];default:return[e,t,n,i]}}#d(){const{x:e,y:t,width:n,height:i,parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(a/l),i*(l/a)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(a/l),i*(l/a)];default:return[e,t,n,i]}}#h(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:e,y:t,width:n,height:i,rotation:a,parentRotation:l,parentDimensions:[c,h]}=this;switch((a*4+l)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(c/h),i*(h/c),n*(c/h)];case 5:return[1-t,e,n*(c/h),i*(h/c)];case 6:return[1-e-i*(h/c),1-t,i*(h/c),n*(c/h)];case 7:return[t-n*(c/h),1-e-i*(h/c),n*(c/h),i*(h/c)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(h/c),t,i*(h/c),n*(c/h)];case 13:return[1-t-n*(c/h),e-i*(h/c),n*(c/h),i*(h/c)];case 14:return[1-e,1-t-n*(c/h),i*(h/c),n*(c/h)];case 15:return[t,1-e,n*(c/h),i*(h/c)];default:return[e,t,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,$e._mergeSVGProperties({bbox:this.#f()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");return n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,a){We("Not implemented")}static startDrawing(e,t,n,i){const{target:a,offsetX:l,offsetY:c,pointerId:h,pointerType:d}=i;if(ze.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:p}}=e,{width:m,height:y}=a.getBoundingClientRect(),w=$e.#n=new AbortController,_=e.combinedSignal(w);if(ze.setPointer(d,h),window.addEventListener("pointerup",b=>{ze.isSamePointerIdOrRemove(b.pointerId)&&this._endDraw(b)},{signal:_}),window.addEventListener("pointercancel",b=>{ze.isSamePointerIdOrRemove(b.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",b=>{ze.isSamePointerType(b.pointerType)&&(ze.initializeAndAddPointerId(b.pointerId),$e.#s.isCancellable()&&($e.#s.removeLastElement(),$e.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",xn,{signal:_}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),a.addEventListener("touchmove",b=>{ze.isSameTimeStamp(b.timeStamp)&&st(b)},{signal:_}),e.toggleDrawing(),t._editorUndoBar?.hide(),$e.#s){e.drawLayer.updateProperties(this._currentDrawId,$e.#s.startNew(l,c,m,y,p));return}t.updateUIForDefaultProperties(this),$e.#s=this.createDrawerInstance(l,c,m,y,p),$e.#a=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties($e.#a.toSVGProperties(),$e.#s.defaultSVGProperties),!0,!1)}static _drawMove(e){if(ze.isSameTimeStamp(e.timeStamp),!$e.#s)return;const{offsetX:t,offsetY:n,pointerId:i}=e;if(ze.isSamePointerId(i)){if(ze.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,$e.#s.add(t,n)),ze.setTimeStamp(e.timeStamp),st(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,$e.#s=null,$e.#a=null,ze.clearPointerType(),ze.clearTimeStamp()),$e.#n&&($e.#n.abort(),$e.#n=null,ze.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,$e.#s.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=$e.#s,i=this._currentDrawId,a=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,n.setLastElement(a))},undo:()=>{t.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:Oe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Oe.DRAW_STEP),!$e.#s.isEmpty()){const{pageDimensions:[n,i],scale:a}=t,l=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:$e.#s.getOutlines(n*a,i*a,a,this._INNER_MARGIN),drawingOptions:$e.#a,mustBeCommitted:!e});return this._cleanup(!0),l}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,a,l){We("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}=t.viewport,h=this.deserializeDraw(l,c,i,a,this._INNER_MARGIN,e),d=await super.deserialize(e,t,n);return d.createDrawingOptions(e),d.#r({drawOutlines:h}),d.#c(),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[t,n]=this.pageTranslation,[i,a]=this.pageDimensions;return this.#e.serialize([t,n,i,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class aS{#e=new Float64Array(6);#t;#s;#n;#a;#r;#i="";#o=0;#c=new xa;#l;#d;constructor(e,t,n,i,a,l){this.#l=n,this.#d=i,this.#n=a,this.#a=l,[e,t]=this.#h(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t],this.#s=[{line:c,points:this.#r}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#a=t)}#h(e,t){return ce._normalizePoint(e,t,this.#l,this.#d,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#r.length<=10}add(e,t){[e,t]=this.#h(e,t);const[n,i,a,l]=this.#e.subarray(2,6),c=e-a,h=t-l;return Math.hypot(this.#l*c,this.#d*h)<=2?null:(this.#r.push(e,t),isNaN(n)?(this.#e.set([a,l,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,i,a,l,e,t],0),this.#t.push(...ce.createBezierPoints(n,i,a,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,a){this.#l=n,this.#d=i,this.#n=a,[e,t]=this.#h(e,t);const l=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#r=[e,t];const c=this.#s.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#s.push({line:l,points:this.#r}),this.#e.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#r=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#c.removeLastElement();this.#s.pop(),this.#i="";for(let e=0,t=this.#s.length;e<t;e++){const{line:n,points:i}=this.#s[e];this.#t=n,this.#r=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#i}}}toSVGPath(){const e=ce.svgRound(this.#t[4]),t=ce.svgRound(this.#t[5]);if(this.#r.length===2)return this.#i=`${this.#i} M ${e} ${t} Z`,this.#i;if(this.#r.length<=6){const i=this.#i.lastIndexOf("M");this.#i=`${this.#i.slice(0,i)} M ${e} ${t}`,this.#o=6}if(this.#r.length===4){const i=ce.svgRound(this.#t[10]),a=ce.svgRound(this.#t[11]);return this.#i=`${this.#i} L ${i} ${a}`,this.#o=12,this.#i}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let i=this.#o,a=this.#t.length;i<a;i+=6){const[l,c,h,d,p,m]=this.#t.slice(i,i+6).map(ce.svgRound);n.push(`C${l} ${c} ${h} ${d} ${p} ${m}`)}return this.#i+=n.join(" "),this.#o=this.#t.length,this.#i}getOutlines(e,t,n,i){const a=this.#s.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#s,e,t,n,this.#n,this.#a,i),this.#e=null,this.#t=null,this.#s=null,this.#i=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class xa extends ce{#e;#t=0;#s;#n;#a;#r;#i;#o;#c;build(e,t,n,i,a,l,c){this.#a=t,this.#r=n,this.#i=i,this.#o=a,this.#c=l,this.#s=c??0,this.#n=e,this.#h()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${ce.svgRound(t[4])} ${ce.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${ce.svgRound(t[10])} ${ce.svgRound(t[11])}`);continue}for(let n=6,i=t.length;n<i;n+=6){const[a,l,c,h,d,p]=t.subarray(n,n+6).map(ce.svgRound);e.push(`C${a} ${l} ${c} ${h} ${d} ${p}`)}}return e.join("")}serialize([e,t,n,i],a){const l=[],c=[],[h,d,p,m]=this.#d();let y,w,_,b,A,C,k,E,P;switch(this.#o){case 0:P=ce._rescale,y=e,w=t+i,_=n,b=-i,A=e+h*n,C=t+(1-d-m)*i,k=e+(h+p)*n,E=t+(1-d)*i;break;case 90:P=ce._rescaleAndSwap,y=e,w=t,_=n,b=i,A=e+d*n,C=t+h*i,k=e+(d+m)*n,E=t+(h+p)*i;break;case 180:P=ce._rescale,y=e+n,w=t,_=-n,b=i,A=e+(1-h-p)*n,C=t+d*i,k=e+(1-h)*n,E=t+(d+m)*i;break;case 270:P=ce._rescaleAndSwap,y=e+n,w=t+i,_=-n,b=-i,A=e+(1-d-m)*n,C=t+(1-h-p)*i,k=e+(1-d)*n,E=t+(1-h)*i;break}for(const{line:R,points:N}of this.#n)l.push(P(R,y,w,_,b,a?new Array(R.length):null)),c.push(P(N,y,w,_,b,a?new Array(N.length):null));return{lines:l,points:c,rect:[A,C,k,E]}}static deserialize(e,t,n,i,a,{paths:{lines:l,points:c},rotation:h,thickness:d}){const p=[];let m,y,w,_,b;switch(h){case 0:b=ce._rescale,m=-e/n,y=t/i+1,w=1/n,_=-1/i;break;case 90:b=ce._rescaleAndSwap,m=-t/i,y=-e/n,w=1/i,_=1/n;break;case 180:b=ce._rescale,m=e/n+1,y=-t/i,w=-1/n,_=1/i;break;case 270:b=ce._rescaleAndSwap,m=t/i+1,y=e/n+1,w=-1/i,_=-1/n;break}if(!l){l=[];for(const C of c){const k=C.length;if(k===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(k===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const E=new Float32Array(3*(k-2));l.push(E);let[P,R,N,O]=C.subarray(0,4);E.set([NaN,NaN,NaN,NaN,P,R],0);for(let L=4;L<k;L+=2){const H=C[L],V=C[L+1];E.set(ce.createBezierPoints(P,R,N,O,H,V),(L-2)*3),[P,R,N,O]=[N,O,H,V]}}}for(let C=0,k=l.length;C<k;C++)p.push({line:b(l[C].map(E=>E??NaN),m,y,w,_),points:b(c[C].map(E=>E??NaN),m,y,w,_)});const A=new this.prototype.constructor;return A.build(p,n,i,1,h,d,a),A}#l(e=this.#c){const t=this.#s+e/2*this.#i;return this.#o%180===0?[t/this.#a,t/this.#r]:[t/this.#r,t/this.#a]}#d(){const[e,t,n,i]=this.#e,[a,l]=this.#l(0);return[e+a,t+l,n-2*a,i-2*l]}#h(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#n){if(i.length<=12){for(let c=4,h=i.length;c<h;c+=6)ue.pointBoundingBox(i[c],i[c+1],e);continue}let a=i[4],l=i[5];for(let c=6,h=i.length;c<h;c+=6){const[d,p,m,y,w,_]=i.subarray(c,c+6);ue.bezierBoundingBox(a,l,d,p,m,y,w,_,e),a=w,l=_}}const[t,n]=this.#l();e[0]=Ht(e[0]-t,0,1),e[1]=Ht(e[1]-n,0,1),e[2]=Ht(e[2]+t,0,1),e[3]=Ht(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[i,a]=this.#l(),[l,c]=[i-t,a-n],h=this.#e;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([e,t],n){const[i,a]=this.#l();this.#a=e,this.#r=t,this.#i=n;const[l,c]=this.#l(),h=l-i,d=c-a,p=this.#e;return p[0]-=h,p[1]-=d,p[2]+=2*h,p[3]+=2*d,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ce.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ce.svgRound(e)} ${ce.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,i=0,a=0,l=0,c=0,h=0;switch(this.#t){case 90:i=t/e,a=-e/t,c=e;break;case 180:n=-1,l=-1,c=e,h=t;break;case 270:i=-t/e,a=e/t,h=t;break;default:return""}return`matrix(${n} ${i} ${a} ${l} ${ce.svgRound(c)} ${ce.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,i]){const[a,l]=this.#l(),[c,h,d,p]=this.#e;if(Math.abs(d-a)<=ce.PRECISION||Math.abs(p-l)<=ce.PRECISION){const b=e+n/2-(c+d/2),A=t+i/2-(h+p/2);return{path:{"transform-origin":`${ce.svgRound(e)} ${ce.svgRound(t)}`,transform:`${this.rotationTransform} translate(${b} ${A})`}}}const m=(n-2*a)/(d-2*a),y=(i-2*l)/(p-2*l),w=d/n,_=p/i;return{path:{"transform-origin":`${ce.svgRound(c)} ${ce.svgRound(h)}`,transform:`${this.rotationTransform} scale(${w} ${_}) translate(${ce.svgRound(a)} ${ce.svgRound(l)}) scale(${m} ${y}) translate(${ce.svgRound(-a)} ${ce.svgRound(-l)})`}}}getPathResizedSVGProperties([e,t,n,i]){const[a,l]=this.#l(),c=this.#e,[h,d,p,m]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=i,Math.abs(p-a)<=ce.PRECISION||Math.abs(m-l)<=ce.PRECISION){const A=e+n/2-(h+p/2),C=t+i/2-(d+m/2);for(const{line:k,points:E}of this.#n)ce._translate(k,A,C,k),ce._translate(E,A,C,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ce.svgRound(e)} ${ce.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(n-2*a)/(p-2*a),w=(i-2*l)/(m-2*l),_=-y*(h+a)+e+a,b=-w*(d+l)+t+l;if(y!==1||w!==1||_!==0||b!==0)for(const{line:A,points:C}of this.#n)ce._rescale(A,_,b,y,w,A),ce._rescale(C,_,b,y,w,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ce.svgRound(e)} ${ce.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[i,a]=n,l=this.#e,c=e-l[0],h=t-l[1];if(this.#a===i&&this.#r===a)for(const{line:d,points:p}of this.#n)ce._translate(d,c,h,d),ce._translate(p,c,h,p);else{const d=this.#a/i,p=this.#r/a;this.#a=i,this.#r=a;for(const{line:m,points:y}of this.#n)ce._rescale(m,c,h,d,p,m),ce._rescale(y,c,h,d,p,y);l[2]*=d,l[3]*=p}return l[0]=e,l[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ce.svgRound(e)} ${ce.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ce.svgRound(e[0])} ${ce.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Ol extends i0{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:we._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Ol(this._viewParameters);return e.updateAll(this),e}}class od extends $e{static _type="ink";static _editorType=Ne.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){we.initialize(e,t),this._defaultDrawingOptions=new Ol(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Pe(this,"typesMap",new Map([[Oe.INK_THICKNESS,"stroke-width"],[Oe.INK_COLOR,"stroke"],[Oe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,a){return new aS(e,t,n,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,a,l){return xa.deserialize(e,t,n,i,a,l)}static async deserialize(e,t,n){let i=null;if(e instanceof rd){const{data:{inkLists:l,rect:c,rotation:h,id:d,color:p,opacity:m,borderStyle:{rawWidth:y},popupRef:w,richText:_,contentsObj:b,creationDate:A,modificationDate:C},parent:{page:{pageNumber:k}}}=e;i=e={annotationType:Ne.INK,color:Array.from(p),thickness:y,opacity:m,paths:{points:l},boxes:null,pageIndex:k-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:w,richText:_,comment:b?.str||null,creationDate:A,modificationDate:C}}const a=await super.deserialize(e,t,n);return a._initialData=i,e.comment&&a.setCommentData(e),a}get toolbarButtons(){return this._colorPicker||=new fa(this),[["colorPicker",this._colorPicker]]}get colorType(){return Oe.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=od.getDefaultDrawingOptions({stroke:ue.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":a,"stroke-width":l}}=this,c=Object.assign(super.serialize(e),{color:we._colorManager.convert(i),opacity:a,thickness:l,paths:{lines:t,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:n,opacity:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((l,c)=>l!==t[c])||e.thickness!==n||e.opacity!==i||e.pageIndex!==a}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class Ch extends xa{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Go=8,Vr=3;class Li{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,i){return n-=e,i-=t,n===0?i>0?0:4:n===1?i+6:2-i}static#s=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,n,i,a,l,c){const h=this.#t(n,i,a,l);for(let d=0;d<8;d++){const p=(-d+h-c+16)%8,m=this.#s[2*p],y=this.#s[2*p+1];if(e[(n+m)*t+(i+y)]!==0)return p}return-1}static#a(e,t,n,i,a,l,c){const h=this.#t(n,i,a,l);for(let d=0;d<8;d++){const p=(d+h+c+16)%8,m=this.#s[2*p],y=this.#s[2*p+1];if(e[(n+m)*t+(i+y)]!==0)return p}return-1}static#r(e,t,n,i){const a=e.length,l=new Int32Array(a);for(let p=0;p<a;p++)l[p]=e[p]<=i?1:0;for(let p=1;p<n-1;p++)l[p*t]=l[p*t+t-1]=0;for(let p=0;p<t;p++)l[p]=l[t*n-1-p]=0;let c=1,h;const d=[];for(let p=1;p<n-1;p++){h=1;for(let m=1;m<t-1;m++){const y=p*t+m,w=l[y];if(w===0)continue;let _=p,b=m;if(w===1&&l[y-1]===0)c+=1,b-=1;else if(w>=1&&l[y+1]===0)c+=1,b+=1,w>1&&(h=w);else{w!==1&&(h=Math.abs(w));continue}const A=[m,p],C=b===m+1,k={isHole:C,points:A,id:c,parent:0};d.push(k);let E;for(const q of d)if(q.id===h){E=q;break}E?E.isHole?k.parent=C?E.parent:h:k.parent=C?h:E.parent:k.parent=C?h:0;const P=this.#n(l,t,p,m,_,b,0);if(P===-1){l[y]=-c,l[y]!==1&&(h=Math.abs(l[y]));continue}let R=this.#s[2*P],N=this.#s[2*P+1];const O=p+R,L=m+N;_=O,b=L;let H=p,V=m;for(;;){const q=this.#a(l,t,H,V,_,b,1);R=this.#s[2*q],N=this.#s[2*q+1];const xe=H+R,X=V+N;A.push(X,xe);const re=H*t+V;if(l[re+1]===0?l[re]=-c:l[re]===1&&(l[re]=c),xe===p&&X===m&&H===O&&V===L){l[y]!==1&&(h=Math.abs(l[y]));break}else _=H,b=V,H=xe,V=X}}}return d}static#i(e,t,n,i){if(n-t<=4){for(let O=t;O<n-2;O+=2)i.push(e[O],e[O+1]);return}const a=e[t],l=e[t+1],c=e[n-4]-a,h=e[n-3]-l,d=Math.hypot(c,h),p=c/d,m=h/d,y=p*l-m*a,w=h/c,_=1/d,b=Math.atan(w),A=Math.cos(b),C=Math.sin(b),k=_*(Math.abs(A)+Math.abs(C)),E=_*(1-k+k**2),P=Math.max(Math.atan(Math.abs(C+A)*E),Math.atan(Math.abs(C-A)*E));let R=0,N=t;for(let O=t+2;O<n-2;O+=2){const L=Math.abs(y-p*e[O+1]+m*e[O]);L>R&&(N=O,R=L)}R>(d*P)**2?(this.#i(e,t,N+2,i),this.#i(e,N,n,i)):i.push(a,l)}static#o(e){const t=[],n=e.length;return this.#i(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,i,a,l){const c=new Float32Array(l**2),h=-2*i**2,d=l>>1;for(let b=0;b<l;b++){const A=(b-d)**2;for(let C=0;C<l;C++)c[b*l+C]=Math.exp((A+(C-d)**2)/h)}const p=new Float32Array(256),m=-2*a**2;for(let b=0;b<256;b++)p[b]=Math.exp(b**2/m);const y=e.length,w=new Uint8Array(y),_=new Uint32Array(256);for(let b=0;b<n;b++)for(let A=0;A<t;A++){const C=b*t+A,k=e[C];let E=0,P=0;for(let N=0;N<l;N++){const O=b+N-d;if(!(O<0||O>=n))for(let L=0;L<l;L++){const H=A+L-d;if(H<0||H>=t)continue;const V=e[O*t+H],q=c[N*l+L]*p[Math.abs(V-k)];E+=V*q,P+=q}}const R=w[C]=Math.round(E/P);_[R]++}return[w,_]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#d(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,a=1/0;for(let c=0,h=n.length;c<h;c++){const d=n[c]=e[c<<2];i=Math.max(i,d),a=Math.min(a,d)}const l=255/(i-a);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-a)*l;return n}static#h(e){let t,n=-1/0,i=-1/0;const a=e.findIndex(h=>h!==0);let l=a,c=a;for(t=a;t<256;t++){const h=e[t];h>n&&(t-l>i&&(i=t-l,c=t-1),n=h,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:i}=e,{maxDim:a}=this.#e;let l=n,c=i;if(n>a||i>a){let y=n,w=i,_=Math.log2(Math.max(n,i)/a);const b=Math.floor(_);_=_===b?b-1:b;for(let C=0;C<_;C++){l=Math.ceil(y/2),c=Math.ceil(w/2);const k=new OffscreenCanvas(l,c);k.getContext("2d").drawImage(e,0,0,y,w,0,0,l,c),y=l,w=c,e!==t&&e.close(),e=k.transferToImageBitmap()}const A=Math.min(a/l,a/c);l=Math.round(l*A),c=Math.round(c*A)}const d=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,c),d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,l,c);const p=d.getImageData(0,0,l,c).data;return[this.#d(p),l,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:i},a,l,c,h){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const m=200,y=p.font=`${n} ${i} ${m}px ${t}`,{actualBoundingBoxLeft:w,actualBoundingBoxRight:_,actualBoundingBoxAscent:b,actualBoundingBoxDescent:A,fontBoundingBoxAscent:C,fontBoundingBoxDescent:k,width:E}=p.measureText(e),P=1.5,R=Math.ceil(Math.max(Math.abs(w)+Math.abs(_)||0,E)*P),N=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||m,Math.abs(C)+Math.abs(k)||m)*P);d=new OffscreenCanvas(R,N),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=y,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,R,N),p.fillStyle="black",p.fillText(e,R*(P-1)/2,N*(3-P)/2);const O=this.#d(p.getImageData(0,0,R,N).data),L=this.#l(O),H=this.#h(L),V=this.#r(O,R,N,H);return this.processDrawnLines({lines:{curves:V,width:R,height:N},pageWidth:a,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,a){const[l,c,h]=this.#f(e),[d,p]=this.#c(l,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),m=this.#h(p),y=this.#r(d,c,h,m);return this.processDrawnLines({lines:{curves:y,width:c,height:h},pageWidth:t,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:a,mustSmooth:l,areContours:c}){i%180!==0&&([t,n]=[n,t]);const{curves:h,width:d,height:p}=e,m=e.thickness??0,y=[],w=Math.min(t/d,n/p),_=w/t,b=w/n,A=[];for(const{points:k}of h){const E=l?this.#o(k):k;if(!E)continue;A.push(E);const P=E.length,R=new Float32Array(P),N=new Float32Array(3*(P===2?2:P-2));if(y.push({line:N,points:R}),P===2){R[0]=E[0]*_,R[1]=E[1]*b,N.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[O,L,H,V]=E;O*=_,L*=b,H*=_,V*=b,R.set([O,L,H,V],0),N.set([NaN,NaN,NaN,NaN,O,L],0);for(let q=4;q<P;q+=2){const xe=R[q]=E[q]*_,X=R[q+1]=E[q+1]*b;N.set(ce.createBezierPoints(O,L,H,V,xe,X),(q-2)*3),[O,L,H,V]=[H,V,xe,X]}}if(y.length===0)return null;const C=c?new Ch:new xa;return C.build(y,t,n,1,i,c?0:m,a),{outline:C,newCurves:A,areContours:c,thickness:m,width:d,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:i,height:a}){let l=1/0,c=-1/0,h=0;for(const E of e){h+=E.length;for(let P=2,R=E.length;P<R;P++){const N=E[P]-E[P-2];l=Math.min(l,N),c=Math.max(c,N)}}let d;l>=-128&&c<=127?d=Int8Array:l>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const p=e.length,m=Go+Vr*p,y=new Uint32Array(m);let w=0;y[w++]=m*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*d.BYTES_PER_ELEMENT,y[w++]=0,y[w++]=i,y[w++]=a,y[w++]=t?0:1,y[w++]=Math.max(0,Math.floor(n??0)),y[w++]=p,y[w++]=d.BYTES_PER_ELEMENT;for(const E of e)y[w++]=E.length-2,y[w++]=E[0],y[w++]=E[1];const _=new CompressionStream("deflate-raw"),b=_.writable.getWriter();await b.ready,b.write(y);const A=d.prototype.constructor;for(const E of e){const P=new A(E.length-2);for(let R=2,N=E.length;R<N;R++)P[R-2]=E[R]-E[R-2];b.write(P)}b.close();const C=await new Response(_.readable).arrayBuffer(),k=new Uint8Array(C);return Ry(k)}static async decompressSignature(e){try{const t=_A(e),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),a=i.getWriter();await a.ready,a.write(t).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,c=0;for await(const E of n)l||=new Uint8Array(new Uint32Array(E.buffer,0,4)[0]),l.set(E,c),c+=E.length;const h=new Uint32Array(l.buffer,0,l.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=h[2],m=h[3],y=h[4]===0,w=h[5],_=h[6],b=h[7],A=[],C=(Go+Vr*_)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(b){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(l.buffer,C);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(l.buffer,C);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(l.buffer,C);break}c=0;for(let E=0;E<_;E++){const P=h[Vr*E+Go],R=new Float32Array(P+2);A.push(R);for(let N=0;N<Vr-1;N++)R[N]=h[Vr*E+Go+N+1];for(let N=0;N<P;N++)R[N+2]=R[N]+k[c++]}return{areContours:y,thickness:w,outlines:A,width:p,height:m}}catch(t){return Te(`decompressSignature: ${t}`),null}}}class ld extends i0{constructor(){super(),super.updateProperties({fill:we._defaultLineColor,"stroke-width":0})}clone(){const e=new ld;return e.updateAll(this),e}}class cd extends Ol{constructor(e){super(e),super.updateProperties({stroke:we._defaultLineColor,"stroke-width":1})}clone(){const e=new cd(this._viewParameters);return e.updateAll(this),e}}class zn extends $e{#e=!1;#t=null;#s=null;#n=null;static _type="signature";static _editorType=Ne.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#s=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){we.initialize(e,t),this._defaultDrawingOptions=new ld,this._defaultDrawnSignatureOptions=new cd(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Pe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#s){const{lines:i,mustSmooth:a,areContours:l,description:c,uuid:h,heightInPage:d}=this.#s,{rawDims:{pageWidth:p,pageHeight:m},rotation:y}=this.parent.viewport,w=Li.processDrawnLines({lines:i,pageWidth:p,pageHeight:m,rotation:y,innerMargin:zn._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(w,d,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:a}=this.#s,l=Math.max(i,a),c=Li.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:i,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:a,y:l}=this,{outline:c}=this.#s=e;this.#e=c instanceof Ch,this.description=n;let h;this.#e?h=zn.getDefaultDrawingOptions():(h=zn._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,d]=this.pageDimensions;let p=t/d;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return Li.process(e,t,n,i,zn._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:a}=this.parent.viewport;return Li.extractContoursFromText(e,t,n,i,a,zn._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return Li.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:zn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=zn.getDefaultDrawingOptions():(this._drawingOptions=zn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,a=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:i});return this.addComment(a),e?(a.paths={lines:t,points:n},a.uuid=this.#n,a.isCopy=!0):a.lines=t,this.#t&&(a.accessibilityData={type:"Figure",alt:this.#t}),a}static deserializeDraw(e,t,n,i,a,l){return l.areContours?Ch.deserialize(e,t,n,i,a,l):xa.deserialize(e,t,n,i,a,l)}static async deserialize(e,t,n){const i=await super.deserialize(e,t,n);return i.#e=e.areContours,i.description=e.accessibilityData?.alt||"",i.#n=e.uuid,i}}class oS extends we{#e=null;#t=null;#s=null;#n=null;#a=null;#r="";#i=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Ne.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#a=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){we.initialize(e,t)}static isHandlingMimeForPasting(e){return gh.includes(e)}static paste(e,t){t.pasteEditor({mode:Ne.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#r=e.file.name),this.#m()}#f(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#i){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:l}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:i,width:a,height:l,channels:i.length/(a*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#h(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#h(i)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(n).then(i=>this.#h(i)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=gh.join(",");const t=this._uiManager._signal;this.#s=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(i)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#i?.remove(),this.#i=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#i===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#a||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,i&&(this.#e=i),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#m(){const{div:e}=this;let{width:t,height:n}=this.#e;const[i,a]=this.pageDimensions,l=.75;if(this.width)t=this.width*i,n=this.height*a;else if(t>l*i||n>l*a){const h=Math.min(l*i/t,l*a/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#i=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/i,this.height=n/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:i,height:a}=this.#e,l=new Vn;let c=this.#e,h=i,d=a,p=null;if(t){if(i>t||a>t){const N=Math.min(t/i,t/a);h=Math.floor(i*N),d=Math.floor(a*N)}p=document.createElement("canvas");const y=p.width=Math.ceil(h*l.sx),w=p.height=Math.ceil(d*l.sy);this.#l||(c=this.#u(y,w));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let b="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":TA.isDarkMode&&(b="#8f8f9d",A="#42414d");const C=15,k=C*l.sx,E=C*l.sy,P=new OffscreenCanvas(k*2,E*2),R=P.getContext("2d");R.fillStyle=b,R.fillRect(0,0,k*2,E*2),R.fillStyle=A,R.fillRect(0,0,k,E),R.fillRect(k,E,k,E),_.fillStyle=_.createPattern(P,"repeat"),_.fillRect(0,0,y,w),_.drawImage(c,0,0,c.width,c.height,0,0,y,w)}let m=null;if(n){let y,w;if(l.symmetric&&c.width<e&&c.height<e)y=c.width,w=c.height;else if(c=this.#e,i>e||a>e){const A=Math.min(e/i,e/a);y=Math.floor(i*A),w=Math.floor(a*A),this.#l||(c=this.#u(y,w))}const b=new OffscreenCanvas(y,w).getContext("2d",{willReadFrequently:!0});b.drawImage(c,0,0,c.width,c.height,0,0,y,w),m={width:y,height:w,data:b.getImageData(0,0,y,w).data}}return{canvas:p,width:h,height:d,imageData:m}}#u(e,t){const{width:n,height:i}=this.#e;let a=n,l=i,c=this.#e;for(;a>2*e||l>2*t;){const h=a,d=l;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(a,l);p.getContext("2d").drawImage(c,0,0,h,d,0,0,a,l),c=p.transferToImageBitmap()}return c}#p(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,a=new Vn,l=Math.ceil(n*e*a.sx),c=Math.ceil(i*t*a.sy),h=this.#i;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const d=this.#l?this.#e:this.#u(l,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,l,c)}#y(e){if(e){if(this.#l){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,i=Math.round(this.width*t*Xi.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*Xi.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(i,a);return l.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,a),l.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let i=null,a=!1;if(e instanceof n0){const{data:{rect:b,rotation:A,id:C,structParent:k,popupRef:E,richText:P,contentsObj:R,creationDate:N,modificationDate:O},container:L,parent:{page:{pageNumber:H}},canvas:V}=e;let q,xe;V?(delete e.canvas,{id:q,bitmap:xe}=n.imageManager.getFromCanvas(L.id,V),V.remove()):(a=!0,e._hasNoCanvas=!0);const X=(await t._structTree.getAriaAttributes(`${Bi}${C}`))?.get("aria-label")||"";i=e={annotationType:Ne.STAMP,bitmapId:q,bitmap:xe,pageIndex:H-1,rect:b.slice(0),rotation:A,annotationElementId:C,id:C,deleted:!1,accessibilityData:{decorative:!1,altText:X},isSvg:!1,structParent:k,popupRef:E,richText:P,comment:R?.str||null,creationDate:N,modificationDate:O}}const l=await super.deserialize(e,t,n),{rect:c,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:m,accessibilityData:y}=e;a?(n.addMissingCanvas(e.id,l),l.#o=!0):p&&n.imageManager.isValidId(p)?(l.#t=p,h&&(l.#e=h)):l.#n=d,l.#l=m;const[w,_]=l.pageDimensions;return l.width=(c[2]-c[0])/w,l.height=(c[3]-c[1])/_,y&&(l.altTextData=y),l._initialData=i,e.comment&&l.setCommentData(e),l.#d=!!i,l}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#w(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const l=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:l,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=t.stamps.get(this.#t);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#w(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,i=e.pageIndex===t,a=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class is{#e;#t=!1;#s=null;#n=null;#a=null;#r=new Map;#i=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([xt,od,oS,at,zn].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:h,viewport:d,l10n:p}){const m=[...is.#p.values()];if(!is._initialized){is._initialized=!0;for(const y of m)y.initialize(p,e)}e.registerEditorTypes(m),this.#u=e,this.pageIndex=t,this.div=n,this.#e=a,this.#s=l,this.viewport=d,this.#h=h,this.drawLayer=c,this._structTree=i,this.#u.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Ne.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#x(),e){case Ne.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ne.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ne.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Ne.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of is.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#h?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.togglePointerEvents(e)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const e=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#s;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const i=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:d}=a,p=this.#m;if(d-p>500){this.#m=d;return}this.#m=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const y=document.elementsFromPoint(c,h);if(m.toggle("getElements",!1),!this.div.contains(y[0]))return;let w;const _=new RegExp(`^${ua}[0-9]+$`);for(const A of y)if(_.test(A.id)){w=A.id;break}if(!w)return;const b=this.#r.get(w);b?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),b.dblclick(a))},{signal:i,capture:!0})}const e=this.#s,t=[];if(e){const i=new Map,a=new Map;for(const c of this.#y){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){i.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(this.#u.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let d=a.get(h);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=i.get(h),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of is.#p.values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const e=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#w.bind(this),{signal:e}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#w(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#h.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#h.div.contains(t)){const{isMac:n}=Mt.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),at.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:e.x,y:e.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#r.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#r.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e),we.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#a&&(e._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#r.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#v(){return is.#p.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#C(e){const t=this.#v;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:n,offsetY:i}=this.#A(),a=this.getNextId(),l=this.#C({parent:this,id:a,x:n,y:i,uiManager:this.#u,isCentered:!0,...t});l&&this.add(l)}async deserialize(e){return await is.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),a=this.#C({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...n});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,a=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+i),d=(a+c)/2-e,p=(l+h)/2-t,[m,y]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:m,offsetY:y}}addNewEditor(e={}){this.createAndAddNewEditor(this.#A(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=Mt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#i||(this.#i=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#u.getMode();if(n===Ne.STAMP||n===Ne.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===Ne.HIGHLIGHT&&this.enableTextSelection(),this.#i){this.#i=!1;return}const{isMac:t}=Mt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#i=!0,this.#v?.isDrawer){this.startDrawingSession(e);return}const n=this.#u.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:t}),this.#v.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#d=t);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(e)):null}findNewParent(e,t,n){const i=this.#u.findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const e of this.#r.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#x(){for(const e of this.#r.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Qs(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#x();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,Qs(this.div,{rotation:n}),t!==n)for(const i of this.#r.values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class Et{#e=null;#t=new Map;#s=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Pe(this,"_svgFactory",new wl)}static#a(e,[t,n,i,a]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*i}%`,l.height=`${100*a}%`}#r(){const e=Et._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#i(e,t){const n=Et._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const a=Et._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),i}#o(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)}draw(e,t=!1,n=!1){const i=Et.#n++,a=this.#r(),l=Et._svgFactory.createElement("defs");a.append(l);const c=Et._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#s.set(i,c);const d=n?this.#i(l,h):null,p=Et._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,e),this.#t.set(i,a),{id:i,clipPathId:`url(#${d})`}}drawOutline(e,t){const n=Et.#n++,i=this.#r(),a=Et._svgFactory.createElement("defs");i.append(a);const l=Et._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const m=Et._svgFactory.createElement("mask");a.append(m),h=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const y=Et._svgFactory.createElement("rect");m.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const w=Et._svgFactory.createElement("use");m.append(w),w.setAttribute("href",`#${c}`),w.setAttribute("stroke","none"),w.setAttribute("fill","black"),w.setAttribute("fill-rule","nonzero"),w.classList.add("mask")}const d=Et._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${c}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return i.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(n,i),n}finalizeDraw(e,t){this.#s.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:a,path:l}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#o(c,n),i&&Et.#a(c,i),a){const{classList:h}=c;for(const[d,p]of Object.entries(a))h.toggle(d,p)}if(l){const d=c.firstElementChild.firstElementChild;this.#o(d,l)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#s.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#s.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Ah};globalThis.pdfjsLib={AbortException:Ps,AnnotationEditorLayer:is,AnnotationEditorParamsType:Oe,AnnotationEditorType:Ne,AnnotationEditorUIManager:Ns,AnnotationLayer:ad,AnnotationMode:Ts,AnnotationType:ut,applyOpacity:NA,build:F1,ColorPicker:vn,createValidAbsoluteUrl:Ey,CSSConstants:PA,DOMSVGFactory:wl,DrawLayer:Et,FeatureTest:Mt,fetchData:ga,findContrastColor:RA,getDocument:Yy,getFilenameFromUrl:AA,getPdfFilenameFromUrl:SA,getRGB:va,getUuid:Ny,getXfaPageViewport:kA,GlobalWorkerOptions:qi,ImageKind:il,InvalidPDFException:ph,isDataScheme:Il,isPdfFile:Yh,isValidExplicitDest:zA,MathClamp:Ht,noContextMenu:xn,normalizeUnicode:bA,OPS:ha,OutputScale:Vn,PasswordResponses:hA,PDFDataRangeTransport:Qy,PDFDateString:mh,PDFWorker:Tt,PermissionFlag:uA,PixelsPerInch:Xi,RenderingCancelledException:Kh,renderRichText:Iy,ResponseException:yl,setLayerDimensions:Qs,shadow:Pe,SignatureExtractor:Li,stopEvent:st,SupportedImageMimeTypes:gh,TextLayer:zt,TouchManager:Dl,updateUrlHash:Ty,Util:ue,VerbosityLevel:Nl,version:O1,XfaLayer:My};const lS="/assets/pdf.worker.min-CXgfMxHN.mjs";qi.workerSrc=lS;async function cS(o){try{console.log("Starte PDF-Extraktion fr:",o.name);const e=await o.arrayBuffer();console.log("ArrayBuffer erstellt, Gre:",e.byteLength);const n=await Yy({data:e}).promise;console.log("PDF geladen, Seiten:",n.numPages);let i="";for(let a=1;a<=n.numPages;a++){const h=(await(await n.getPage(a)).getTextContent()).items.map(d=>d.str).join(" ");i+=h+`

`,console.log(`Seite ${a} extrahiert, ${h.length} Zeichen`)}return console.log("PDF-Extraktion abgeschlossen, Gesamt:",i.length,"Zeichen"),i.trim()}catch(e){throw console.error("Detaillierter Fehler bei PDF-Extraktion:",e),new Error(`PDF konnte nicht gelesen werden: ${e instanceof Error?e.message:"Unbekannter Fehler"}`)}}function Se(o,e,t,n,i){if(typeof e=="function"?o!==e||!0:!e.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(o,t),t}function $(o,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?o!==e||!n:!e.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(o):n?n.value:e.get(o)}let r0=function(){const{crypto:o}=globalThis;if(o?.randomUUID)return r0=o.randomUUID.bind(o),o.randomUUID();const e=new Uint8Array(1),t=o?()=>o.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};function kh(o){return typeof o=="object"&&o!==null&&("name"in o&&o.name==="AbortError"||"message"in o&&String(o.message).includes("FetchRequestCanceledException"))}const Eh=o=>{if(o instanceof Error)return o;if(typeof o=="object"&&o!==null){try{if(Object.prototype.toString.call(o)==="[object Error]"){const e=new Error(o.message,o.cause?{cause:o.cause}:{});return o.stack&&(e.stack=o.stack),o.cause&&!e.cause&&(e.cause=o.cause),o.name&&(e.name=o.name),e}}catch{}try{return new Error(JSON.stringify(o))}catch{}}return new Error(o)};class be extends Error{}class It extends be{constructor(e,t,n,i){super(`${It.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.requestID=i?.get("x-request-id"),this.error=t;const a=t;this.code=a?.code,this.param=a?.param,this.type=a?.type}static makeMessage(e,t,n){const i=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new Fl({message:n,cause:Eh(t)});const a=t?.error;return e===400?new a0(e,a,n,i):e===401?new o0(e,a,n,i):e===403?new l0(e,a,n,i):e===404?new c0(e,a,n,i):e===409?new u0(e,a,n,i):e===422?new h0(e,a,n,i):e===429?new d0(e,a,n,i):e>=500?new f0(e,a,n,i):new It(e,a,n,i)}}class bn extends It{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Fl extends It{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class ud extends Fl{constructor({message:e}={}){super({message:e??"Request timed out."})}}class a0 extends It{}class o0 extends It{}class l0 extends It{}class c0 extends It{}class u0 extends It{}class h0 extends It{}class d0 extends It{}class f0 extends It{}class p0 extends be{constructor(){super("Could not parse response content as the length limit was reached")}}class m0 extends be{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Kr extends Error{constructor(e){super(e)}}const uS=/^[a-z][a-z0-9+.-]*:/i,hS=o=>uS.test(o);let Jt=o=>(Jt=Array.isArray,Jt(o)),bg=Jt;function g0(o){return typeof o!="object"?{}:o??{}}function dS(o){if(!o)return!0;for(const e in o)return!1;return!0}function fS(o,e){return Object.prototype.hasOwnProperty.call(o,e)}function nh(o){return o!=null&&typeof o=="object"&&!Array.isArray(o)}const pS=(o,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new be(`${o} must be an integer`);if(e<0)throw new be(`${o} must be a positive integer`);return e},mS=o=>{try{return JSON.parse(o)}catch{return}},_a=o=>new Promise(e=>setTimeout(e,o)),Oi="6.10.0",gS=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function yS(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const vS=()=>{const o=yS();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oi,"X-Stainless-OS":_g(Deno.build.os),"X-Stainless-Arch":xg(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oi,"X-Stainless-OS":_g(globalThis.process.platform??"unknown"),"X-Stainless-Arch":xg(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=wS();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function wS(){if(typeof navigator>"u"||!navigator)return null;const o=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of o){const n=t.exec(navigator.userAgent);if(n){const i=n[1]||0,a=n[2]||0,l=n[3]||0;return{browser:e,version:`${i}.${a}.${l}`}}}return null}const xg=o=>o==="x32"?"x32":o==="x86_64"||o==="x64"?"x64":o==="arm"?"arm":o==="aarch64"||o==="arm64"?"arm64":o?`other:${o}`:"unknown",_g=o=>(o=o.toLowerCase(),o.includes("ios")?"iOS":o==="android"?"Android":o==="darwin"?"MacOS":o==="win32"?"Windows":o==="freebsd"?"FreeBSD":o==="openbsd"?"OpenBSD":o==="linux"?"Linux":o?`Other:${o}`:"Unknown");let Ag;const bS=()=>Ag??(Ag=vS());function xS(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function y0(...o){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...o)}function v0(o){let e=Symbol.asyncIterator in o?o[Symbol.asyncIterator]():o[Symbol.iterator]();return y0({start(){},async pull(t){const{done:n,value:i}=await e.next();n?t.close():t.enqueue(i)},async cancel(){await e.return?.()}})}function w0(o){if(o[Symbol.asyncIterator])return o;const e=o.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function _S(o){if(o===null||typeof o!="object")return;if(o[Symbol.asyncIterator]){await o[Symbol.asyncIterator]().return?.();return}const e=o.getReader(),t=e.cancel();e.releaseLock(),await t}const AS=({headers:o,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),b0="RFC3986",x0=o=>String(o),Sg={RFC1738:o=>String(o).replace(/%20/g,"+"),RFC3986:x0},SS="RFC1738";let Th=(o,e)=>(Th=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),Th(o,e));const $n=(()=>{const o=[];for(let e=0;e<256;++e)o.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return o})(),sh=1024,CS=(o,e,t,n,i)=>{if(o.length===0)return o;let a=o;if(typeof o=="symbol"?a=Symbol.prototype.toString.call(o):typeof o!="string"&&(a=String(o)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let l="";for(let c=0;c<a.length;c+=sh){const h=a.length>=sh?a.slice(c,c+sh):a,d=[];for(let p=0;p<h.length;++p){let m=h.charCodeAt(p);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||i===SS&&(m===40||m===41)){d[d.length]=h.charAt(p);continue}if(m<128){d[d.length]=$n[m];continue}if(m<2048){d[d.length]=$n[192|m>>6]+$n[128|m&63];continue}if(m<55296||m>=57344){d[d.length]=$n[224|m>>12]+$n[128|m>>6&63]+$n[128|m&63];continue}p+=1,m=65536+((m&1023)<<10|h.charCodeAt(p)&1023),d[d.length]=$n[240|m>>18]+$n[128|m>>12&63]+$n[128|m>>6&63]+$n[128|m&63]}l+=d.join("")}return l};function kS(o){return!o||typeof o!="object"?!1:!!(o.constructor&&o.constructor.isBuffer&&o.constructor.isBuffer(o))}function Cg(o,e){if(Jt(o)){const t=[];for(let n=0;n<o.length;n+=1)t.push(e(o[n]));return t}return e(o)}const _0={brackets(o){return String(o)+"[]"},comma:"comma",indices(o,e){return String(o)+"["+e+"]"},repeat(o){return String(o)}},A0=function(o,e){Array.prototype.push.apply(o,Jt(e)?e:[e])};let kg;const gt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:CS,encodeValuesOnly:!1,format:b0,formatter:x0,indices:!1,serializeDate(o){return(kg??(kg=Function.prototype.call.bind(Date.prototype.toISOString)))(o)},skipNulls:!1,strictNullHandling:!1};function ES(o){return typeof o=="string"||typeof o=="number"||typeof o=="boolean"||typeof o=="symbol"||typeof o=="bigint"}const ih={};function S0(o,e,t,n,i,a,l,c,h,d,p,m,y,w,_,b,A,C){let k=o,E=C,P=0,R=!1;for(;(E=E.get(ih))!==void 0&&!R;){const V=E.get(o);if(P+=1,typeof V<"u"){if(V===P)throw new RangeError("Cyclic object value");R=!0}typeof E.get(ih)>"u"&&(P=0)}if(typeof d=="function"?k=d(e,k):k instanceof Date?k=y?.(k):t==="comma"&&Jt(k)&&(k=Cg(k,function(V){return V instanceof Date?y?.(V):V})),k===null){if(a)return h&&!b?h(e,gt.encoder,A,"key",w):e;k=""}if(ES(k)||kS(k)){if(h){const V=b?e:h(e,gt.encoder,A,"key",w);return[_?.(V)+"="+_?.(h(k,gt.encoder,A,"value",w))]}return[_?.(e)+"="+_?.(String(k))]}const N=[];if(typeof k>"u")return N;let O;if(t==="comma"&&Jt(k))b&&h&&(k=Cg(k,h)),O=[{value:k.length>0?k.join(",")||null:void 0}];else if(Jt(d))O=d;else{const V=Object.keys(k);O=p?V.sort(p):V}const L=c?String(e).replace(/\./g,"%2E"):String(e),H=n&&Jt(k)&&k.length===1?L+"[]":L;if(i&&Jt(k)&&k.length===0)return H+"[]";for(let V=0;V<O.length;++V){const q=O[V],xe=typeof q=="object"&&typeof q.value<"u"?q.value:k[q];if(l&&xe===null)continue;const X=m&&c?q.replace(/\./g,"%2E"):q,re=Jt(k)?typeof t=="function"?t(H,X):H:H+(m?"."+X:"["+X+"]");C.set(o,P);const te=new WeakMap;te.set(ih,C),A0(N,S0(xe,re,t,n,i,a,l,c,t==="comma"&&b&&Jt(k)?null:h,d,p,m,y,w,_,b,A,te))}return N}function TS(o=gt){if(typeof o.allowEmptyArrays<"u"&&typeof o.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof o.encodeDotInKeys<"u"&&typeof o.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(o.encoder!==null&&typeof o.encoder<"u"&&typeof o.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=o.charset||gt.charset;if(typeof o.charset<"u"&&o.charset!=="utf-8"&&o.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=b0;if(typeof o.format<"u"){if(!Th(Sg,o.format))throw new TypeError("Unknown format option provided.");t=o.format}const n=Sg[t];let i=gt.filter;(typeof o.filter=="function"||Jt(o.filter))&&(i=o.filter);let a;if(o.arrayFormat&&o.arrayFormat in _0?a=o.arrayFormat:"indices"in o?a=o.indices?"indices":"repeat":a=gt.arrayFormat,"commaRoundTrip"in o&&typeof o.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const l=typeof o.allowDots>"u"?o.encodeDotInKeys?!0:gt.allowDots:!!o.allowDots;return{addQueryPrefix:typeof o.addQueryPrefix=="boolean"?o.addQueryPrefix:gt.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof o.allowEmptyArrays=="boolean"?!!o.allowEmptyArrays:gt.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof o.charsetSentinel=="boolean"?o.charsetSentinel:gt.charsetSentinel,commaRoundTrip:!!o.commaRoundTrip,delimiter:typeof o.delimiter>"u"?gt.delimiter:o.delimiter,encode:typeof o.encode=="boolean"?o.encode:gt.encode,encodeDotInKeys:typeof o.encodeDotInKeys=="boolean"?o.encodeDotInKeys:gt.encodeDotInKeys,encoder:typeof o.encoder=="function"?o.encoder:gt.encoder,encodeValuesOnly:typeof o.encodeValuesOnly=="boolean"?o.encodeValuesOnly:gt.encodeValuesOnly,filter:i,format:t,formatter:n,serializeDate:typeof o.serializeDate=="function"?o.serializeDate:gt.serializeDate,skipNulls:typeof o.skipNulls=="boolean"?o.skipNulls:gt.skipNulls,sort:typeof o.sort=="function"?o.sort:null,strictNullHandling:typeof o.strictNullHandling=="boolean"?o.strictNullHandling:gt.strictNullHandling}}function PS(o,e={}){let t=o;const n=TS(e);let i,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):Jt(n.filter)&&(a=n.filter,i=a);const l=[];if(typeof t!="object"||t===null)return"";const c=_0[n.arrayFormat],h=c==="comma"&&n.commaRoundTrip;i||(i=Object.keys(t)),n.sort&&i.sort(n.sort);const d=new WeakMap;for(let y=0;y<i.length;++y){const w=i[y];n.skipNulls&&t[w]===null||A0(l,S0(t[w],w,c,h,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}const p=l.join(n.delimiter);let m=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),p.length>0?m+p:""}function NS(o){let e=0;for(const i of o)e+=i.length;const t=new Uint8Array(e);let n=0;for(const i of o)t.set(i,n),n+=i.length;return t}let Eg;function hd(o){let e;return(Eg??(e=new globalThis.TextEncoder,Eg=e.encode.bind(e)))(o)}let Tg;function Pg(o){let e;return(Tg??(e=new globalThis.TextDecoder,Tg=e.decode.bind(e)))(o)}var sn,rn;class jl{constructor(){sn.set(this,void 0),rn.set(this,void 0),Se(this,sn,new Uint8Array),Se(this,rn,null)}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?hd(e):e;Se(this,sn,NS([$(this,sn,"f"),t]));const n=[];let i;for(;(i=RS($(this,sn,"f"),$(this,rn,"f")))!=null;){if(i.carriage&&$(this,rn,"f")==null){Se(this,rn,i.index);continue}if($(this,rn,"f")!=null&&(i.index!==$(this,rn,"f")+1||i.carriage)){n.push(Pg($(this,sn,"f").subarray(0,$(this,rn,"f")-1))),Se(this,sn,$(this,sn,"f").subarray($(this,rn,"f"))),Se(this,rn,null);continue}const a=$(this,rn,"f")!==null?i.preceding-1:i.preceding,l=Pg($(this,sn,"f").subarray(0,a));n.push(l),Se(this,sn,$(this,sn,"f").subarray(i.index)),Se(this,rn,null)}return n}flush(){return $(this,sn,"f").length?this.decode(`
`):[]}}sn=new WeakMap,rn=new WeakMap;jl.NEWLINE_CHARS=new Set([`
`,"\r"]);jl.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function RS(o,e){for(let i=e??0;i<o.length;i++){if(o[i]===10)return{preceding:i,index:i+1,carriage:!1};if(o[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function MS(o){for(let n=0;n<o.length-1;n++){if(o[n]===10&&o[n+1]===10||o[n]===13&&o[n+1]===13)return n+2;if(o[n]===13&&o[n+1]===10&&n+3<o.length&&o[n+2]===13&&o[n+3]===10)return n+4}return-1}const bl={off:0,error:200,warn:300,info:400,debug:500},Ng=(o,e,t)=>{if(o){if(fS(bl,o))return o;Pt(t).warn(`${e} was set to ${JSON.stringify(o)}, expected one of ${JSON.stringify(Object.keys(bl))}`)}};function Yr(){}function qo(o,e,t){return!e||bl[o]>bl[t]?Yr:e[o].bind(e)}const IS={error:Yr,warn:Yr,info:Yr,debug:Yr};let Rg=new WeakMap;function Pt(o){const e=o.logger,t=o.logLevel??"off";if(!e)return IS;const n=Rg.get(e);if(n&&n[0]===t)return n[1];const i={error:qo("error",e,t),warn:qo("warn",e,t),info:qo("info",e,t),debug:qo("debug",e,t)};return Rg.set(e,[t,i]),i}const Gs=o=>(o.options&&(o.options={...o.options},delete o.options.headers),o.headers&&(o.headers=Object.fromEntries((o.headers instanceof Headers?[...o.headers]:Object.entries(o.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in o&&(o.retryOfRequestLogID&&(o.retryOf=o.retryOfRequestLogID),delete o.retryOfRequestLogID),o);var Gr;class Wn{constructor(e,t,n){this.iterator=e,Gr.set(this,void 0),this.controller=t,Se(this,Gr,n)}static fromSSEResponse(e,t,n){let i=!1;const a=n?Pt(n):console;async function*l(){if(i)throw new be("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(const h of DS(e,t))if(!c){if(h.data.startsWith("[DONE]")){c=!0;continue}if(h.event===null||!h.event.startsWith("thread.")){let d;try{d=JSON.parse(h.data)}catch(p){throw a.error("Could not parse message into JSON:",h.data),a.error("From chunk:",h.raw),p}if(d&&d.error)throw new It(void 0,d.error,void 0,e.headers);yield d}else{let d;try{d=JSON.parse(h.data)}catch(p){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),p}if(h.event=="error")throw new It(void 0,d.error,d.message,void 0);yield{event:h.event,data:d}}}c=!0}catch(h){if(kh(h))return;throw h}finally{c||t.abort()}}return new Wn(l,t,n)}static fromReadableStream(e,t,n){let i=!1;async function*a(){const c=new jl,h=w0(e);for await(const d of h)for(const p of c.decode(d))yield p;for(const d of c.flush())yield d}async function*l(){if(i)throw new be("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(const h of a())c||h&&(yield JSON.parse(h));c=!0}catch(h){if(kh(h))return;throw h}finally{c||t.abort()}}return new Wn(l,t,n)}[(Gr=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=a=>({next:()=>{if(a.length===0){const l=n.next();e.push(l),t.push(l)}return a.shift()}});return[new Wn(()=>i(e),this.controller,$(this,Gr,"f")),new Wn(()=>i(t),this.controller,$(this,Gr,"f"))]}toReadableStream(){const e=this;let t;return y0({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:a}=await t.next();if(a)return n.close();const l=hd(JSON.stringify(i)+`
`);n.enqueue(l)}catch(i){n.error(i)}},async cancel(){await t.return?.()}})}}async function*DS(o,e){if(!o.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new be("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new be("Attempted to iterate over a response with no body");const t=new OS,n=new jl,i=w0(o.body);for await(const a of LS(i))for(const l of n.decode(a)){const c=t.decode(l);c&&(yield c)}for(const a of n.flush()){const l=t.decode(a);l&&(yield l)}}async function*LS(o){let e=new Uint8Array;for await(const t of o){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?hd(t):t;let i=new Uint8Array(e.length+n.length);i.set(e),i.set(n,e.length),e=i;let a;for(;(a=MS(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class OS{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=FS(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function FS(o,e){const t=o.indexOf(e);return t!==-1?[o.substring(0,t),e,o.substring(t+e.length)]:[o,"",""]}async function C0(o,e){const{response:t,requestLogID:n,retryOfRequestLogID:i,startTime:a}=e,l=await(async()=>{if(e.options.stream)return Pt(o).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,o):Wn.fromSSEResponse(t,e.controller,o);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const h=t.headers.get("content-type")?.split(";")[0]?.trim();if(h?.includes("application/json")||h?.endsWith("+json")){const m=await t.json();return k0(m,t)}return await t.text()})();return Pt(o).debug(`[${n}] response parsed`,Gs({retryOfRequestLogID:i,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}function k0(o,e){return!o||typeof o!="object"||Array.isArray(o)?o:Object.defineProperty(o,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Qr;class Bl extends Promise{constructor(e,t,n=C0){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=n,Qr.set(this,void 0),Se(this,Qr,e)}_thenUnwrap(e){return new Bl($(this,Qr,"f"),this.responsePromise,async(t,n)=>k0(e(await this.parseResponse(t,n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse($(this,Qr,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Qr=new WeakMap;var Xo;class dd{constructor(e,t,n,i){Xo.set(this,void 0),Se(this,Xo,e),this.options=i,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new be("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await $(this,Xo,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Xo=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class jS extends Bl{constructor(e,t,n){super(e,t,async(i,a)=>new n(i,a.response,await C0(i,a),a.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}class $l extends dd{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class ht extends dd{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?{...this.options,query:{...g0(this.options.query),after:t}}:null}}class xl extends dd{constructor(e,t,n,i){super(e,t,n,i),this.data=n.data||[],this.has_more=n.has_more||!1,this.last_id=n.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...g0(this.options.query),after:e}}:null}}const E0=()=>{if(typeof File>"u"){const{process:o}=globalThis,e=typeof o?.versions?.node=="string"&&parseInt(o.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ra(o,e,t){return E0(),new File(o,e??"unknown_file",t)}function rl(o){return(typeof o=="object"&&o!==null&&("name"in o&&o.name&&String(o.name)||"url"in o&&o.url&&String(o.url)||"filename"in o&&o.filename&&String(o.filename)||"path"in o&&o.path&&String(o.path))||"").split(/[\\/]/).pop()||void 0}const fd=o=>o!=null&&typeof o=="object"&&typeof o[Symbol.asyncIterator]=="function",Mg=async(o,e)=>Ph(o.body)?{...o,body:await T0(o.body,e)}:o,Zs=async(o,e)=>({...o,body:await T0(o.body,e)}),Ig=new WeakMap;function BS(o){const e=typeof o=="function"?o:o.fetch,t=Ig.get(e);if(t)return t;const n=(async()=>{try{const i="Response"in e?e.Response:(await e("data:,")).constructor,a=new FormData;return a.toString()!==await new i(a).text()}catch{return!0}})();return Ig.set(e,n),n}const T0=async(o,e)=>{if(!await BS(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const t=new FormData;return await Promise.all(Object.entries(o||{}).map(([n,i])=>Nh(t,n,i))),t},P0=o=>o instanceof Blob&&"name"in o,$S=o=>typeof o=="object"&&o!==null&&(o instanceof Response||fd(o)||P0(o)),Ph=o=>{if($S(o))return!0;if(Array.isArray(o))return o.some(Ph);if(o&&typeof o=="object"){for(const e in o)if(Ph(o[e]))return!0}return!1},Nh=async(o,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")o.append(e,String(t));else if(t instanceof Response)o.append(e,ra([await t.blob()],rl(t)));else if(fd(t))o.append(e,ra([await new Response(v0(t)).blob()],rl(t)));else if(P0(t))o.append(e,t,rl(t));else if(Array.isArray(t))await Promise.all(t.map(n=>Nh(o,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,i])=>Nh(o,`${e}[${n}]`,i)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}},N0=o=>o!=null&&typeof o=="object"&&typeof o.size=="number"&&typeof o.type=="string"&&typeof o.text=="function"&&typeof o.slice=="function"&&typeof o.arrayBuffer=="function",zS=o=>o!=null&&typeof o=="object"&&typeof o.name=="string"&&typeof o.lastModified=="number"&&N0(o),US=o=>o!=null&&typeof o=="object"&&typeof o.url=="string"&&typeof o.blob=="function";async function HS(o,e,t){if(E0(),o=await o,zS(o))return o instanceof File?o:ra([await o.arrayBuffer()],o.name);if(US(o)){const i=await o.blob();return e||(e=new URL(o.url).pathname.split(/[\\/]/).pop()),ra(await Rh(i),e,t)}const n=await Rh(o);if(e||(e=rl(o)),!t?.type){const i=n.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof i=="string"&&(t={...t,type:i})}return ra(n,e,t)}async function Rh(o){let e=[];if(typeof o=="string"||ArrayBuffer.isView(o)||o instanceof ArrayBuffer)e.push(o);else if(N0(o))e.push(o instanceof Blob?o:await o.arrayBuffer());else if(fd(o))for await(const t of o)e.push(...await Rh(t));else{const t=o?.constructor?.name;throw new Error(`Unexpected data type: ${typeof o}${t?`; constructor: ${t}`:""}${WS(o)}`)}return e}function WS(o){return typeof o!="object"||o===null?"":`; props: [${Object.getOwnPropertyNames(o).map(t=>`"${t}"`).join(", ")}]`}class ve{constructor(e){this._client=e}}function R0(o){return o.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Dg=Object.freeze(Object.create(null)),VS=(o=R0)=>function(t,...n){if(t.length===1)return t[0];let i=!1;const a=[],l=t.reduce((p,m,y)=>{/[?#]/.test(m)&&(i=!0);const w=n[y];let _=(i?encodeURIComponent:o)(""+w);return y!==n.length&&(w==null||typeof w=="object"&&w.toString===Object.getPrototypeOf(Object.getPrototypeOf(w.hasOwnProperty??Dg)??Dg)?.toString)&&(_=w+"",a.push({start:p.length+m.length,length:_.length,error:`Value of type ${Object.prototype.toString.call(w).slice(8,-1)} is not a valid path parameter`})),p+m+(y===n.length?"":_)},""),c=l.split(/[?#]/,1)[0],h=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let d;for(;(d=h.exec(c))!==null;)a.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(a.sort((p,m)=>p.start-m.start),a.length>0){let p=0;const m=a.reduce((y,w)=>{const _=" ".repeat(w.start-p),b="^".repeat(w.length);return p=w.start+w.length,y+_+b},"");throw new be(`Path parameters result in path with invalid segments:
${a.map(y=>y.error).join(`
`)}
${l}
${m}`)}return l},Q=VS(R0);let M0=class extends ve{list(e,t={},n){return this._client.getAPIList(Q`/chat/completions/${e}/messages`,ht,{query:t,...n})}};function _l(o){return o!==void 0&&"function"in o&&o.function!==void 0}function pd(o){return o?.$brand==="auto-parseable-response-format"}function Aa(o){return o?.$brand==="auto-parseable-tool"}function GS(o,e){return!e||!I0(e)?{...o,choices:o.choices.map(t=>(D0(t.message.tool_calls),{...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:md(o,e)}function md(o,e){const t=o.choices.map(n=>{if(n.finish_reason==="length")throw new p0;if(n.finish_reason==="content_filter")throw new m0;return D0(n.message.tool_calls),{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:n.message.tool_calls?.map(i=>XS(e,i))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?qS(e,n.message.content):null}}});return{...o,choices:t}}function qS(o,e){return o.response_format?.type!=="json_schema"?null:o.response_format?.type==="json_schema"?"$parseRaw"in o.response_format?o.response_format.$parseRaw(e):JSON.parse(e):null}function XS(o,e){const t=o.tools?.find(n=>_l(n)&&n.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Aa(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function KS(o,e){if(!o||!("tools"in o)||!o.tools)return!1;const t=o.tools?.find(n=>_l(n)&&n.function?.name===e.function.name);return _l(t)&&(Aa(t)||t?.function.strict||!1)}function I0(o){return pd(o.response_format)?!0:o.tools?.some(e=>Aa(e)||e.type==="function"&&e.function.strict===!0)??!1}function D0(o){for(const e of o||[])if(e.type!=="function")throw new be(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function YS(o){for(const e of o??[]){if(e.type!=="function")throw new be(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new be(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Al=o=>o?.role==="assistant",L0=o=>o?.role==="tool";var Mh,al,ol,Jr,Zr,ll,ea,ss,ta,Sl,Cl,Fi,O0;class gd{constructor(){Mh.add(this),this.controller=new AbortController,al.set(this,void 0),ol.set(this,()=>{}),Jr.set(this,()=>{}),Zr.set(this,void 0),ll.set(this,()=>{}),ea.set(this,()=>{}),ss.set(this,{}),ta.set(this,!1),Sl.set(this,!1),Cl.set(this,!1),Fi.set(this,!1),Se(this,al,new Promise((e,t)=>{Se(this,ol,e,"f"),Se(this,Jr,t,"f")})),Se(this,Zr,new Promise((e,t)=>{Se(this,ll,e,"f"),Se(this,ea,t,"f")})),$(this,al,"f").catch(()=>{}),$(this,Zr,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},$(this,Mh,"m",O0).bind(this))},0)}_connected(){this.ended||($(this,ol,"f").call(this),this._emit("connect"))}get ended(){return $(this,ta,"f")}get errored(){return $(this,Sl,"f")}get aborted(){return $(this,Cl,"f")}abort(){this.controller.abort()}on(e,t){return($(this,ss,"f")[e]||($(this,ss,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=$(this,ss,"f")[e];if(!n)return this;const i=n.findIndex(a=>a.listener===t);return i>=0&&n.splice(i,1),this}once(e,t){return($(this,ss,"f")[e]||($(this,ss,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{Se(this,Fi,!0),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){Se(this,Fi,!0),await $(this,Zr,"f")}_emit(e,...t){if($(this,ta,"f"))return;e==="end"&&(Se(this,ta,!0),$(this,ll,"f").call(this));const n=$(this,ss,"f")[e];if(n&&($(this,ss,"f")[e]=n.filter(i=>!i.once),n.forEach(({listener:i})=>i(...t))),e==="abort"){const i=t[0];!$(this,Fi,"f")&&!n?.length&&Promise.reject(i),$(this,Jr,"f").call(this,i),$(this,ea,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=t[0];!$(this,Fi,"f")&&!n?.length&&Promise.reject(i),$(this,Jr,"f").call(this,i),$(this,ea,"f").call(this,i),this._emit("end")}}_emitFinal(){}}al=new WeakMap,ol=new WeakMap,Jr=new WeakMap,Zr=new WeakMap,ll=new WeakMap,ea=new WeakMap,ss=new WeakMap,ta=new WeakMap,Sl=new WeakMap,Cl=new WeakMap,Fi=new WeakMap,Mh=new WeakSet,O0=function(e){if(Se(this,Sl,!0),e instanceof Error&&e.name==="AbortError"&&(e=new bn),e instanceof bn)return Se(this,Cl,!0),this._emit("abort",e);if(e instanceof be)return this._emit("error",e);if(e instanceof Error){const t=new be(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new be(String(e)))};function QS(o){return typeof o.parse=="function"}var $t,Ih,kl,Dh,Lh,Oh,F0,j0;const JS=10;class B0 extends gd{constructor(){super(...arguments),$t.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),L0(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Al(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionToolCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new be("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),$(this,$t,"m",Ih).call(this)}async finalMessage(){return await this.done(),$(this,$t,"m",kl).call(this)}async finalFunctionToolCall(){return await this.done(),$(this,$t,"m",Dh).call(this)}async finalFunctionToolCallResult(){return await this.done(),$(this,$t,"m",Lh).call(this)}async totalUsage(){return await this.done(),$(this,$t,"m",Oh).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=$(this,$t,"m",kl).call(this);t&&this._emit("finalMessage",t);const n=$(this,$t,"m",Ih).call(this);n&&this._emit("finalContent",n);const i=$(this,$t,"m",Dh).call(this);i&&this._emit("finalFunctionToolCall",i);const a=$(this,$t,"m",Lh).call(this);a!=null&&this._emit("finalFunctionToolCallResult",a),this._chatCompletions.some(l=>l.usage)&&this._emit("totalUsage",$(this,$t,"m",Oh).call(this))}async _createChatCompletion(e,t,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),$(this,$t,"m",F0).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(md(a,t))}async _runChatCompletion(e,t,n){for(const i of t.messages)this._addMessage(i,!1);return await this._createChatCompletion(e,t,n)}async _runTools(e,t,n){const i="tool",{tool_choice:a="auto",stream:l,...c}=t,h=typeof a!="string"&&a.type==="function"&&a?.function?.name,{maxChatCompletions:d=JS}=n||{},p=t.tools.map(w=>{if(Aa(w)){if(!w.$callback)throw new be("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),m={};for(const w of p)w.type==="function"&&(m[w.function.name||w.function.function.name]=w.function);const y="tools"in t?p.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(const w of t.messages)this._addMessage(w,!1);for(let w=0;w<d;++w){const b=(await this._createChatCompletion(e,{...c,tool_choice:a,tools:y,messages:[...this.messages]},n)).choices[0]?.message;if(!b)throw new be("missing message in ChatCompletion response");if(!b.tool_calls?.length)return;for(const A of b.tool_calls){if(A.type!=="function")continue;const C=A.id,{name:k,arguments:E}=A.function,P=m[k];if(P){if(h&&h!==k){const L=`Invalid tool_call: ${JSON.stringify(k)}. ${JSON.stringify(h)} requested. Please try again`;this._addMessage({role:i,tool_call_id:C,content:L});continue}}else{const L=`Invalid tool_call: ${JSON.stringify(k)}. Available options are: ${Object.keys(m).map(H=>JSON.stringify(H)).join(", ")}. Please try again`;this._addMessage({role:i,tool_call_id:C,content:L});continue}let R;try{R=QS(P)?await P.parse(E):E}catch(L){const H=L instanceof Error?L.message:String(L);this._addMessage({role:i,tool_call_id:C,content:H});continue}const N=await P.function(R,this),O=$(this,$t,"m",j0).call(this,N);if(this._addMessage({role:i,tool_call_id:C,content:O}),h)return}}}}$t=new WeakSet,Ih=function(){return $(this,$t,"m",kl).call(this).content??null},kl=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Al(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new be("stream ended without producing a ChatCompletionMessage with role=assistant")},Dh=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Al(t)&&t?.tool_calls?.length)return t.tool_calls.filter(n=>n.type==="function").at(-1)?.function}},Lh=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(L0(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>n.role==="assistant"&&n.tool_calls?.some(i=>i.type==="function"&&i.id===t.tool_call_id)))return t.content}},Oh=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},F0=function(e){if(e.n!=null&&e.n>1)throw new be("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},j0=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class yd extends B0{static runTools(e,t,n){const i=new yd,a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,a)),i}_addMessage(e,t=!0){super._addMessage(e,t),Al(e)&&e.content&&this._emit("content",e.content)}}const $0=1,z0=2,U0=4,H0=8,W0=16,V0=32,G0=64,q0=128,X0=256,K0=q0|X0,Y0=W0|V0|K0|G0,Q0=$0|z0|Y0,J0=U0|H0,ZS=Q0|J0,_t={STR:$0,NUM:z0,ARR:U0,OBJ:H0,NULL:W0,BOOL:V0,NAN:G0,INFINITY:q0,MINUS_INFINITY:X0,INF:K0,SPECIAL:Y0,ATOM:Q0,COLLECTION:J0,ALL:ZS};class eC extends Error{}class tC extends Error{}function nC(o,e=_t.ALL){if(typeof o!="string")throw new TypeError(`expecting str, got ${typeof o}`);if(!o.trim())throw new Error(`${o} is empty`);return sC(o.trim(),e)}const sC=(o,e)=>{const t=o.length;let n=0;const i=y=>{throw new eC(`${y} at position ${n}`)},a=y=>{throw new tC(`${y} at position ${n}`)},l=()=>(m(),n>=t&&i("Unexpected end of input"),o[n]==='"'?c():o[n]==="{"?h():o[n]==="["?d():o.substring(n,n+4)==="null"||_t.NULL&e&&t-n<4&&"null".startsWith(o.substring(n))?(n+=4,null):o.substring(n,n+4)==="true"||_t.BOOL&e&&t-n<4&&"true".startsWith(o.substring(n))?(n+=4,!0):o.substring(n,n+5)==="false"||_t.BOOL&e&&t-n<5&&"false".startsWith(o.substring(n))?(n+=5,!1):o.substring(n,n+8)==="Infinity"||_t.INFINITY&e&&t-n<8&&"Infinity".startsWith(o.substring(n))?(n+=8,1/0):o.substring(n,n+9)==="-Infinity"||_t.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(o.substring(n))?(n+=9,-1/0):o.substring(n,n+3)==="NaN"||_t.NAN&e&&t-n<3&&"NaN".startsWith(o.substring(n))?(n+=3,NaN):p()),c=()=>{const y=n;let w=!1;for(n++;n<t&&(o[n]!=='"'||w&&o[n-1]==="\\");)w=o[n]==="\\"?!w:!1,n++;if(o.charAt(n)=='"')try{return JSON.parse(o.substring(y,++n-Number(w)))}catch(_){a(String(_))}else if(_t.STR&e)try{return JSON.parse(o.substring(y,n-Number(w))+'"')}catch{return JSON.parse(o.substring(y,o.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},h=()=>{n++,m();const y={};try{for(;o[n]!=="}";){if(m(),n>=t&&_t.OBJ&e)return y;const w=c();m(),n++;try{const _=l();Object.defineProperty(y,w,{value:_,writable:!0,enumerable:!0,configurable:!0})}catch(_){if(_t.OBJ&e)return y;throw _}m(),o[n]===","&&n++}}catch{if(_t.OBJ&e)return y;i("Expected '}' at end of object")}return n++,y},d=()=>{n++;const y=[];try{for(;o[n]!=="]";)y.push(l()),m(),o[n]===","&&n++}catch{if(_t.ARR&e)return y;i("Expected ']' at end of array")}return n++,y},p=()=>{if(n===0){o==="-"&&_t.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(o)}catch(w){if(_t.NUM&e)try{return o[o.length-1]==="."?JSON.parse(o.substring(0,o.lastIndexOf("."))):JSON.parse(o.substring(0,o.lastIndexOf("e")))}catch{}a(String(w))}}const y=n;for(o[n]==="-"&&n++;o[n]&&!",]}".includes(o[n]);)n++;n==t&&!(_t.NUM&e)&&i("Unterminated number literal");try{return JSON.parse(o.substring(y,n))}catch{o.substring(y,n)==="-"&&_t.NUM&e&&i("Not sure what '-' is");try{return JSON.parse(o.substring(y,o.lastIndexOf("e")))}catch(_){a(String(_))}}},m=()=>{for(;n<t&&` 
\r	`.includes(o[n]);)n++};return l()},Lg=o=>nC(o,_t.ALL^_t.NUM);var mt,ts,Pi,ks,rh,Ko,ah,oh,lh,Yo,ch,Og;class pa extends B0{constructor(e){super(),mt.add(this),ts.set(this,void 0),Pi.set(this,void 0),ks.set(this,void 0),Se(this,ts,e),Se(this,Pi,[])}get currentChatCompletionSnapshot(){return $(this,ks,"f")}static fromReadableStream(e){const t=new pa(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const i=new pa(t);return i._run(()=>i._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createChatCompletion(e,t,n){super._createChatCompletion;const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),$(this,mt,"m",rh).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const l of a)$(this,mt,"m",ah).call(this,l);if(a.controller.signal?.aborted)throw new bn;return this._addChatCompletion($(this,mt,"m",Yo).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),$(this,mt,"m",rh).call(this),this._connected();const i=Wn.fromReadableStream(e,this.controller);let a;for await(const l of i)a&&a!==l.id&&this._addChatCompletion($(this,mt,"m",Yo).call(this)),$(this,mt,"m",ah).call(this,l),a=l.id;if(i.controller.signal?.aborted)throw new bn;return this._addChatCompletion($(this,mt,"m",Yo).call(this))}[(ts=new WeakMap,Pi=new WeakMap,ks=new WeakMap,mt=new WeakSet,rh=function(){this.ended||Se(this,ks,void 0)},Ko=function(t){let n=$(this,Pi,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},$(this,Pi,"f")[t.index]=n,n)},ah=function(t){if(this.ended)return;const n=$(this,mt,"m",Og).call(this,t);this._emit("chunk",t,n);for(const i of t.choices){const a=n.choices[i.index];i.delta.content!=null&&a.message?.role==="assistant"&&a.message?.content&&(this._emit("content",i.delta.content,a.message.content),this._emit("content.delta",{delta:i.delta.content,snapshot:a.message.content,parsed:a.message.parsed})),i.delta.refusal!=null&&a.message?.role==="assistant"&&a.message?.refusal&&this._emit("refusal.delta",{delta:i.delta.refusal,snapshot:a.message.refusal}),i.logprobs?.content!=null&&a.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:i.logprobs?.content,snapshot:a.logprobs?.content??[]}),i.logprobs?.refusal!=null&&a.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:i.logprobs?.refusal,snapshot:a.logprobs?.refusal??[]});const l=$(this,mt,"m",Ko).call(this,a);a.finish_reason&&($(this,mt,"m",lh).call(this,a),l.current_tool_call_index!=null&&$(this,mt,"m",oh).call(this,a,l.current_tool_call_index));for(const c of i.delta.tool_calls??[])l.current_tool_call_index!==c.index&&($(this,mt,"m",lh).call(this,a),l.current_tool_call_index!=null&&$(this,mt,"m",oh).call(this,a,l.current_tool_call_index)),l.current_tool_call_index=c.index;for(const c of i.delta.tool_calls??[]){const h=a.message.tool_calls?.[c.index];h?.type&&(h?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:h.function?.name,index:c.index,arguments:h.function.arguments,parsed_arguments:h.function.parsed_arguments,arguments_delta:c.function?.arguments??""}):(h?.type,void 0))}}},oh=function(t,n){if($(this,mt,"m",Ko).call(this,t).done_tool_calls.has(n))return;const a=t.message.tool_calls?.[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const l=$(this,ts,"f")?.tools?.find(c=>_l(c)&&c.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:Aa(l)?l.$parseRaw(a.function.arguments):l?.function.strict?JSON.parse(a.function.arguments):null})}else a.type},lh=function(t){const n=$(this,mt,"m",Ko).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const i=$(this,mt,"m",ch).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Yo=function(){if(this.ended)throw new be("stream has ended, this shouldn't happen");const t=$(this,ks,"f");if(!t)throw new be("request ended without sending any chunks");return Se(this,ks,void 0),Se(this,Pi,[]),iC(t,$(this,ts,"f"))},ch=function(){const t=$(this,ts,"f")?.response_format;return pd(t)?t:null},Og=function(t){var n,i,a,l;let c=$(this,ks,"f");const{choices:h,...d}=t;c?Object.assign(c,d):c=Se(this,ks,{...d,choices:[]});for(const{delta:p,finish_reason:m,index:y,logprobs:w=null,..._}of t.choices){let b=c.choices[y];if(b||(b=c.choices[y]={finish_reason:m,index:y,message:{},logprobs:w,..._}),w)if(!b.logprobs)b.logprobs=Object.assign({},w);else{const{content:N,refusal:O,...L}=w;Object.assign(b.logprobs,L),N&&((n=b.logprobs).content??(n.content=[]),b.logprobs.content.push(...N)),O&&((i=b.logprobs).refusal??(i.refusal=[]),b.logprobs.refusal.push(...O))}if(m&&(b.finish_reason=m,$(this,ts,"f")&&I0($(this,ts,"f")))){if(m==="length")throw new p0;if(m==="content_filter")throw new m0}if(Object.assign(b,_),!p)continue;const{content:A,refusal:C,function_call:k,role:E,tool_calls:P,...R}=p;if(Object.assign(b.message,R),C&&(b.message.refusal=(b.message.refusal||"")+C),E&&(b.message.role=E),k&&(b.message.function_call?(k.name&&(b.message.function_call.name=k.name),k.arguments&&((a=b.message.function_call).arguments??(a.arguments=""),b.message.function_call.arguments+=k.arguments)):b.message.function_call=k),A&&(b.message.content=(b.message.content||"")+A,!b.message.refusal&&$(this,mt,"m",ch).call(this)&&(b.message.parsed=Lg(b.message.content))),P){b.message.tool_calls||(b.message.tool_calls=[]);for(const{index:N,id:O,type:L,function:H,...V}of P){const q=(l=b.message.tool_calls)[N]??(l[N]={});Object.assign(q,V),O&&(q.id=O),L&&(q.type=L),H&&(q.function??(q.function={name:H.name??"",arguments:""})),H?.name&&(q.function.name=H.name),H?.arguments&&(q.function.arguments+=H.arguments,KS($(this,ts,"f"),q)&&(q.function.parsed_arguments=Lg(q.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",i=>{const a=t.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const a of t)a.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const a of t)a.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,l)=>t.push({resolve:a,reject:l})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Wn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function iC(o,e){const{id:t,choices:n,created:i,model:a,system_fingerprint:l,...c}=o,h={...c,id:t,choices:n.map(({message:d,finish_reason:p,index:m,logprobs:y,...w})=>{if(!p)throw new be(`missing finish_reason for choice ${m}`);const{content:_=null,function_call:b,tool_calls:A,...C}=d,k=d.role;if(!k)throw new be(`missing role for choice ${m}`);if(b){const{arguments:E,name:P}=b;if(E==null)throw new be(`missing function_call.arguments for choice ${m}`);if(!P)throw new be(`missing function_call.name for choice ${m}`);return{...w,message:{content:_,function_call:{arguments:E,name:P},role:k,refusal:d.refusal??null},finish_reason:p,index:m,logprobs:y}}return A?{...w,index:m,finish_reason:p,logprobs:y,message:{...C,role:k,content:_,refusal:d.refusal??null,tool_calls:A.map((E,P)=>{const{function:R,type:N,id:O,...L}=E,{arguments:H,name:V,...q}=R||{};if(O==null)throw new be(`missing choices[${m}].tool_calls[${P}].id
${Qo(o)}`);if(N==null)throw new be(`missing choices[${m}].tool_calls[${P}].type
${Qo(o)}`);if(V==null)throw new be(`missing choices[${m}].tool_calls[${P}].function.name
${Qo(o)}`);if(H==null)throw new be(`missing choices[${m}].tool_calls[${P}].function.arguments
${Qo(o)}`);return{...L,id:O,type:N,function:{...q,name:V,arguments:H}}})}}:{...w,message:{...C,content:_,role:k,refusal:d.refusal??null},finish_reason:p,index:m,logprobs:y}}),created:i,model:a,object:"chat.completion",...l?{system_fingerprint:l}:{}};return GS(h,e)}function Qo(o){return JSON.stringify(o)}class El extends pa{static fromReadableStream(e){const t=new El(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,n){const i=new El(t),a={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return i._run(()=>i._runTools(e,t,a)),i}}let vd=class extends ve{constructor(){super(...arguments),this.messages=new M0(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(Q`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(Q`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/chat/completions",ht,{query:e,...t})}delete(e,t){return this._client.delete(Q`/chat/completions/${e}`,t)}parse(e,t){return YS(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(n=>md(n,e))}runTools(e,t){return e.stream?El.runTools(this._client,e,t):yd.runTools(this._client,e,t)}stream(e,t){return pa.createChatCompletion(this._client,e,t)}};vd.Messages=M0;class wd extends ve{constructor(){super(...arguments),this.completions=new vd(this._client)}}wd.Completions=vd;const Z0=Symbol("brand.privateNullableHeaders");function*rC(o){if(!o)return;if(Z0 in o){const{values:n,nulls:i}=o;yield*n.entries();for(const a of i)yield[a,null];return}let e=!1,t;o instanceof Headers?t=o.entries():bg(o)?t=o:(e=!0,t=Object.entries(o??{}));for(let n of t){const i=n[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const a=bg(n[1])?n[1]:[n[1]];let l=!1;for(const c of a)c!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,c])}}const he=o=>{const e=new Headers,t=new Set;for(const n of o){const i=new Set;for(const[a,l]of rC(n)){const c=a.toLowerCase();i.has(c)||(e.delete(a),i.add(c)),l===null?(e.delete(a),t.add(c)):(e.append(a,l),t.delete(c))}}return{[Z0]:!0,values:e,nulls:t}};class ev extends ve{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:he([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}}class tv extends ve{create(e,t){return this._client.post("/audio/transcriptions",Zs({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class nv extends ve{create(e,t){return this._client.post("/audio/translations",Zs({body:e,...t,__metadata:{model:e.model}},this._client))}}class Sa extends ve{constructor(){super(...arguments),this.transcriptions=new tv(this._client),this.translations=new nv(this._client),this.speech=new ev(this._client)}}Sa.Transcriptions=tv;Sa.Translations=nv;Sa.Speech=ev;class sv extends ve{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(Q`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",ht,{query:e,...t})}cancel(e,t){return this._client.post(Q`/batches/${e}/cancel`,t)}}class iv extends ve{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(Q`/assistants/${e}`,{...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,n){return this._client.post(Q`/assistants/${e}`,{body:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",ht,{query:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(Q`/assistants/${e}`,{...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}let rv=class extends ve{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}};class av extends ve{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}let zl=class extends ve{constructor(){super(...arguments),this.sessions=new rv(this._client),this.transcriptionSessions=new av(this._client)}};zl.Sessions=rv;zl.TranscriptionSessions=av;class ov extends ve{create(e,t){return this._client.post("/chatkit/sessions",{body:e,...t,headers:he([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}cancel(e,t){return this._client.post(Q`/chatkit/sessions/${e}/cancel`,{...t,headers:he([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}}let lv=class extends ve{retrieve(e,t){return this._client.get(Q`/chatkit/threads/${e}`,{...t,headers:he([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",xl,{query:e,...t,headers:he([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}delete(e,t){return this._client.delete(Q`/chatkit/threads/${e}`,{...t,headers:he([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}listItems(e,t={},n){return this._client.getAPIList(Q`/chatkit/threads/${e}/items`,xl,{query:t,...n,headers:he([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}};class Ul extends ve{constructor(){super(...arguments),this.sessions=new ov(this._client),this.threads=new lv(this._client)}}Ul.Sessions=ov;Ul.Threads=lv;class cv extends ve{create(e,t,n){return this._client.post(Q`/threads/${e}/messages`,{body:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,t,n){const{thread_id:i}=t;return this._client.get(Q`/threads/${i}/messages/${e}`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,t,n){const{thread_id:i,...a}=t;return this._client.post(Q`/threads/${i}/messages/${e}`,{body:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t={},n){return this._client.getAPIList(Q`/threads/${e}/messages`,ht,{query:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,t,n){const{thread_id:i}=t;return this._client.delete(Q`/threads/${i}/messages/${e}`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}class uv extends ve{retrieve(e,t,n){const{thread_id:i,run_id:a,...l}=t;return this._client.get(Q`/threads/${i}/runs/${a}/steps/${e}`,{query:l,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t,n){const{thread_id:i,...a}=t;return this._client.getAPIList(Q`/threads/${i}/runs/${e}/steps`,ht,{query:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}const aC=o=>{if(typeof Buffer<"u"){const e=Buffer.from(o,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(o),t=e.length,n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=e.charCodeAt(i);return Array.from(new Float32Array(n.buffer))}};var oC={};const Ni=o=>{if(typeof globalThis.process<"u")return oC?.[o]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(o)?.trim()};var Nt,Ks,Fh,Hn,cl,Nn,Ys,Ui,qs,Tl,an,ul,hl,aa,na,sa,Fg,jg,Bg,$g,zg,Ug,Hg;class oa extends gd{constructor(){super(...arguments),Nt.add(this),Fh.set(this,[]),Hn.set(this,{}),cl.set(this,{}),Nn.set(this,void 0),Ys.set(this,void 0),Ui.set(this,void 0),qs.set(this,void 0),Tl.set(this,void 0),an.set(this,void 0),ul.set(this,void 0),hl.set(this,void 0),aa.set(this,void 0)}[(Fh=new WeakMap,Hn=new WeakMap,cl=new WeakMap,Nn=new WeakMap,Ys=new WeakMap,Ui=new WeakMap,qs=new WeakMap,Tl=new WeakMap,an=new WeakMap,ul=new WeakMap,hl=new WeakMap,aa=new WeakMap,Nt=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",i=>{const a=t.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const a of t)a.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const a of t)a.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,l)=>t.push({resolve:a,reject:l})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Ks;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const i=Wn.fromReadableStream(e,this.controller);for await(const a of i)$(this,Nt,"m",na).call(this,a);if(i.controller.signal?.aborted)throw new bn;return this._addRun($(this,Nt,"m",sa).call(this))}toReadableStream(){return new Wn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,i){const a=new Ks;return a._run(()=>a._runToolAssistantStream(e,t,n,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,n,i){const a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await e.submitToolOutputs(t,l,{...i,signal:this.controller.signal});this._connected();for await(const h of c)$(this,Nt,"m",na).call(this,h);if(c.controller.signal?.aborted)throw new bn;return this._addRun($(this,Nt,"m",sa).call(this))}static createThreadAssistantStream(e,t,n){const i=new Ks;return i._run(()=>i._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}static createAssistantStream(e,t,n,i){const a=new Ks;return a._run(()=>a._runAssistantStream(e,t,n,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return $(this,ul,"f")}currentRun(){return $(this,hl,"f")}currentMessageSnapshot(){return $(this,Nn,"f")}currentRunStepSnapshot(){return $(this,aa,"f")}async finalRunSteps(){return await this.done(),Object.values($(this,Hn,"f"))}async finalMessages(){return await this.done(),Object.values($(this,cl,"f"))}async finalRun(){if(await this.done(),!$(this,Ys,"f"))throw Error("Final run was not received.");return $(this,Ys,"f")}async _createThreadAssistantStream(e,t,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},l=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const c of l)$(this,Nt,"m",na).call(this,c);if(l.controller.signal?.aborted)throw new bn;return this._addRun($(this,Nt,"m",sa).call(this))}async _createAssistantStream(e,t,n,i){const a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},c=await e.create(t,l,{...i,signal:this.controller.signal});this._connected();for await(const h of c)$(this,Nt,"m",na).call(this,h);if(c.controller.signal?.aborted)throw new bn;return this._addRun($(this,Nt,"m",sa).call(this))}static accumulateDelta(e,t){for(const[n,i]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=i;continue}let a=e[n];if(a==null){e[n]=i;continue}if(n==="index"||n==="type"){e[n]=i;continue}if(typeof a=="string"&&typeof i=="string")a+=i;else if(typeof a=="number"&&typeof i=="number")a+=i;else if(nh(a)&&nh(i))a=this.accumulateDelta(a,i);else if(Array.isArray(a)&&Array.isArray(i)){if(a.every(l=>typeof l=="string"||typeof l=="number")){a.push(...i);continue}for(const l of i){if(!nh(l))throw new Error(`Expected array delta entry to be an object but got: ${l}`);const c=l.index;if(c==null)throw console.error(l),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const h=a[c];h==null?a.push(l):a[c]=this.accumulateDelta(h,l)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${i}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,i){return await this._createAssistantStream(t,e,n,i)}async _runToolAssistantStream(e,t,n,i){return await this._createToolAssistantStream(t,e,n,i)}}Ks=oa,na=function(e){if(!this.ended)switch(Se(this,ul,e),$(this,Nt,"m",Bg).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":$(this,Nt,"m",Hg).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":$(this,Nt,"m",jg).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":$(this,Nt,"m",Fg).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},sa=function(){if(this.ended)throw new be("stream has ended, this shouldn't happen");if(!$(this,Ys,"f"))throw Error("Final run has not been received");return $(this,Ys,"f")},Fg=function(e){const[t,n]=$(this,Nt,"m",zg).call(this,e,$(this,Nn,"f"));Se(this,Nn,t),$(this,cl,"f")[t.id]=t;for(const i of n){const a=t.content[i.index];a?.type=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const i of e.data.delta.content){if(i.type=="text"&&i.text){let a=i.text,l=t.content[i.index];if(l&&l.type=="text")this._emit("textDelta",a,l.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(i.index!=$(this,Ui,"f")){if($(this,qs,"f"))switch($(this,qs,"f").type){case"text":this._emit("textDone",$(this,qs,"f").text,$(this,Nn,"f"));break;case"image_file":this._emit("imageFileDone",$(this,qs,"f").image_file,$(this,Nn,"f"));break}Se(this,Ui,i.index)}Se(this,qs,t.content[i.index])}break;case"thread.message.completed":case"thread.message.incomplete":if($(this,Ui,"f")!==void 0){const i=e.data.content[$(this,Ui,"f")];if(i)switch(i.type){case"image_file":this._emit("imageFileDone",i.image_file,$(this,Nn,"f"));break;case"text":this._emit("textDone",i.text,$(this,Nn,"f"));break}}$(this,Nn,"f")&&this._emit("messageDone",e.data),Se(this,Nn,void 0)}},jg=function(e){const t=$(this,Nt,"m",$g).call(this,e);switch(Se(this,aa,t),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==$(this,Tl,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):($(this,an,"f")&&this._emit("toolCallDone",$(this,an,"f")),Se(this,Tl,a.index),Se(this,an,t.step_details.tool_calls[a.index]),$(this,an,"f")&&this._emit("toolCallCreated",$(this,an,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Se(this,aa,void 0),e.data.step_details.type=="tool_calls"&&$(this,an,"f")&&(this._emit("toolCallDone",$(this,an,"f")),Se(this,an,void 0)),this._emit("runStepDone",e.data,t);break}},Bg=function(e){$(this,Fh,"f").push(e),this._emit("event",e)},$g=function(e){switch(e.event){case"thread.run.step.created":return $(this,Hn,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=$(this,Hn,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const i=Ks.accumulateDelta(t,n.delta);$(this,Hn,"f")[e.data.id]=i}return $(this,Hn,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":$(this,Hn,"f")[e.data.id]=e.data;break}if($(this,Hn,"f")[e.data.id])return $(this,Hn,"f")[e.data.id];throw new Error("No snapshot available")},zg=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let i=e.data;if(i.delta.content)for(const a of i.delta.content)if(a.index in t.content){let l=t.content[a.index];t.content[a.index]=$(this,Nt,"m",Ug).call(this,a,l)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ug=function(e,t){return Ks.accumulateDelta(t,e)},Hg=function(e){switch(Se(this,hl,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":Se(this,Ys,e.data),$(this,an,"f")&&(this._emit("toolCallDone",$(this,an,"f")),Se(this,an,void 0));break}};let bd=class extends ve{constructor(){super(...arguments),this.steps=new uv(this._client)}create(e,t,n){const{include:i,...a}=t;return this._client.post(Q`/threads/${e}/runs`,{query:{include:i},body:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:t.stream??!1})}retrieve(e,t,n){const{thread_id:i}=t;return this._client.get(Q`/threads/${i}/runs/${e}`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,t,n){const{thread_id:i,...a}=t;return this._client.post(Q`/threads/${i}/runs/${e}`,{body:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t={},n){return this._client.getAPIList(Q`/threads/${e}/runs`,ht,{query:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}cancel(e,t,n){const{thread_id:i}=t;return this._client.post(Q`/threads/${i}/runs/${e}/cancel`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(e,t,n){const i=await this.create(e,t,n);return await this.poll(i.id,{thread_id:e},n)}createAndStream(e,t,n){return oa.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const i=he([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:a,response:l}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...i}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(n?.pollIntervalMs)c=n.pollIntervalMs;else{const h=l.headers.get("openai-poll-after-ms");if(h){const d=parseInt(h);isNaN(d)||(c=d)}}await _a(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return oa.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){const{thread_id:i,...a}=t;return this._client.post(Q`/threads/${i}/runs/${e}/submit_tool_outputs`,{body:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,n){const i=await this.submitToolOutputs(e,t,n);return await this.poll(i.id,t,n)}submitToolOutputsStream(e,t,n){return oa.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}};bd.Steps=uv;class Hl extends ve{constructor(){super(...arguments),this.runs=new bd(this._client),this.messages=new cv(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(Q`/threads/${e}`,{...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,n){return this._client.post(Q`/threads/${e}`,{body:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,t){return this._client.delete(Q`/threads/${e}`,{...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.id,{thread_id:n.thread_id},t)}createAndRunStream(e,t){return oa.createThreadAssistantStream(e,this._client.beta.threads,t)}}Hl.Runs=bd;Hl.Messages=cv;class Qi extends ve{constructor(){super(...arguments),this.realtime=new zl(this._client),this.chatkit=new Ul(this._client),this.assistants=new iv(this._client),this.threads=new Hl(this._client)}}Qi.Realtime=zl;Qi.ChatKit=Ul;Qi.Assistants=iv;Qi.Threads=Hl;class hv extends ve{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class dv extends ve{retrieve(e,t,n){const{container_id:i}=t;return this._client.get(Q`/containers/${i}/files/${e}/content`,{...n,headers:he([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}}let xd=class extends ve{constructor(){super(...arguments),this.content=new dv(this._client)}create(e,t,n){return this._client.post(Q`/containers/${e}/files`,Zs({body:t,...n},this._client))}retrieve(e,t,n){const{container_id:i}=t;return this._client.get(Q`/containers/${i}/files/${e}`,n)}list(e,t={},n){return this._client.getAPIList(Q`/containers/${e}/files`,ht,{query:t,...n})}delete(e,t,n){const{container_id:i}=t;return this._client.delete(Q`/containers/${i}/files/${e}`,{...n,headers:he([{Accept:"*/*"},n?.headers])})}};xd.Content=dv;class _d extends ve{constructor(){super(...arguments),this.files=new xd(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(Q`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",ht,{query:e,...t})}delete(e,t){return this._client.delete(Q`/containers/${e}`,{...t,headers:he([{Accept:"*/*"},t?.headers])})}}_d.Files=xd;class fv extends ve{create(e,t,n){const{include:i,...a}=t;return this._client.post(Q`/conversations/${e}/items`,{query:{include:i},body:a,...n})}retrieve(e,t,n){const{conversation_id:i,...a}=t;return this._client.get(Q`/conversations/${i}/items/${e}`,{query:a,...n})}list(e,t={},n){return this._client.getAPIList(Q`/conversations/${e}/items`,xl,{query:t,...n})}delete(e,t,n){const{conversation_id:i}=t;return this._client.delete(Q`/conversations/${i}/items/${e}`,n)}}class Ad extends ve{constructor(){super(...arguments),this.items=new fv(this._client)}create(e={},t){return this._client.post("/conversations",{body:e,...t})}retrieve(e,t){return this._client.get(Q`/conversations/${e}`,t)}update(e,t,n){return this._client.post(Q`/conversations/${e}`,{body:t,...n})}delete(e,t){return this._client.delete(Q`/conversations/${e}`,t)}}Ad.Items=fv;class pv extends ve{create(e,t){const n=!!e.encoding_format;let i=n?e.encoding_format:"base64";n&&Pt(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:i},...t});return n?a:(Pt(this._client).debug("embeddings/decoding base64 embeddings from base64"),a._thenUnwrap(l=>(l&&l.data&&l.data.forEach(c=>{const h=c.embedding;c.embedding=aC(h)}),l)))}}class mv extends ve{retrieve(e,t,n){const{eval_id:i,run_id:a}=t;return this._client.get(Q`/evals/${i}/runs/${a}/output_items/${e}`,n)}list(e,t,n){const{eval_id:i,...a}=t;return this._client.getAPIList(Q`/evals/${i}/runs/${e}/output_items`,ht,{query:a,...n})}}class Sd extends ve{constructor(){super(...arguments),this.outputItems=new mv(this._client)}create(e,t,n){return this._client.post(Q`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){const{eval_id:i}=t;return this._client.get(Q`/evals/${i}/runs/${e}`,n)}list(e,t={},n){return this._client.getAPIList(Q`/evals/${e}/runs`,ht,{query:t,...n})}delete(e,t,n){const{eval_id:i}=t;return this._client.delete(Q`/evals/${i}/runs/${e}`,n)}cancel(e,t,n){const{eval_id:i}=t;return this._client.post(Q`/evals/${i}/runs/${e}`,n)}}Sd.OutputItems=mv;class Cd extends ve{constructor(){super(...arguments),this.runs=new Sd(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(Q`/evals/${e}`,t)}update(e,t,n){return this._client.post(Q`/evals/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/evals",ht,{query:e,...t})}delete(e,t){return this._client.delete(Q`/evals/${e}`,t)}}Cd.Runs=Sd;let gv=class extends ve{create(e,t){return this._client.post("/files",Zs({body:e,...t},this._client))}retrieve(e,t){return this._client.get(Q`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",ht,{query:e,...t})}delete(e,t){return this._client.delete(Q`/files/${e}`,t)}content(e,t){return this._client.get(Q`/files/${e}/content`,{...t,headers:he([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=1800*1e3}={}){const i=new Set(["processed","error","deleted"]),a=Date.now();let l=await this.retrieve(e);for(;!l.status||!i.has(l.status);)if(await _a(t),l=await this.retrieve(e),Date.now()-a>n)throw new ud({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return l}};class yv extends ve{}let vv=class extends ve{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class kd extends ve{constructor(){super(...arguments),this.graders=new vv(this._client)}}kd.Graders=vv;class wv extends ve{create(e,t,n){return this._client.getAPIList(Q`/fine_tuning/checkpoints/${e}/permissions`,$l,{body:t,method:"post",...n})}retrieve(e,t={},n){return this._client.get(Q`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}delete(e,t,n){const{fine_tuned_model_checkpoint:i}=t;return this._client.delete(Q`/fine_tuning/checkpoints/${i}/permissions/${e}`,n)}}let Ed=class extends ve{constructor(){super(...arguments),this.permissions=new wv(this._client)}};Ed.Permissions=wv;class bv extends ve{list(e,t={},n){return this._client.getAPIList(Q`/fine_tuning/jobs/${e}/checkpoints`,ht,{query:t,...n})}}class Td extends ve{constructor(){super(...arguments),this.checkpoints=new bv(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(Q`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",ht,{query:e,...t})}cancel(e,t){return this._client.post(Q`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return this._client.getAPIList(Q`/fine_tuning/jobs/${e}/events`,ht,{query:t,...n})}pause(e,t){return this._client.post(Q`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(Q`/fine_tuning/jobs/${e}/resume`,t)}}Td.Checkpoints=bv;class Ji extends ve{constructor(){super(...arguments),this.methods=new yv(this._client),this.jobs=new Td(this._client),this.checkpoints=new Ed(this._client),this.alpha=new kd(this._client)}}Ji.Methods=yv;Ji.Jobs=Td;Ji.Checkpoints=Ed;Ji.Alpha=kd;class xv extends ve{}class Pd extends ve{constructor(){super(...arguments),this.graderModels=new xv(this._client)}}Pd.GraderModels=xv;class _v extends ve{createVariation(e,t){return this._client.post("/images/variations",Zs({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",Zs({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}class Av extends ve{retrieve(e,t){return this._client.get(Q`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",$l,e)}delete(e,t){return this._client.delete(Q`/models/${e}`,t)}}class Sv extends ve{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class Cv extends ve{accept(e,t,n){return this._client.post(Q`/realtime/calls/${e}/accept`,{body:t,...n,headers:he([{Accept:"*/*"},n?.headers])})}hangup(e,t){return this._client.post(Q`/realtime/calls/${e}/hangup`,{...t,headers:he([{Accept:"*/*"},t?.headers])})}refer(e,t,n){return this._client.post(Q`/realtime/calls/${e}/refer`,{body:t,...n,headers:he([{Accept:"*/*"},n?.headers])})}reject(e,t={},n){return this._client.post(Q`/realtime/calls/${e}/reject`,{body:t,...n,headers:he([{Accept:"*/*"},n?.headers])})}}class kv extends ve{create(e,t){return this._client.post("/realtime/client_secrets",{body:e,...t})}}class Wl extends ve{constructor(){super(...arguments),this.clientSecrets=new kv(this._client),this.calls=new Cv(this._client)}}Wl.ClientSecrets=kv;Wl.Calls=Cv;function lC(o,e){return!e||!uC(e)?{...o,output_parsed:null,output:o.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:Ev(o,e)}function Ev(o,e){const t=o.output.map(i=>{if(i.type==="function_call")return{...i,parsed_arguments:fC(e,i)};if(i.type==="message"){const a=i.content.map(l=>l.type==="output_text"?{...l,parsed:cC(e,l.text)}:l);return{...i,content:a}}return i}),n=Object.assign({},o,{output:t});return Object.getOwnPropertyDescriptor(o,"output_text")||jh(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const i of n.output)if(i.type==="message"){for(const a of i.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function cC(o,e){return o.text?.format?.type!=="json_schema"?null:"$parseRaw"in o.text?.format?(o.text?.format).$parseRaw(e):JSON.parse(e)}function uC(o){return!!pd(o.text?.format)}function hC(o){return o?.$brand==="auto-parseable-tool"}function dC(o,e){return o.find(t=>t.type==="function"&&t.name===e)}function fC(o,e){const t=dC(o.tools??[],e.name);return{...e,...e,parsed_arguments:hC(t)?t.$parseRaw(e.arguments):t?.strict?JSON.parse(e.arguments):null}}function jh(o){const e=[];for(const t of o.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);o.output_text=e.join("")}var Ri,Jo,Es,Zo,Wg,Vg,Gg,qg;class Nd extends gd{constructor(e){super(),Ri.add(this),Jo.set(this,void 0),Es.set(this,void 0),Zo.set(this,void 0),Se(this,Jo,e)}static createResponse(e,t,n){const i=new Nd(t);return i._run(()=>i._createOrRetrieveResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createOrRetrieveResponse(e,t,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),$(this,Ri,"m",Wg).call(this);let a,l=null;"response_id"in t?(a=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),l=t.starting_after??null):a=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const c of a)$(this,Ri,"m",Vg).call(this,c,l);if(a.controller.signal?.aborted)throw new bn;return $(this,Ri,"m",Gg).call(this)}[(Jo=new WeakMap,Es=new WeakMap,Zo=new WeakMap,Ri=new WeakSet,Wg=function(){this.ended||Se(this,Es,void 0)},Vg=function(t,n){if(this.ended)return;const i=(l,c)=>{(n==null||c.sequence_number>n)&&this._emit(l,c)},a=$(this,Ri,"m",qg).call(this,t);switch(i("event",t),t.type){case"response.output_text.delta":{const l=a.output[t.output_index];if(!l)throw new be(`missing output at index ${t.output_index}`);if(l.type==="message"){const c=l.content[t.content_index];if(!c)throw new be(`missing content at index ${t.content_index}`);if(c.type!=="output_text")throw new be(`expected content to be 'output_text', got ${c.type}`);i("response.output_text.delta",{...t,snapshot:c.text})}break}case"response.function_call_arguments.delta":{const l=a.output[t.output_index];if(!l)throw new be(`missing output at index ${t.output_index}`);l.type==="function_call"&&i("response.function_call_arguments.delta",{...t,snapshot:l.arguments});break}default:i(t.type,t);break}},Gg=function(){if(this.ended)throw new be("stream has ended, this shouldn't happen");const t=$(this,Es,"f");if(!t)throw new be("request ended without sending any events");Se(this,Es,void 0);const n=pC(t,$(this,Jo,"f"));return Se(this,Zo,n),n},qg=function(t){let n=$(this,Es,"f");if(!n){if(t.type!=="response.created")throw new be(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=Se(this,Es,t.response),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const i=n.output[t.output_index];if(!i)throw new be(`missing output at index ${t.output_index}`);const a=i.type,l=t.part;a==="message"&&l.type!=="reasoning_text"?i.content.push(l):a==="reasoning"&&l.type==="reasoning_text"&&(i.content||(i.content=[]),i.content.push(l));break}case"response.output_text.delta":{const i=n.output[t.output_index];if(!i)throw new be(`missing output at index ${t.output_index}`);if(i.type==="message"){const a=i.content[t.content_index];if(!a)throw new be(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new be(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const i=n.output[t.output_index];if(!i)throw new be(`missing output at index ${t.output_index}`);i.type==="function_call"&&(i.arguments+=t.delta);break}case"response.reasoning_text.delta":{const i=n.output[t.output_index];if(!i)throw new be(`missing output at index ${t.output_index}`);if(i.type==="reasoning"){const a=i.content?.[t.content_index];if(!a)throw new be(`missing content at index ${t.content_index}`);if(a.type!=="reasoning_text")throw new be(`expected content to be 'reasoning_text', got ${a.type}`);a.text+=t.delta}break}case"response.completed":{Se(this,Es,t.response);break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",i=>{const a=t.shift();a?a.resolve(i):e.push(i)}),this.on("end",()=>{n=!0;for(const i of t)i.resolve(void 0);t.length=0}),this.on("abort",i=>{n=!0;for(const a of t)a.reject(i);t.length=0}),this.on("error",i=>{n=!0;for(const a of t)a.reject(i);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,l)=>t.push({resolve:a,reject:l})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=$(this,Zo,"f");if(!e)throw new be("stream ended without producing a ChatCompletion");return e}}function pC(o,e){return lC(o,e)}class Tv extends ve{list(e,t={},n){return this._client.getAPIList(Q`/responses/${e}/input_items`,ht,{query:t,...n})}}class Pv extends ve{count(e={},t){return this._client.post("/responses/input_tokens",{body:e,...t})}}class Vl extends ve{constructor(){super(...arguments),this.inputItems=new Tv(this._client),this.inputTokens=new Pv(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&jh(n),n))}retrieve(e,t={},n){return this._client.get(Q`/responses/${e}`,{query:t,...n,stream:t?.stream??!1})._thenUnwrap(i=>("object"in i&&i.object==="response"&&jh(i),i))}delete(e,t){return this._client.delete(Q`/responses/${e}`,{...t,headers:he([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>Ev(n,e))}stream(e,t){return Nd.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(Q`/responses/${e}/cancel`,t)}compact(e={},t){return this._client.post("/responses/compact",{body:e,...t})}}Vl.InputItems=Tv;Vl.InputTokens=Pv;class Nv extends ve{create(e,t,n){return this._client.post(Q`/uploads/${e}/parts`,Zs({body:t,...n},this._client))}}class Rd extends ve{constructor(){super(...arguments),this.parts=new Nv(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(Q`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(Q`/uploads/${e}/complete`,{body:t,...n})}}Rd.Parts=Nv;const mC=async o=>{const e=await Promise.allSettled(o),t=e.filter(i=>i.status==="rejected");if(t.length){for(const i of t)console.error(i.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const i of e)i.status==="fulfilled"&&n.push(i.value);return n};class Rv extends ve{create(e,t,n){return this._client.post(Q`/vector_stores/${e}/file_batches`,{body:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,t,n){const{vector_store_id:i}=t;return this._client.get(Q`/vector_stores/${i}/file_batches/${e}`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}cancel(e,t,n){const{vector_store_id:i}=t;return this._client.post(Q`/vector_stores/${i}/file_batches/${e}/cancel`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(e,t,n){const i=await this.create(e,t);return await this.poll(e,i.id,n)}listFiles(e,t,n){const{vector_store_id:i,...a}=t;return this._client.getAPIList(Q`/vector_stores/${i}/file_batches/${e}/files`,ht,{query:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async poll(e,t,n){const i=he([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:a,response:l}=await this.retrieve(t,{vector_store_id:e},{...n,headers:i}).withResponse();switch(a.status){case"in_progress":let c=5e3;if(n?.pollIntervalMs)c=n.pollIntervalMs;else{const h=l.headers.get("openai-poll-after-ms");if(h){const d=parseInt(h);isNaN(d)||(c=d)}}await _a(c);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},i){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=i?.maxConcurrency??5,l=Math.min(a,t.length),c=this._client,h=t.values(),d=[...n];async function p(y){for(let w of y){const _=await c.files.create({file:w,purpose:"assistants"},i);d.push(_.id)}}const m=Array(l).fill(h).map(p);return await mC(m),await this.createAndPoll(e,{file_ids:d})}}class Mv extends ve{create(e,t,n){return this._client.post(Q`/vector_stores/${e}/files`,{body:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(e,t,n){const{vector_store_id:i}=t;return this._client.get(Q`/vector_stores/${i}/files/${e}`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(e,t,n){const{vector_store_id:i,...a}=t;return this._client.post(Q`/vector_stores/${i}/files/${e}`,{body:a,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e,t={},n){return this._client.getAPIList(Q`/vector_stores/${e}/files`,ht,{query:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(e,t,n){const{vector_store_id:i}=t;return this._client.delete(Q`/vector_stores/${i}/files/${e}`,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(e,t,n){const i=await this.create(e,t,n);return await this.poll(e,i.id,n)}async poll(e,t,n){const i=he([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){const a=await this.retrieve(t,{vector_store_id:e},{...n,headers:i}).withResponse(),l=a.data;switch(l.status){case"in_progress":let c=5e3;if(n?.pollIntervalMs)c=n.pollIntervalMs;else{const h=a.response.headers.get("openai-poll-after-ms");if(h){const d=parseInt(h);isNaN(d)||(c=d)}}await _a(c);break;case"failed":case"completed":return l}}}async upload(e,t,n){const i=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:i.id},n)}async uploadAndPoll(e,t,n){const i=await this.upload(e,t,n);return await this.poll(e,i.id,n)}content(e,t,n){const{vector_store_id:i}=t;return this._client.getAPIList(Q`/vector_stores/${i}/files/${e}/content`,$l,{...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}class Gl extends ve{constructor(){super(...arguments),this.files=new Mv(this._client),this.fileBatches=new Rv(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(Q`/vector_stores/${e}`,{...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,n){return this._client.post(Q`/vector_stores/${e}`,{body:t,...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",ht,{query:e,...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(Q`/vector_stores/${e}`,{...t,headers:he([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,n){return this._client.getAPIList(Q`/vector_stores/${e}/search`,$l,{body:t,method:"post",...n,headers:he([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}Gl.Files=Mv;Gl.FileBatches=Rv;class Iv extends ve{create(e,t){return this._client.post("/videos",Mg({body:e,...t},this._client))}retrieve(e,t){return this._client.get(Q`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",xl,{query:e,...t})}delete(e,t){return this._client.delete(Q`/videos/${e}`,t)}downloadContent(e,t={},n){return this._client.get(Q`/videos/${e}/content`,{query:t,...n,headers:he([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}remix(e,t,n){return this._client.post(Q`/videos/${e}/remix`,Mg({body:t,...n},this._client))}}var ji,Dv,dl;class Lv extends ve{constructor(){super(...arguments),ji.add(this)}async unwrap(e,t,n=this._client.webhookSecret,i=300){return await this.verifySignature(e,t,n,i),JSON.parse(e)}async verifySignature(e,t,n=this._client.webhookSecret,i=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");$(this,ji,"m",Dv).call(this,n);const a=he([t]).values,l=$(this,ji,"m",dl).call(this,a,"webhook-signature"),c=$(this,ji,"m",dl).call(this,a,"webhook-timestamp"),h=$(this,ji,"m",dl).call(this,a,"webhook-id"),d=parseInt(c,10);if(isNaN(d))throw new Kr("Invalid webhook timestamp format");const p=Math.floor(Date.now()/1e3);if(p-d>i)throw new Kr("Webhook timestamp is too old");if(d>p+i)throw new Kr("Webhook timestamp is too new");const m=l.split(" ").map(b=>b.startsWith("v1,")?b.substring(3):b),y=n.startsWith("whsec_")?Buffer.from(n.replace("whsec_",""),"base64"):Buffer.from(n,"utf-8"),w=h?`${h}.${c}.${e}`:`${c}.${e}`,_=await crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const b of m)try{const A=Buffer.from(b,"base64");if(await crypto.subtle.verify("HMAC",_,A,new TextEncoder().encode(w)))return}catch{continue}throw new Kr("The given webhook signature does not match the expected signature")}}ji=new WeakSet,Dv=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},dl=function(e,t){if(!e)throw new Error("Headers are required");const n=e.get(t);if(n==null)throw new Error(`Missing required header: ${t}`);return n};var Bh,Md,fl,Ov;class Re{constructor({baseURL:e=Ni("OPENAI_BASE_URL"),apiKey:t=Ni("OPENAI_API_KEY"),organization:n=Ni("OPENAI_ORG_ID")??null,project:i=Ni("OPENAI_PROJECT_ID")??null,webhookSecret:a=Ni("OPENAI_WEBHOOK_SECRET")??null,...l}={}){if(Bh.add(this),fl.set(this,void 0),this.completions=new hv(this),this.chat=new wd(this),this.embeddings=new pv(this),this.files=new gv(this),this.images=new _v(this),this.audio=new Sa(this),this.moderations=new Sv(this),this.models=new Av(this),this.fineTuning=new Ji(this),this.graders=new Pd(this),this.vectorStores=new Gl(this),this.webhooks=new Lv(this),this.beta=new Qi(this),this.batches=new sv(this),this.uploads=new Rd(this),this.responses=new Vl(this),this.realtime=new Wl(this),this.conversations=new Ad(this),this.evals=new Cd(this),this.containers=new _d(this),this.videos=new Iv(this),t===void 0)throw new be("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const c={apiKey:t,organization:n,project:i,webhookSecret:a,...l,baseURL:e||"https://api.openai.com/v1"};if(!c.dangerouslyAllowBrowser&&gS())throw new be(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=c.baseURL,this.timeout=c.timeout??Md.DEFAULT_TIMEOUT,this.logger=c.logger??console;const h="warn";this.logLevel=h,this.logLevel=Ng(c.logLevel,"ClientOptions.logLevel",this)??Ng(Ni("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??h,this.fetchOptions=c.fetchOptions,this.maxRetries=c.maxRetries??2,this.fetch=c.fetch??xS(),Se(this,fl,AS),this._options=c,this.apiKey=typeof t=="string"?t:"Missing Key",this.organization=n,this.project=i,this.webhookSecret=a}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return he([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return PS(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Oi}`}defaultIdempotencyKey(){return`stainless-node-retry-${r0()}`}makeStatusError(e,t,n,i){return It.generate(e,t,n,i)}async _callApiKey(){const e=this._options.apiKey;if(typeof e!="function")return!1;let t;try{t=await e()}catch(n){throw n instanceof be?n:new be(`Failed to get token from 'apiKey' function: ${n.message}`,{cause:n})}if(typeof t!="string"||!t)throw new be(`Expected 'apiKey' function argument to return a string but it returned ${t}`);return this.apiKey=t,!0}buildURL(e,t,n){const i=!$(this,Bh,"m",Ov).call(this)&&n||this.baseURL,a=hS(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return dS(l)||(t={...l,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(i=>({method:e,path:t,...i})))}request(e,t=null){return new Bl(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){const i=await e,a=i.maxRetries??this.maxRetries;t==null&&(t=a),await this.prepareOptions(i);const{req:l,url:c,timeout:h}=await this.buildRequest(i,{retryCount:a-t});await this.prepareRequest(l,{url:c,options:i});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),p=n===void 0?"":`, retryOf: ${n}`,m=Date.now();if(Pt(this).debug(`[${d}] sending request`,Gs({retryOfRequestLogID:n,method:i.method,url:c,options:i,headers:l.headers})),i.signal?.aborted)throw new bn;const y=new AbortController,w=await this.fetchWithTimeout(c,l,h,y).catch(Eh),_=Date.now();if(w instanceof globalThis.Error){const C=`retrying, ${t} attempts remaining`;if(i.signal?.aborted)throw new bn;const k=kh(w)||/timed? ?out/i.test(String(w)+("cause"in w?String(w.cause):""));if(t)return Pt(this).info(`[${d}] connection ${k?"timed out":"failed"} - ${C}`),Pt(this).debug(`[${d}] connection ${k?"timed out":"failed"} (${C})`,Gs({retryOfRequestLogID:n,url:c,durationMs:_-m,message:w.message})),this.retryRequest(i,t,n??d);throw Pt(this).info(`[${d}] connection ${k?"timed out":"failed"} - error; no more retries left`),Pt(this).debug(`[${d}] connection ${k?"timed out":"failed"} (error; no more retries left)`,Gs({retryOfRequestLogID:n,url:c,durationMs:_-m,message:w.message})),k?new ud:new Fl({cause:w})}const b=[...w.headers.entries()].filter(([C])=>C==="x-request-id").map(([C,k])=>", "+C+": "+JSON.stringify(k)).join(""),A=`[${d}${p}${b}] ${l.method} ${c} ${w.ok?"succeeded":"failed"} with status ${w.status} in ${_-m}ms`;if(!w.ok){const C=await this.shouldRetry(w);if(t&&C){const O=`retrying, ${t} attempts remaining`;return await _S(w.body),Pt(this).info(`${A} - ${O}`),Pt(this).debug(`[${d}] response error (${O})`,Gs({retryOfRequestLogID:n,url:w.url,status:w.status,headers:w.headers,durationMs:_-m})),this.retryRequest(i,t,n??d,w.headers)}const k=C?"error; no more retries left":"error; not retryable";Pt(this).info(`${A} - ${k}`);const E=await w.text().catch(O=>Eh(O).message),P=mS(E),R=P?void 0:E;throw Pt(this).debug(`[${d}] response error (${k})`,Gs({retryOfRequestLogID:n,url:w.url,status:w.status,headers:w.headers,message:R,durationMs:Date.now()-m})),this.makeStatusError(w.status,P,R,w.headers)}return Pt(this).info(A),Pt(this).debug(`[${d}] response start`,Gs({retryOfRequestLogID:n,url:w.url,status:w.status,headers:w.headers,durationMs:_-m})),{response:w,options:i,controller:y,requestLogID:d,retryOfRequestLogID:n,startTime:m}}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}requestAPIList(e,t){const n=this.makeRequest(t,null,void 0);return new jS(this,n,e)}async fetchWithTimeout(e,t,n,i){const{signal:a,method:l,...c}=t||{};a&&a.addEventListener("abort",()=>i.abort());const h=setTimeout(()=>i.abort(),n),d=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,p={signal:i.signal,...d?{duplex:"half"}:{},method:"GET",...c};l&&(p.method=l.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(h)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,i){let a;const l=i?.get("retry-after-ms");if(l){const h=parseFloat(l);Number.isNaN(h)||(a=h)}const c=i?.get("retry-after");if(c&&!a){const h=parseFloat(c);Number.isNaN(h)?a=Date.parse(c)-Date.now():a=h*1e3}if(!(a&&0<=a&&a<60*1e3)){const h=e.maxRetries??this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,h)}return await _a(a),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){const n={...e},{method:i,path:a,query:l,defaultBaseURL:c}=n,h=this.buildURL(a,l,c);"timeout"in n&&pS("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const{bodyHeaders:d,body:p}=this.buildBody({options:n}),m=await this.buildHeaders({options:e,method:i,bodyHeaders:d,retryCount:t});return{req:{method:i,headers:m,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&p instanceof globalThis.ReadableStream&&{duplex:"half"},...p&&{body:p},...this.fetchOptions??{},...n.fetchOptions??{}},url:h,timeout:n.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:i}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=he([a,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...bS(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(l),l.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=he([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:v0(e)}:$(this,fl,"f").call(this,{body:e,headers:n})}}Md=Re,fl=new WeakMap,Bh=new WeakSet,Ov=function(){return this.baseURL!=="https://api.openai.com/v1"};Re.OpenAI=Md;Re.DEFAULT_TIMEOUT=6e5;Re.OpenAIError=be;Re.APIError=It;Re.APIConnectionError=Fl;Re.APIConnectionTimeoutError=ud;Re.APIUserAbortError=bn;Re.NotFoundError=c0;Re.ConflictError=u0;Re.RateLimitError=d0;Re.BadRequestError=a0;Re.AuthenticationError=o0;Re.InternalServerError=f0;Re.PermissionDeniedError=l0;Re.UnprocessableEntityError=h0;Re.InvalidWebhookSignatureError=Kr;Re.toFile=HS;Re.Completions=hv;Re.Chat=wd;Re.Embeddings=pv;Re.Files=gv;Re.Images=_v;Re.Audio=Sa;Re.Moderations=Sv;Re.Models=Av;Re.FineTuning=Ji;Re.Graders=Pd;Re.VectorStores=Gl;Re.Webhooks=Lv;Re.Beta=Qi;Re.Batches=sv;Re.Uploads=Rd;Re.Responses=Vl;Re.Realtime=Wl;Re.Conversations=Ad;Re.Evals=Cd;Re.Containers=_d;Re.Videos=Iv;async function gC(o,e){if(!e)throw new Error("API-Schlssel fehlt");const t=new Re({apiKey:e,dangerouslyAllowBrowser:!0}),n=`Du bist ein KI-Assistent, der Modulbeschreibungen von Hochschulen analysiert.
Extrahiere folgende Informationen aus dem Text und gib sie als JSON zurck:

1. title: Der vollstndige Titel des Moduls
2. ects: Die Anzahl der ECTS-Punkte (als Zahl)
3. workload: Der Workload in Stunden (als Zahl)
4. assessments: Ein Array von Leistungsnachweisen mit:
   - type: Art des Nachweises (z.B. "Schriftliche Prfung", "Semesterarbeit", "Projekt", "Prsentation", "Reflexion", "Mndliche Prfung")
   - weight: Gewichtung in Prozent (als Zahl)
   - format: "Einzelarbeit" oder "Gruppenarbeit"

Achte besonders auf:
- ECTS-Punkte knnen auch als "Credits" bezeichnet werden
- Workload kann aus ECTS berechnet werden (1 ECTS = 25-30 Stunden)
- Leistungsnachweise knnen verschiedene Namen haben (Kompetenznachweis, Prfung, Assessment, etc.)
- Die Gewichtungen sollten sich zu 100% aufaddieren

Gib NUR das JSON-Objekt zurck, ohne zustzlichen Text oder Markdown-Formatierung.`;try{const a=(await t.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:n},{role:"user",content:`Analysiere diese Modulbeschreibung:

${o}`}],temperature:.1,response_format:{type:"json_object"}})).choices[0]?.message?.content;if(!a)throw new Error("Keine Antwort von der KI erhalten");const l=JSON.parse(a);if(!l.title||!l.ects||!l.workload)throw new Error("Unvollstndige Daten von der KI erhalten");return l}catch(i){throw console.error("Fehler bei der KI-Extraktion:",i),i instanceof Error?i.message.includes("API key")?new Error("Ungltiger API-Schlssel. Bitte berprfe deinen OpenAI API-Key."):i.message.includes("quota")?new Error("API-Limit erreicht. Bitte berprfe dein OpenAI-Konto."):i:new Error("KI-Extraktion fehlgeschlagen")}}async function yC(o,e,t){return{moduleData:await gC(e,t),extractedContent:e,pdfName:o.name}}function vC({onNext:o,onBack:e,modules:t,setModules:n,apiKey:i=""}){const[a,l]=ee.useState([]),[c,h]=ee.useState(!1),[d,p]=ee.useState(null),[m,y]=ee.useState(!1),[w,_]=ee.useState(""),[b,A]=ee.useState(null),C=async X=>{const re=X.target.files;if(!re||re.length===0)return;if(!i||i.trim()===""){A("Bitte gib zuerst einen gltigen OpenAI API-Key ein.");return}y(!0),A(null);const te=[],J=[],K=re.length;let j=0;try{for(const ne of Array.from(re)){if(ne.type!=="application/pdf"){console.warn(`Datei ${ne.name} ist keine PDF und wird bersprungen`);continue}j++,_(`Verarbeite ${ne.name} (${j}/${K})...`);try{_(`Lese PDF ${j}/${K}: ${ne.name}...`),console.log("Starte Extraktion fr:",ne.name);const se=await cS(ne);console.log("PDF Text extrahiert:",se.substring(0,200)),_(`KI analysiert ${j}/${K}: ${ne.name}...`),console.log("Starte KI-Analyse...");const D=await yC(ne,se,i);console.log("KI-Analyse abgeschlossen:",D.moduleData);const U={id:Date.now().toString()+Math.random(),name:D.moduleData.title,ects:D.moduleData.ects,workload:D.moduleData.workload,examDate:"",pdfName:ne.name,extractedContent:D.extractedContent,assessments:D.moduleData.assessments.map((ie,ge)=>({id:Date.now().toString()+ge,type:ie.type,weight:ie.weight,format:ie.format,deadline:""}))};te.push(U),J.push(ne.name),console.log("Modul erfolgreich erstellt:",U.name)}catch(se){console.error(`Detaillierter Fehler beim Verarbeiten von ${ne.name}:`,se);const D=se instanceof Error?se.message:"Unbekannter Fehler";A(`Fehler bei ${ne.name}: ${D}`);continue}}te.length>0?(n([...t,...te]),l([...a,...J]),setTimeout(()=>{h(!0),y(!1),_("")},500)):(y(!1),_(""),b||A("Keine PDFs konnten erfolgreich verarbeitet werden."))}catch(ne){console.error("Fehler beim Verarbeiten der Dateien:",ne),A(ne instanceof Error?ne.message:"Ein unerwarteter Fehler ist aufgetreten"),y(!1),_("")}X.target.value=""},k=()=>{A(null)},E=(X,re)=>{n(t.map(te=>te.id===X?{...te,name:re}:te))},P=(X,re,te)=>{n(t.map(J=>J.id===X?{...J,assessments:J.assessments.map(K=>K.id===re?{...K,deadline:te}:K)}:J))},R=(X,re,te)=>{n(t.map(J=>J.id===X?{...J,assessments:J.assessments.map(K=>K.id===re?{...K,weight:te}:K)}:J))},N=(X,re)=>{n(t.map(te=>te.id===X?{...te,ects:re}:te))},O=(X,re)=>{n(t.map(te=>te.id===X?{...te,workload:re}:te))},L=X=>{n(t.filter(re=>re.id!==X))},H=t.every(X=>X.assessments.every(re=>re.deadline!=="")),V=t.reduce((X,re)=>X+re.ects,0),q=t.reduce((X,re)=>X+re.workload,0),xe=t.reduce((X,re)=>X+re.assessments.length,0);return c?x.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:x.jsxs("div",{className:"space-y-8",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx("h2",{className:"text-gray-900",children:"Daten berprfen"}),x.jsx("p",{className:"text-gray-600",children:"berprfe die extrahierten Daten und fge die Abgabedaten fr alle Leistungsnachweise hinzu"})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[x.jsx(nt,{children:x.jsxs(wn,{className:"pb-3",children:[x.jsx(rs,{children:"Module"}),x.jsx(Rn,{className:"text-gray-900",children:t.length})]})}),x.jsx(nt,{children:x.jsxs(wn,{className:"pb-3",children:[x.jsx(rs,{children:"Gesamt ECTS"}),x.jsx(Rn,{className:"text-gray-900",children:V})]})}),x.jsx(nt,{children:x.jsxs(wn,{className:"pb-3",children:[x.jsx(rs,{children:"Workload"}),x.jsxs(Rn,{className:"text-gray-900",children:[q,"h"]})]})}),x.jsx(nt,{children:x.jsxs(wn,{className:"pb-3",children:[x.jsx(rs,{children:"Leistungsnachweise"}),x.jsx(Rn,{className:"text-gray-900",children:xe})]})})]}),x.jsx("div",{className:"space-y-6",children:t.map((X,re)=>x.jsxs(nt,{className:"overflow-hidden",children:[x.jsx(wn,{className:"bg-gradient-to-r from-blue-50 to-purple-50",children:x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[x.jsx("div",{className:"bg-purple-600 p-2 rounded-lg",children:x.jsx(my,{className:"size-5 text-white"})}),x.jsxs("div",{className:"flex-1",children:[x.jsx("div",{className:"flex items-center gap-2 mb-2",children:x.jsxs("span",{className:"text-xs text-gray-600",children:["Modul ",re+1]})}),x.jsx(Mi,{value:X.name,onChange:te=>E(X.id,te.target.value),className:"mb-2 bg-white"}),x.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx(Vm,{className:"size-3"}),X.pdfName]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(sl,{className:"text-xs",children:"ECTS:"}),x.jsx(Mi,{type:"number",value:X.ects,onChange:te=>N(X.id,parseInt(te.target.value)||0),className:"h-7 w-16 text-sm",min:"1"})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(sl,{className:"text-xs",children:"Workload:"}),x.jsx(Mi,{type:"number",value:X.workload,onChange:te=>O(X.id,parseInt(te.target.value)||0),className:"h-7 w-20 text-sm",min:"1"}),x.jsx("span",{className:"text-xs",children:"h"})]})]})]})]}),x.jsx(Ye,{variant:"ghost",size:"sm",onClick:()=>L(X.id),children:x.jsx(C_,{className:"size-4 text-red-600"})})]})}),x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"space-y-4",children:[X.extractedContent&&x.jsxs(oA,{open:d===X.id,onOpenChange:()=>p(d===X.id?null:X.id),children:[x.jsx(lA,{asChild:!0,children:x.jsxs(Ye,{variant:"outline",className:"w-full mb-4",children:[x.jsx(gy,{className:"size-4 mr-2"}),d===X.id?"PDF-Extraktion ausblenden":"PDF-Extraktion anzeigen",d===X.id?x.jsx(t_,{className:"size-4 ml-auto"}):x.jsx(Zx,{className:"size-4 ml-auto"})]})}),x.jsxs(cA,{children:[x.jsx("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg mb-4 font-mono text-sm max-h-64 overflow-y-auto",children:x.jsx("pre",{className:"whitespace-pre-wrap",children:X.extractedContent})}),x.jsx("p",{className:"text-xs text-gray-500 mb-4 text-center",children:"Dies ist der aus dem PDF extrahierte Rohtext. Die Werte oben wurden automatisch aus diesem Content generiert."})]})]}),x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsx("h4",{className:"text-gray-900",children:"Leistungsnachweise"}),x.jsxs("span",{className:"text-sm text-gray-600",children:[X.assessments.filter(te=>te.deadline).length," von ",X.assessments.length," Deadlines gesetzt"]})]}),X.assessments.map((te,J)=>x.jsx("div",{className:`p-4 rounded-lg border-2 transition-all ${te.deadline?"bg-green-50 border-green-200":"bg-orange-50 border-orange-300 border-dashed"}`,children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-center",children:[x.jsx("div",{className:"md:col-span-1 flex items-center justify-center",children:te.deadline?x.jsx("div",{className:"bg-green-500 rounded-full p-1",children:x.jsx(Qx,{className:"size-4 text-white"})}):x.jsx("div",{className:"bg-orange-500 text-white rounded-full size-6 flex items-center justify-center text-xs",children:"!"})}),x.jsxs("div",{className:"md:col-span-3",children:[x.jsx("div",{className:"text-gray-900",children:te.type}),x.jsx("div",{className:"text-xs text-gray-600",children:te.format})]}),x.jsx("div",{className:"md:col-span-2",children:x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(Mi,{type:"number",value:te.weight,onChange:K=>R(X.id,te.id,parseInt(K.target.value)||0),className:"h-8 w-16 text-sm",min:"0",max:"100"}),x.jsx("span",{className:"text-sm text-gray-600",children:"%"})]})}),x.jsx("div",{className:"md:col-span-6",children:x.jsxs("div",{className:"space-y-1",children:[x.jsx(sl,{htmlFor:`deadline-${te.id}`,className:"text-xs",children:"Prfungsdatum *"}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(gl,{className:"size-4 text-gray-400"}),x.jsx(Mi,{id:`deadline-${te.id}`,type:"date",value:te.deadline,onChange:K=>P(X.id,te.id,K.target.value),className:te.deadline?"border-green-400":"border-orange-400"})]})]})})]})},te.id))]})})]},X.id))}),x.jsx(nt,{className:"border-dashed border-2",children:x.jsxs(At,{className:"flex flex-col items-center justify-center py-8",children:[x.jsx("input",{type:"file",id:"pdf-upload-more",accept:".pdf",multiple:!0,onChange:C,className:"hidden",disabled:m}),x.jsx("label",{htmlFor:"pdf-upload-more",children:x.jsx(Ye,{variant:"outline",asChild:!0,disabled:m,children:x.jsx("span",{className:"cursor-pointer",children:m?x.jsxs(x.Fragment,{children:[x.jsx(Gu,{className:"size-4 mr-2 animate-spin"}),"Wird verarbeitet..."]}):x.jsxs(x.Fragment,{children:[x.jsx(nl,{className:"size-4 mr-2"}),"Weitere Module hochladen"]})})})})]})}),!H&&x.jsx(nt,{className:"bg-orange-50 border-orange-200",children:x.jsx(At,{className:"pt-6",children:x.jsxs("p",{className:"text-sm text-gray-700 text-center",children:[x.jsx("strong",{children:"Hinweis:"})," Bitte fge fr alle Leistungsnachweise ein Abgabedatum hinzu, um fortzufahren."]})})}),x.jsxs("div",{className:"flex justify-between pt-6",children:[x.jsxs(Ye,{variant:"outline",onClick:()=>h(!1),children:[x.jsx(la,{className:"size-4 mr-2"}),"Zurck zum Upload"]}),x.jsx(Ye,{onClick:o,disabled:!H,children:H?x.jsxs(x.Fragment,{children:["Weiter",x.jsx(Hi,{className:"size-4 ml-2"})]}):x.jsxs(x.Fragment,{children:["Alle Deadlines eingeben",x.jsx(Hi,{className:"size-4 ml-2"})]})})]})]})}):x.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:x.jsxs("div",{className:"space-y-8",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx("h2",{className:"text-gray-900",children:"Module hochladen"}),x.jsx("p",{className:"text-gray-600",children:"Lade alle deine Modulbeschreibungen als PDF hoch. Die KI extrahiert automatisch alle wichtigen Daten."})]}),b&&x.jsx(nt,{className:"border-red-200 bg-red-50",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx(s_,{className:"size-5 text-red-600 mt-0.5"}),x.jsxs("div",{className:"flex-1",children:[x.jsx("p",{className:"text-sm text-red-900 font-medium",children:"Fehler beim Verarbeiten"}),x.jsx("p",{className:"text-sm text-red-700 mt-1",children:b})]}),x.jsx(Ye,{variant:"ghost",size:"sm",onClick:k,children:""})]})})}),m&&x.jsx(nt,{className:"border-blue-200 bg-blue-50",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx(Gu,{className:"size-5 text-blue-600 animate-spin"}),x.jsxs("div",{children:[x.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"PDFs werden verarbeitet..."}),x.jsx("p",{className:"text-sm text-blue-700 mt-1",children:w})]})]})})}),x.jsx(nt,{className:"border-dashed border-2 border-gray-300 bg-gradient-to-br from-blue-50 to-purple-50",children:x.jsxs(At,{className:"flex flex-col items-center justify-center py-16",children:[x.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 p-6 rounded-2xl mb-6",children:x.jsx(nl,{className:"size-12 text-white"})}),x.jsx("input",{type:"file",id:"pdf-upload",accept:".pdf",multiple:!0,onChange:C,className:"hidden",disabled:m}),x.jsx("label",{htmlFor:"pdf-upload",children:x.jsx(Ye,{size:"lg",asChild:!0,disabled:m,children:x.jsx("span",{className:"cursor-pointer",children:m?x.jsxs(x.Fragment,{children:[x.jsx(Gu,{className:"size-5 mr-2 animate-spin"}),"Wird verarbeitet..."]}):x.jsxs(x.Fragment,{children:[x.jsx(nl,{className:"size-5 mr-2"}),"Modulbeschreibungen hochladen"]})})})}),x.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Du kannst mehrere PDFs gleichzeitig hochladen"}),!i&&x.jsx("p",{className:"text-sm text-red-600 mt-2 font-medium",children:" Bitte gib zuerst einen OpenAI API-Key ein"})]})}),t.length>0&&x.jsxs(nt,{children:[x.jsxs(wn,{children:[x.jsxs(Rn,{children:["Hochgeladene Module (",t.length,")"]}),x.jsx(rs,{children:'Klicke auf "Weiter" um die extrahierten Daten zu berprfen'})]}),x.jsx(At,{className:"space-y-2",children:t.map(X=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx(Vm,{className:"size-5 text-blue-600"}),x.jsxs("div",{children:[x.jsx("div",{className:"text-gray-900",children:X.pdfName}),x.jsxs("div",{className:"text-xs text-gray-600",children:[X.assessments.length," Leistungsnachweise extrahiert"]})]})]}),x.jsxs(xy,{variant:"secondary",children:[X.ects," ECTS"]})]},X.id))})]}),x.jsxs("div",{className:"flex justify-between pt-6",children:[x.jsxs(Ye,{variant:"outline",onClick:e,disabled:m,children:[x.jsx(la,{className:"size-4 mr-2"}),"Zurck"]}),x.jsxs(Ye,{onClick:()=>h(!0),disabled:t.length===0||m,children:["Weiter zur berprfung",x.jsx(Hi,{className:"size-4 ml-2"})]})]})]})})}const Xg=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],wC=["Mo","Di","Mi","Do","Fr","Sa","So"],el=[{start:"06:00",end:"08:00",label:"6-8"},{start:"08:00",end:"10:00",label:"8-10"},{start:"10:00",end:"12:00",label:"10-12"},{start:"12:00",end:"14:00",label:"12-14"},{start:"14:00",end:"16:00",label:"14-16"},{start:"16:00",end:"18:00",label:"16-18"},{start:"18:00",end:"20:00",label:"18-20"},{start:"20:00",end:"22:00",label:"20-22"},{start:"22:00",end:"24:00",label:"22-24"}];function bC({onNext:o,onBack:e,timeSlots:t,setTimeSlots:n}){const i=(m,y,w)=>t.some(_=>_.day===m&&_.startTime===y&&_.endTime===w),a=(m,y,w)=>{const _=t.find(b=>b.day===m&&b.startTime===y&&b.endTime===w);if(_){const b=t.filter(A=>A.id!==_.id);n(b)}else{const b={id:Date.now().toString()+Math.random(),day:m,startTime:y,endTime:w},A=[...t,b];n(A)}},l=m=>{const y=t.filter(_=>_.day!==m),w=el.map(_=>({id:Date.now().toString()+Math.random(),day:m,startTime:_.start,endTime:_.end}));n([...y,...w])},c=m=>{n(t.filter(y=>y.day!==m))},h=m=>el.every(y=>i(m,y.start,y.end)),d=m=>t.filter(y=>y.day===m).length,p=t.length*2;return x.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:x.jsxs("div",{className:"space-y-8",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx("h2",{className:"text-gray-900",children:"Wochenplan erstellen"}),x.jsx("p",{className:"text-gray-600",children:"Klicke auf die Zeitblcke, in denen du Zeit zum Lernen hast"})]}),x.jsx(nt,{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-center justify-center gap-8 text-center",children:[x.jsxs("div",{children:[x.jsx("div",{className:"text-3xl text-gray-900",children:t.length}),x.jsx("div",{className:"text-sm text-gray-600",children:"Zeitblcke ausgewhlt"})]}),x.jsx("div",{className:"h-12 w-px bg-gray-300"}),x.jsxs("div",{children:[x.jsxs("div",{className:"text-3xl text-gray-900",children:[p,"h"]}),x.jsx("div",{className:"text-sm text-gray-600",children:"Lernzeit pro Woche"})]})]})})}),x.jsxs(nt,{children:[x.jsx(wn,{children:x.jsxs("div",{className:"flex items-start justify-between",children:[x.jsxs("div",{children:[x.jsx(Rn,{children:"Deine Woche"}),x.jsx(rs,{children:"Klicke auf Zeitblcke um sie auszuwhlen oder abzuwhlen"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[x.jsx(hh,{className:"size-4"}),"Jeder Block = 2 Stunden"]})]})}),x.jsx(At,{children:x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("div",{className:"min-w-[800px]",children:[x.jsxs("div",{className:"grid grid-cols-8 gap-2 mb-4",children:[x.jsx("div",{className:"text-sm text-gray-600",children:"Zeit"}),Xg.map((m,y)=>x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"text-gray-900 mb-1 hidden lg:block",children:m}),x.jsx("div",{className:"text-gray-900 mb-1 lg:hidden",children:wC[y]}),x.jsxs("div",{className:"text-xs text-gray-600 mb-2",children:[d(m)," Blcke"]}),h(m)?x.jsx(Ye,{variant:"outline",size:"sm",onClick:()=>c(m),className:"w-full text-xs h-7",children:"Alle lschen"}):x.jsx(Ye,{variant:"outline",size:"sm",onClick:()=>l(m),className:"w-full text-xs h-7",children:"Ganzer Tag"})]},m))]}),x.jsx("div",{className:"space-y-2",children:el.map(m=>x.jsxs("div",{className:"grid grid-cols-8 gap-2",children:[x.jsx("div",{className:"text-sm text-gray-600 flex items-center justify-center py-4",children:m.label}),Xg.map(y=>{const w=i(y,m.start,m.end);return x.jsx("button",{onClick:()=>a(y,m.start,m.end),className:`
                              py-4 rounded-lg border-2 transition-all duration-200 
                              hover:scale-105 active:scale-95
                              ${w?"bg-gradient-to-br from-blue-500 to-purple-500 border-blue-600 shadow-lg":"bg-white border-gray-200 hover:border-blue-300 hover:bg-blue-50"}
                            `,children:w&&x.jsx("div",{className:"text-white text-xs",children:""})},`${y}-${m.start}`)})]},m.start))})]})})})]}),x.jsxs(nt,{children:[x.jsxs(wn,{children:[x.jsx(Rn,{children:"Schnellauswahl"}),x.jsx(rs,{children:"Whle eine Vorlage und passe sie bei Bedarf an"})]}),x.jsx(At,{children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[x.jsx(Ye,{variant:"outline",className:"h-auto py-4",onClick:()=>{const m=[];["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"].forEach(y=>{m.push({id:Date.now().toString()+Math.random(),day:y,startTime:"08:00",endTime:"10:00"})}),n(m)},children:x.jsxs("div",{className:"text-left",children:[x.jsx("div",{children:"Morgens unter der Woche"}),x.jsx("div",{className:"text-xs text-gray-500",children:"Mo-Fr, 8-10 Uhr"})]})}),x.jsx(Ye,{variant:"outline",className:"h-auto py-4",onClick:()=>{const m=[];["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"].forEach(y=>{m.push({id:Date.now().toString()+Math.random(),day:y,startTime:"14:00",endTime:"16:00"}),m.push({id:Date.now().toString()+Math.random(),day:y,startTime:"16:00",endTime:"18:00"})}),n(m)},children:x.jsxs("div",{className:"text-left",children:[x.jsx("div",{children:"Nachmittags"}),x.jsx("div",{className:"text-xs text-gray-500",children:"Mo-Fr, 14-18 Uhr"})]})}),x.jsx(Ye,{variant:"outline",className:"h-auto py-4",onClick:()=>{const m=[];["Samstag","Sonntag"].forEach(y=>{el.slice(2,7).forEach(w=>{m.push({id:Date.now().toString()+Math.random(),day:y,startTime:w.start,endTime:w.end})})}),n(m)},children:x.jsxs("div",{className:"text-left",children:[x.jsx("div",{children:"Wochenende intensiv"}),x.jsx("div",{className:"text-xs text-gray-500",children:"Sa-So, 10-20 Uhr"})]})})]})})]}),x.jsx(nt,{className:"bg-blue-50 border-blue-200",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx(Gm,{className:"size-5 text-blue-600 flex-shrink-0 mt-0.5"}),x.jsxs("p",{className:"text-sm text-gray-700",children:[x.jsx("strong",{children:"Tipp:"})," Whle realistische Zeitfenster aus. Die KI plant deine Lernsessions automatisch in diese Zeitblcke ein und bercksichtigt dabei Deadlines und Prioritten."]})]})})}),t.length===0&&x.jsx(nt,{className:"bg-orange-50 border-orange-300",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx(Gm,{className:"size-5 text-orange-600 flex-shrink-0 mt-0.5"}),x.jsxs("p",{className:"text-sm text-gray-700",children:[x.jsx("strong",{children:"Hinweis:"})," Bitte whle mindestens einen Zeitblock aus, um fortzufahren. Du kannst auch eine Schnellauswahl-Vorlage verwenden."]})]})})}),x.jsxs("div",{className:"flex justify-between pt-6",children:[x.jsxs(Ye,{variant:"outline",onClick:e,children:[x.jsx(la,{className:"size-4 mr-2"}),"Zurck"]}),x.jsxs(Ye,{onClick:o,disabled:t.length===0,children:["Weiter (",t.length," Slots)",x.jsx(Hi,{className:"size-4 ml-2"})]})]})]})})}function xC({onBack:o,modules:e,timeSlots:t,apiKey:n=""}){const[i,a]=ee.useState(!1),[l,c]=ee.useState(!1),[h,d]=ee.useState([]),p=()=>{a(!0),setTimeout(()=>{const A=[{id:"1",date:"2024-12-09",startTime:"09:00",endTime:"11:00",module:e[0]?.name||"Software Engineering",topic:"Design Patterns einfhren",description:"Singleton und Factory Pattern durcharbeiten"},{id:"2",date:"2024-12-09",startTime:"14:00",endTime:"16:00",module:e[1]?.name||"Datenbanken",topic:"SQL Grundlagen",description:"SELECT, JOIN, WHERE Statements ben"},{id:"3",date:"2024-12-11",startTime:"14:00",endTime:"17:00",module:e[0]?.name||"Software Engineering",topic:"Semesterarbeit Kapitel 1",description:"Einleitung und Problemstellung schreiben"},{id:"4",date:"2024-12-13",startTime:"10:00",endTime:"12:00",module:e[1]?.name||"Datenbanken",topic:"Normalisierung",description:"1NF bis 3NF Beispiele durcharbeiten"},{id:"5",date:"2024-12-16",startTime:"09:00",endTime:"11:00",module:e[0]?.name||"Software Engineering",topic:"Observer Pattern",description:"Implementierung ben, Code-Beispiele"},{id:"6",date:"2024-12-18",startTime:"14:00",endTime:"16:00",module:e[1]?.name||"Datenbanken",topic:"Projekt-Datenbank Design",description:"ER-Diagramm erstellen und validieren"}];d(A),c(!0),a(!1)},2500)},m=(A,C)=>{const k=[],E=new Date(A,C,1),P=new Date(A,C+1,0);let R=[],N=new Date(E);const O=E.getDay(),L=O===0?-6:1-O;for(N.setDate(E.getDate()+L);N<=P||R.length>0;)if(R.length===7&&(k.push(R),R=[]),R.push(new Date(N)),N.setDate(N.getDate()+1),N>P&&R.length>0)for(;R.length<7;)R.push(new Date(N)),N.setDate(N.getDate()+1);return k},y=A=>{const C=A.toISOString().split("T")[0];return h.filter(k=>k.date===C)},w=new Date("2024-12-01"),_=m(w.getFullYear(),w.getMonth()),b=["Mo","Di","Mi","Do","Fr","Sa","So"];return l?x.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h2",{className:"text-gray-900",children:"Dein Lernplan"}),x.jsx("p",{className:"text-gray-600",children:"KI-optimiert und auf deine Bedrfnisse zugeschnitten"})]}),x.jsxs("div",{className:"flex gap-2",children:[x.jsxs(Ye,{variant:"outline",onClick:()=>c(!1),children:[x.jsx(qm,{className:"size-4 mr-2"}),"Neu generieren"]}),x.jsxs(Ye,{variant:"outline",children:[x.jsx(l_,{className:"size-4 mr-2"}),"Exportieren"]})]})]}),x.jsx(nt,{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-0",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("div",{className:"bg-white/20 p-3 rounded-full",children:x.jsx(r_,{className:"size-8"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl mb-1",children:"Plan erfolgreich erstellt!"}),x.jsxs("p",{className:"text-white/90",children:[h.length," Lernsessions wurden fr dich geplant  ",e.length," Module  ",t.length*2,"h pro Woche"]})]})]})})}),x.jsxs(nt,{children:[x.jsx(wn,{children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs(Rn,{className:"flex items-center gap-2",children:[x.jsx(gl,{className:"size-5"}),w.toLocaleDateString("de-DE",{month:"long",year:"numeric"})]}),x.jsx("div",{className:"flex items-center gap-4 text-sm",children:e.slice(0,3).map((A,C)=>x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("div",{className:`size-3 rounded-full ${C===0?"bg-blue-500":C===1?"bg-purple-500":"bg-pink-500"}`}),x.jsx("span",{className:"text-gray-600",children:A.name})]},C))})]})}),x.jsxs(At,{children:[x.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2",children:b.map(A=>x.jsx("div",{className:"text-center text-sm text-gray-600 py-2",children:A},A))}),x.jsx("div",{className:"space-y-2",children:_.map((A,C)=>x.jsx("div",{className:"grid grid-cols-7 gap-2",children:A.map((k,E)=>{const P=y(k),R=k.getMonth()===w.getMonth(),N=k.toDateString()===new Date("2024-12-09").toDateString();return x.jsxs("div",{className:`min-h-[120px] p-2 rounded-lg border-2 transition-all ${N?"bg-blue-50 border-blue-400":R?"bg-white border-gray-200 hover:border-gray-300":"bg-gray-50 border-gray-100"}`,children:[x.jsx("div",{className:`text-sm mb-2 ${N?"text-blue-600":R?"text-gray-900":"text-gray-400"}`,children:k.getDate()}),x.jsx("div",{className:"space-y-1",children:P.map((O,L)=>{const H=e.findIndex(xe=>xe.name===O.module),V=["bg-blue-500","bg-purple-500","bg-pink-500"],q=V[H%V.length];return x.jsxs("div",{className:`${q} text-white p-2 rounded text-xs`,children:[x.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[x.jsx(hh,{className:"size-3"}),x.jsx("span",{children:O.startTime})]}),x.jsx("div",{className:"line-clamp-2",children:O.topic})]},O.id)})})]},E)})},C))})]})]}),x.jsxs(nt,{children:[x.jsxs(wn,{children:[x.jsx(Rn,{children:"Alle Lernsessions"}),x.jsxs(rs,{children:[h.length," Sessions geplant"]})]}),x.jsx(At,{className:"space-y-2",children:h.map(A=>{const C=e.findIndex(P=>P.name===A.module),k=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-pink-500 to-pink-600"],E=k[C%k.length];return x.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[x.jsx("div",{className:`bg-gradient-to-br ${E} p-3 rounded-lg flex-shrink-0`,children:x.jsx(my,{className:"size-5 text-white"})}),x.jsxs("div",{className:"flex-1",children:[x.jsxs("div",{className:"flex items-start justify-between mb-1",children:[x.jsx("h4",{className:"text-gray-900",children:A.topic}),x.jsx(xy,{children:A.module})]}),x.jsx("p",{className:"text-sm text-gray-600 mb-2",children:A.description}),x.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[x.jsxs("span",{className:"flex items-center gap-1",children:[x.jsx(gl,{className:"size-3"}),new Date(A.date).toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"short"})]}),x.jsxs("span",{className:"flex items-center gap-1",children:[x.jsx(hh,{className:"size-3"}),A.startTime," - ",A.endTime]})]})]})]},A.id)})})]})]})}):x.jsx("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:x.jsxs("div",{className:"space-y-8",children:[x.jsxs("div",{className:"text-center space-y-2",children:[x.jsx("div",{className:"flex justify-center mb-4",children:x.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-pink-500 p-4 rounded-2xl",children:x.jsx(tl,{className:"size-12 text-white"})})}),x.jsx("h2",{className:"text-gray-900",children:"Lernplan generieren"}),x.jsx("p",{className:"text-gray-600",children:"Alle Daten gesammelt! Lass die KI deinen personalisierten Lernplan erstellen."})]}),x.jsx(nt,{className:"border-2 border-green-300 bg-green-50",children:x.jsx(At,{className:"pt-6",children:x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx("div",{className:"bg-green-500 p-2 rounded-full",children:x.jsx(yy,{className:"size-5 text-white"})}),x.jsx("div",{children:x.jsx("p",{className:"text-gray-900",children:"API-Key konfiguriert"})})]})})}),x.jsxs(nt,{className:"bg-gradient-to-br from-blue-50 to-purple-50 border-blue-200",children:[x.jsx(wn,{children:x.jsx(Rn,{children:"Zusammenfassung deiner Daten"})}),x.jsxs(At,{className:"space-y-3",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-gray-600",children:"Module hochgeladen:"}),x.jsx("span",{className:"text-gray-900",children:e.length})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-gray-600",children:"Zeitfenster definiert:"}),x.jsx("span",{className:"text-gray-900",children:t.length})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-gray-600",children:"Gesamt ECTS:"}),x.jsx("span",{className:"text-gray-900",children:e.reduce((A,C)=>A+(C.ects||0),0)})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{className:"text-gray-600",children:"Wchentliche Lernzeit:"}),x.jsxs("span",{className:"text-gray-900",children:[t.length*2,"h"]})]})]})]}),x.jsxs(wy,{children:[x.jsx(tl,{className:"size-4"}),x.jsxs(by,{children:["Die KI analysiert deine Module, Deadlines und verfgbaren Zeiten, um einen optimalen, realistischen Lernplan zu erstellen. Sie whlt ",x.jsx("strong",{children:"automatisch die beste Lernmethode"})," fr jedes Modul (z.B. Deep Work fr Projekte, Pomodoro fr Programmieren, Spaced Repetition fr Prfungen)."]})]}),x.jsxs("div",{className:"flex justify-between pt-6",children:[x.jsxs(Ye,{variant:"outline",onClick:o,children:[x.jsx(la,{className:"size-4 mr-2"}),"Zurck"]}),x.jsx(Ye,{size:"lg",onClick:p,disabled:i,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:i?x.jsxs(x.Fragment,{children:[x.jsx(qm,{className:"size-5 mr-2 animate-spin"}),"Generiere Plan..."]}):x.jsxs(x.Fragment,{children:[x.jsx(tl,{className:"size-5 mr-2"}),"Lernplan jetzt erstellen"]})})]})]})})}function _C(){const[o,e]=ee.useState(0),[t,n]=ee.useState([]),[i,a]=ee.useState([]),[l,c]=ee.useState(""),h=[{component:P_,title:"Willkommen"},{component:L_,title:"API-Key"},{component:vC,title:"Module hochladen"},{component:bC,title:"Wochenplan"},{component:xC,title:"Lernplan"}],d=h[o].component,p=()=>{e(o+1)},m=()=>{e(o-1)};return x.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o>=2&&x.jsx("div",{className:"fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-50",children:x.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[x.jsxs("div",{className:"flex items-center justify-between mb-2",children:[x.jsx("h3",{className:"text-gray-900",children:h[o].title}),x.jsxs("span",{className:"text-sm text-gray-500",children:["Schritt ",o-1," von ",h.length-2]})]}),x.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:x.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${(o-1)/(h.length-2)*100}%`}})})]})}),x.jsx("main",{className:o>=2?"pt-24":"",children:x.jsx(d,{onNext:p,onBack:m,modules:t,setModules:n,timeSlots:i,setTimeSlots:a,apiKey:l,setApiKey:c})})]})}Ub.createRoot(document.getElementById("root")).render(x.jsx(_C,{}));
